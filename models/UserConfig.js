// =========================================================================================================
// ๐๏ธ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุฃุนุถุงุก ุงูุดุงููุฉ (THE ULTIMATE USER CONFIGURATION SCHEMA)
// ---------------------------------------------------------------------------------------------------------
// ุงููุธููุฉ: ุชุฎุฒูู ุจูุงูุงุช ูู ุนุถู ุฏุงุฎู ุงูุณูุฑูุฑ ุจุดูู ูููุตู.
// ูุญุชูู ุนูู: ูุธุงู ุงููููุงุช (XP)ุ ุงูุงูุชุตุงุฏ (Credits/Bank)ุ ูุณุฌู ุงูุนููุจุงุช (Warnings).
// ูุฏุนู ุงูุชูุณุน ุงููุณุชูุจูู ููุชูุงุณุจ ูุน ููุญุฉ ุงูุชุญูู ูุงูุฃูุงูุฑ ุงููุฒุฏูุฌุฉ (Slash/Prefix).
// =========================================================================================================

const mongoose = require('mongoose');

const userConfigSchema = new mongoose.Schema({
    
    // ==========================================
    // 1๏ธโฃ ุงููููุฉ ุงูุฃุณุงุณูุฉ (Core Identity)
    // ==========================================
    userId: { type: String, required: true },
    guildId: { type: String, required: true }, // ูุตููุง ุงูุจูุงูุงุช ููู ุณูุฑูุฑ ูุถูุงู ุชุญููู ูู Owner
    
    // ==========================================
    // 2๏ธโฃ ูุธุงู ุงููููุงุช ูุงูุฎุจุฑุฉ (Leveling System)
    // ==========================================
    leveling: {
        xp: { type: Number, default: 0 },         // ููุงุท ุงูุฎุจุฑุฉ ุงูุญุงููุฉ
        level: { type: Number, default: 1 },      // ุงููุณุชูู ุงูุญุงูู ููุนุถู
        totalMessages: { type: Number, default: 0 }, // ุนุฏุฏ ุงูุฑุณุงุฆู ุงูููู ููุฅุญุตุงุฆูุงุช
        lastMessageTimestamp: { type: Date, default: null } // ูููุน ุงูุณุจุงู ูู ุชุฌููุน ุงูู XP
    },

    // ==========================================
    // 3๏ธโฃ ูุธุงู ุงูุงูุชุตุงุฏ ุงููุชูุฏู (Economy System)
    // ==========================================
    economy: {
        credits: { type: Number, default: 0 },    // ุงููุฑุฏุช (ุงูุฃููุงู ูู ุงููุฏ)
        bank: { type: Number, default: 0 },       // ุงูุฃููุงู ูู ุงูุจูู (ูู ุญุจูุช ุชุถูู ุณุฑูุงุช ูู ุงููุณุชูุจู)
        lastDaily: { type: Date, default: null }, // ุขุฎุฑ ูุฑุฉ ุงุณุชูู ูููุง ุงูุฑุงุชุจ ุงููููู
    },

    // ==========================================
    // 4๏ธโฃ ุณุฌู ุงูุนููุจุงุช ุงูุดุฎุตู (Moderation History)
    // ==========================================
    moderation: {
        warningsCount: { type: Number, default: 0 }, // ุนุฏุฏ ุงูุชุญุฐูุฑุงุช ุงููุดุทุฉ
        warningsLog: [{
            reason: { type: String, required: true }, // ุณุจุจ ุงูุชุญุฐูุฑ
            adminId: { type: String, required: true }, // ุงูุฅุฏุงุฑู ุงูุฐู ุฃุนุทู ุงูุชุญุฐูุฑ
            timestamp: { type: Date, default: Date.now } // ููุช ุงูุชุญุฐูุฑ
        }]
    }

});

// ุนูู Index ูุฒุฏูุฌ ูุชุณุฑูุน ุงูุจุญุซ ุฌุฏุงู ุนูุฏูุง ูุจุญุซ ุนู ุนุถู ูุนูู ูู ุณูุฑูุฑ ูุนูู
userConfigSchema.index({ userId: 1, guildId: 1 }, { unique: true });

module.exports = mongoose.model('UserConfig', userConfigSchema);
