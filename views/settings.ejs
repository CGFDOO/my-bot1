<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Control | ููุญุฉ ุชุญูู ุงููุธุงู</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Tajawal', 'sans-serif'] },
                    colors: { 
                        brand: { DEFAULT: '#5865F2', dark: '#4752C4', light: '#7289DA' }, 
                        dark: { 900: '#0b0f19', 800: '#151b2b', 700: '#1f2937', 600: '#334155' } 
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #0b0f19; color: #f8fafc; overflow-x: hidden; scroll-behavior: smooth; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0b0f19; }
        ::-webkit-scrollbar-thumb { background: #1f2937; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #5865F2; }
        
        .glass-card { 
            background: rgba(21, 27, 43, 0.8); 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(255, 255, 255, 0.05); 
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.6); 
        }
        
        .input-glow:focus { box-shadow: 0 0 0 3px rgba(88, 101, 242, 0.3); border-color: #5865F2; outline: none; }
        
        .settings-section { display: none; animation: fadeIn 0.4s ease forwards; }
        .settings-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* ๐๏ธ ุฃุฒุฑุงุฑ ุงูุชูุนูู (Toggles) ูุชูุงููุฉ 100% */
        .switch { position: relative; display: inline-block; width: 54px; height: 28px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #374151; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; right: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #10B981; }
        input:checked + .slider:before { transform: translateX(-26px); }

        /* ุฅุตูุงุญ ุงูุฑุงุฏูู ุจูุชูู ูู ุงููุงูุฐุฉ ุงูููุจุซูุฉ */
        input[type="radio"] { appearance: auto; width: 1.2rem; height: 1.2rem; accent-color: #5865F2; }
    </style>
</head>

<% 
    let textChannels = []; let voiceChannels = []; let categories = []; let serverRoles = [];
    let guildName = "Unknown Server"; let guildIconUrl = "https://cdn.discordapp.com/embed/avatars/0.png";

    if (bot && guildId) {
        const currentGuild = bot.guilds.cache.get(guildId);
        if (currentGuild) {
            guildName = currentGuild.name;
            if (currentGuild.icon) guildIconUrl = `https://cdn.discordapp.com/icons/${guildId}/${currentGuild.icon}.png`;
            textChannels = currentGuild.channels.cache.filter(c => c.type === 0 || c.type === 5 || c.type === 15).sort((a,b) => a.position - b.position).map(c => ({ id: c.id, name: c.name }));
            categories = currentGuild.channels.cache.filter(c => c.type === 4).sort((a,b) => a.position - b.position).map(c => ({ id: c.id, name: c.name }));
            serverRoles = currentGuild.roles.cache.filter(r => r.id !== guildId).sort((a,b) => b.position - a.position).map(r => ({ id: r.id, name: r.name }));
        }
    }
%>

<body class="flex h-screen overflow-hidden selection:bg-brand selection:text-white">

    <aside class="w-72 flex-shrink-0 border-l border-dark-700 bg-dark-800 flex flex-col z-20 shadow-[5px_0_20px_rgba(0,0,0,0.5)]">
        <div class="h-24 flex flex-col items-center justify-center border-b border-dark-700 bg-dark-900/60 relative overflow-hidden">
            <h1 class="text-2xl font-black text-white tracking-wider relative z-10" data-en="SYSTEM CONTROL">
                SYSTEM <span class="text-brand">CONTROL</span>
            </h1>
        </div>
        
        <nav class="flex-1 overflow-y-auto py-6 px-4 space-y-2 custom-scrollbar" id="sidebar-nav">
            
            <div class="text-[11px] font-black text-slate-500 uppercase tracking-widest mb-3 px-2" data-en="Basics & AI">ุงูุฃุณุงุณูุงุช ูุงูุฐูุงุก</div>
            
            <button onclick="switchSection('general')" class="nav-btn active-nav w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all bg-brand text-white font-bold" data-target="general">
                <span class="text-lg">โ๏ธ</span> <span data-en="General Settings & Colors">ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ ูุงูุฃููุงู</span>
            </button>
            <button onclick="switchSection('ai_system')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-amber-400 hover:bg-dark-700 font-bold" data-target="ai_system">
                <span class="text-lg">โจ</span> <span data-en="Artificial Intelligence (AI)">ุงูุฐูุงุก ุงูุงุตุทูุงุนู (AI)</span>
            </button>
            <button onclick="switchSection('live_embed')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="live_embed">
                <span class="text-lg">๐จ</span> <span data-en="Live Embed Maker">ุตุงูุน ุงูุฅููุจุฏ ุงูููุฑู</span>
            </button>

            <div class="text-[11px] font-black text-slate-500 uppercase tracking-widest mb-3 mt-8 px-2" data-en="Tickets & Middleman">ุงูุชุฐุงูุฑ ูุงููุณุงุทุฉ</div>
            
            <button onclick="switchSection('middleman')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="middleman">
                <span class="text-lg">โ๏ธ</span> <span data-en="Middleman System">ูุธุงู ุงููุณุงุทุฉ (ุงููุนุฒูู)</span>
            </button>
            <button onclick="switchSection('custom_panels')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="custom_panels">
                <span class="text-lg">๐ซ</span> <span data-en="Dynamic Ticket Panels">ุงูุจุงููุงุช ุงูุฏููุงููููุฉ</span>
            </button>
            <button onclick="switchSection('ticket_controls')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="ticket_controls">
                <span class="text-lg">๐๏ธ</span> <span data-en="Internal Ticket Controls">ุงูุชุญูู ุงูุฏุงุฎูู ููุชูุช</span>
            </button>

            <div class="text-[11px] font-black text-slate-500 uppercase tracking-widest mb-3 mt-8 px-2" data-en="Management & Punishments">ุงูุฅุฏุงุฑุฉ ูุงูุนููุจุงุช</div>
            
            <button onclick="switchSection('warnings')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-orange-400 hover:bg-dark-700 font-bold" data-target="warnings">
                <span class="text-lg">โ๏ธ</span> <span data-en="Warnings & Rules Panel">ูุธุงู ุงูุชุญุฐูุฑุงุช ูุจุงูู ุงูุฅุฏุงุฑุฉ</span>
            </button>
            <button onclick="switchSection('commands')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="commands">
                <span class="text-lg">โจ๏ธ</span> <span data-en="Custom Commands & Roles">ุชุฎุตูุต ุงูุฃูุงูุฑ</span>
            </button>
            <button onclick="switchSection('logs')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="logs">
                <span class="text-lg">๐</span> <span data-en="Server Logs & Colors">ุงูุณุฌูุงุช ุงูุฏูููุฉ ูุงูุฃููุงู</span>
            </button>
            <button onclick="switchSection('roles')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="roles">
                <span class="text-lg">๐</span> <span data-en="Staff Roles & Permissions">ุงูุฑุชุจ ูุงูุตูุงุญูุงุช ุงูุนููุง</span>
            </button>
            <button onclick="switchSection('ratings')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="ratings">
                <span class="text-lg">โญ</span> <span data-en="Dual Rating System">ุงูุชููููุงุช ุงููุฒุฏูุฌุฉ</span>
            </button>

            <div class="text-[11px] font-black text-slate-500 uppercase tracking-widest mb-3 mt-8 px-2" data-en="Protection & Economy">ุงูุญูุงูุฉ ูุงูุชูุงุนู</div>
            
            <button onclick="switchSection('protection')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="protection">
                <span class="text-lg">๐ก๏ธ</span> <span data-en="Protection & Anti-Nuke">ุงูุญูุงูุฉ ูุงูู Anti-Nuke</span>
            </button>
            <button onclick="switchSection('welcome')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="welcome">
                <span class="text-lg">๐</span> <span data-en="Welcome & Leave System">ุงูุชุฑุญูุจ ูุงููุบุงุฏุฑุฉ</span>
            </button>
            <button onclick="switchSection('economy')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="economy">
                <span class="text-lg">๐ฐ</span> <span data-en="Economy & Tax">ุงูุงูุชุตุงุฏ ูุงูุถุฑูุจุฉ</span>
            </button>
            <button onclick="switchSection('leveling')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="leveling">
                <span class="text-lg">๐</span> <span data-en="Leveling & Auto-Roles">ูุธุงู ุงููููุงุช (Leveling)</span>
            </button>

        </nav>
    </aside>

    <main class="flex-1 flex flex-col h-screen relative bg-dark-900">
        
        <header class="h-24 flex-shrink-0 border-b border-dark-700 bg-dark-800/80 backdrop-blur-xl flex items-center px-10 z-10 shadow-md relative">
            <div class="flex items-center space-x-5 space-x-reverse z-10">
                <img src="<%= guildIconUrl %>" class="w-14 h-14 rounded-xl border border-dark-600 shadow-lg object-cover">
                <div>
                    <h2 class="text-2xl font-black text-white tracking-wide"><%= guildName %></h2>
                    <p class="text-xs text-brand mt-1 font-bold">SYSTEM ACTIVE ๐ข</p>
                </div>
            </div>
        </header>

        <button type="submit" form="mega-settings-form" onclick="return syncAllDataBeforeSave()" class="fixed bottom-8 left-8 z-[100] flex items-center px-8 py-5 bg-emerald-500 hover:bg-emerald-400 text-dark-900 text-xl font-black rounded-2xl shadow-[0_0_40px_rgba(16,185,129,0.4)] transition-all transform hover:-translate-y-2 hover:scale-105 border border-emerald-400/50">
            <span class="mr-3 ml-2 text-3xl">๐พ</span> <span id="save-btn-text" data-en="Save Settings Now">ุญูุธ ุงูุชุนุฏููุงุช ุงูุขู</span>
        </button>

        <div class="flex-1 overflow-y-auto p-6 md:p-10 z-10 custom-scrollbar relative" id="main-scroll-area">
            
            <% if (typeof success !== 'undefined' && success) { %>
                <div class="mb-8 bg-emerald-500/10 border-r-4 border-emerald-500 text-emerald-400 px-6 py-5 rounded-xl flex items-center shadow-lg mx-auto max-w-5xl">
                    <span class="text-2xl ml-4">โ</span>
                    <div>
                        <h4 class="font-bold text-lg" data-en="Saved Successfully!">ุชู ุงูุญูุธ ุจูุฌุงุญ!</h4>
                        <p class="text-sm opacity-80" data-en="Database updated and applied to the server immediately.">ุชู ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุทุจูู ุงูุฅุนุฏุงุฏุงุช ุนูู ุงูุณูุฑูุฑ ููุฑุงู.</p>
                    </div>
                </div>
            <% } %>

            <form action="/settings/<%= guildId %>/save" method="POST" id="mega-settings-form">
                
                <div id="section-general" class="settings-section active max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="General Settings & Colors โ๏ธ">ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ ูุงูุฃููุงู โ๏ธ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-brand">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3" data-en="Bot Prefix">ุงูุจุงุฏุฆุฉ (Prefix)</label>
                                <input type="text" name="prefix" value="<%= config.prefix || '!' %>" required class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-5 text-white input-glow font-mono text-2xl text-center font-black">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3" data-en="System Language">ูุบุฉ ุงููุธุงู ุงูุฃุณุงุณูุฉ ููุฏุงุดุจูุฑุฏ</label>
                                <select name="language" id="system-language" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-5 text-white input-glow font-bold text-lg cursor-pointer">
                                    <option value="ar" <%= config.language === 'ar' ? 'selected' : '' %>>๐ธ๐ฆ ุงูุนุฑุจูุฉ (Arabic)</option>
                                    <option value="en" <%= config.language === 'en' ? 'selected' : '' %>>๐บ๐ธ ุงูุฅูุฌููุฒูุฉ (English)</option>
                                </select>
                                <p class="text-[10px] text-slate-500 mt-2">ุชุชุบูุฑ ูุบุฉ ุงููุงุฌูุฉ ููุฑ ุงุฎุชูุงุฑู ููุบุฉ.</p>
                            </div>
                        </div>

                        <h3 class="text-2xl font-bold text-white mb-6" data-en="๐จ Global Embed Style">๐จ ุชูุญูุฏ ุฃุดูุงู ุงูุฅููุจุฏ (Global Embeds)</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <label class="block text-sm font-bold text-brand-light mb-3" data-en="โน๏ธ Primary Color">โน๏ธ ุงูููู ุงูุฃุณุงุณู (Primary)</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="emb_primaryColor_picker" value="<%= config.embedSetup?.primaryColor || '#5865F2' %>" class="w-14 h-12 rounded-xl bg-dark-900 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('emb_primaryColor').value = this.value">
                                    <input type="text" id="emb_primaryColor" name="emb_primaryColor" value="<%= config.embedSetup?.primaryColor || '#5865F2' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-3 text-white font-mono uppercase text-center" oninput="document.getElementById('emb_primaryColor_picker').value = this.value">
                                </div>
                            </div>
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <label class="block text-sm font-bold text-emerald-400 mb-3" data-en="โ Success Color">โ ููู ุฑุณุงุฆู ุงููุฌุงุญ</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="emb_successColor_picker" value="<%= config.embedSetup?.successColor || '#3ba55d' %>" class="w-14 h-12 rounded-xl bg-dark-900 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('emb_successColor').value = this.value">
                                    <input type="text" id="emb_successColor" name="emb_successColor" value="<%= config.embedSetup?.successColor || '#3ba55d' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-3 text-white font-mono uppercase text-center" oninput="document.getElementById('emb_successColor_picker').value = this.value">
                                </div>
                            </div>
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <label class="block text-sm font-bold text-red-400 mb-3" data-en="โ Error Color">โ ููู ุฑุณุงุฆู ุงูุฎุทุฃ</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="emb_errorColor_picker" value="<%= config.embedSetup?.errorColor || '#ed4245' %>" class="w-14 h-12 rounded-xl bg-dark-900 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('emb_errorColor').value = this.value">
                                    <input type="text" id="emb_errorColor" name="emb_errorColor" value="<%= config.embedSetup?.errorColor || '#ed4245' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-3 text-white font-mono uppercase text-center" oninput="document.getElementById('emb_errorColor_picker').value = this.value">
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Global Footer Text">ูุต ุงูููุชุฑ ุงูููุญุฏ (Footer Text)</label>
                                <input type="text" name="emb_footerText" value="<%= config.embedSetup?.footerText || 'System Control ยฉ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-bold">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Footer Icon URL">ุฑุงุจุท ุฃููููุฉ ุงูููุชุฑ (Footer Icon)</label>
                                <input type="text" name="emb_footerIconUrl" value="<%= config.embedSetup?.footerIconUrl || '' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow text-left font-mono text-sm" dir="ltr" placeholder="https://...">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Thumbnail URL">ุฑุงุจุท ุงูุตูุฑุฉ ุงูุฌุงูุจูุฉ (Thumbnail)</label>
                                <input type="text" name="emb_thumbnailUrl" value="<%= config.embedSetup?.thumbnailUrl || '' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow text-left font-mono text-sm" dir="ltr" placeholder="https://...">
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-ai_system" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-amber-400 mb-6 border-b border-dark-700 pb-4" data-en="Advanced AI System โจ">ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุชูุฏู โจ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-amber-400 shadow-[0_0_30px_rgba(251,191,36,0.1)]">
                        <div class="flex flex-col md:flex-row items-center justify-between bg-dark-900/80 p-5 rounded-2xl border border-amber-500/30 mb-8 gap-4">
                            <div>
                                <h3 class="text-xl font-bold text-white mb-1" data-en="๐ค Enable AI Chat System">๐ค ุชูุนูู ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุงููุญุงุฏุซุงุช</h3>
                                <p class="text-sm text-slate-400" data-en="Makes the bot reply in specific channels just like a human.">ูุฌุนู ุงูุจูุช ูุฑุฏ ุนูู ุงูุฑุณุงุฆู ูู ุงูุฑูู ุงููุฎุตุตุฉ ูุฃูู ุฅูุณุงู ุญูููู.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="ai_enabled" id="ai_enabled" <%= config.aiSystem?.enabled !== false ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="flex items-center justify-between p-5 bg-dark-800 rounded-2xl border border-dark-600 mb-8">
                            <div>
                                <h3 class="text-lg font-bold text-brand-light" data-en="Allow User to Choose Persona (Hybrid)">ุงูุณูุงุญ ููุนุถู ุจุงุฎุชูุงุฑ ุงูุดุฎุตูุฉ (Hybrid Mode)</h3>
                                <p class="text-xs text-slate-400 mt-1" data-en="Allows users to switch between Boy/Girl personas.">ูุณูุญ ููุนุถู ุจุงุฎุชูุงุฑ ุงูุชุญุฏุซ ูุน ุงูููุฏ ุฃู ุงูุจูุช.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="ai_allowUserChoice" id="ai_allowUserChoice" <%= config.aiSystem?.allowUserChoice !== false ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <h4 class="text-blue-400 font-bold mb-4 text-lg border-b border-dark-600 pb-2" data-en="๐ฆ Boy Persona Settings">๐ฆ ุฅุนุฏุงุฏุงุช ุดุฎุตูุฉ ุงูููุฏ</h4>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Bot Name">ุงุณู ุงูุจูุช</label>
                                <input type="text" name="ai_defaultBoyName" value="<%= config.aiSystem?.defaultBoyName || 'ุฒูุฒู' %>" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white input-glow font-bold mb-4">
                            </div>
                            
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <h4 class="text-pink-400 font-bold mb-4 text-lg border-b border-dark-600 pb-2" data-en="๐ง Girl Persona Settings">๐ง ุฅุนุฏุงุฏุงุช ุดุฎุตูุฉ ุงูุจูุช</h4>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Bot Name">ุงุณู ุงูุจูุช</label>
                                <input type="text" name="ai_defaultGirlName" value="<%= config.aiSystem?.defaultGirlName || 'ุณูุณู' %>" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white input-glow font-bold mb-4">
                            </div>
                        </div>

                        <div class="bg-dark-900/80 p-5 rounded-2xl border border-dark-700">
                            <label class="block text-sm font-bold text-slate-300 mb-3 text-lg" data-en="AI Chat Channel">ุฑูู ุงูุฏุฑุฏุดุฉ ูุน ุงูุฐูุงุก ุงูุงุตุทูุงุนู</label>
                            <select name="ai_chatChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-4 px-4 text-amber-50 input-glow cursor-pointer font-bold text-lg">
                                <option value="" data-en="-- Select Channel --">-- ุงุฎุชุฑ ุงูุฑูู ููุชุญุฏุซ ูููุง ุงูุฃุนุถุงุก --</option>
                                <% textChannels.forEach(ch => { %> 
                                    <option value="<%= ch.id %>" <%= config.aiSystem?.chatChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> 
                                <% }) %>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="section-live_embed" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Live Embed Maker ๐จ">ุตุงูุน ุงูุฅููุจุฏ ุงูููุฑู ๐จ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 border-t-4 border-t-fuchsia-500">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-6">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3" data-en="Target Channel">ุงุฎุชุฑ ุงูุฑูู ููุฅุฑุณุงู</label>
                                <select id="live_embed_channel" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white input-glow font-bold cursor-pointer">
                                    <option value="" data-en="-- Select Channel --">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %>
                                        <option value="<%= ch.id %>">๐ฌ <%= ch.name %></option>
                                    <% }) %>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3" data-en="Embed Color">ููู ุงูุฅููุจุฏ</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="live_embed_color_picker" value="#5865F2" class="w-14 h-12 rounded-xl cursor-pointer bg-dark-900 border border-dark-700 p-1" onchange="document.getElementById('live_embed_color').value = this.value">
                                    <input type="text" id="live_embed_color" value="#5865F2" class="flex-1 bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white input-glow font-mono uppercase text-center">
                                </div>
                            </div>
                        </div>

                        <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Title">ุงูุนููุงู (Title)</label>
                        <input type="text" id="live_embed_title" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-bold text-lg mb-6" placeholder="ุงูุชุจ ุนููุงู ุงูุฅููุจุฏ...">
                        
                        <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Description">ุงููุตู / ุงูููุงููู (ูุฏุนู ุงูุฒุฎุงุฑู)</label>
                        <textarea id="live_embed_desc" rows="6" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-5 text-white input-glow resize-y mb-6" placeholder="ุงูุชุจ ูุญุชูู ุงูุฅููุจุฏ ููุง..."></textarea>
                        
                        <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Image URL (Optional)">ุฑุงุจุท ุตูุฑุฉ (ุงุฎุชูุงุฑู)</label>
                        <input type="text" id="live_embed_image" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow text-left font-mono mb-8" dir="ltr" placeholder="https://...">
                        
                        <div id="live_embed_status" class="hidden mb-6 px-5 py-4 rounded-xl font-bold text-center"></div>
                        
                        <button type="button" onclick="sendLiveEmbed('<%= guildId %>')" class="w-full py-4 bg-fuchsia-600 hover:bg-fuchsia-500 text-white font-black text-xl rounded-xl transition-all shadow-lg" data-en="๐ Send Embed to Discord Now!">
                            ๐ ุฅุฑุณุงู ุงูุฅููุจุฏ ููุฏูุณููุฑุฏ ุงูุขู!
                        </button>
                    </div>
                </div>

<div id="section-middleman" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Middleman System โ๏ธ">ูุธุงู ุงููุณุงุทุฉ ุงููุนุฒูู โ๏ธ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-amber-500">
                        <div class="flex items-center justify-between bg-dark-900/50 p-6 rounded-2xl border border-dark-700 mb-8">
                            <div>
                                <h3 class="text-xl font-bold text-white mb-1" data-en="Enable Middleman System">ุชูุนูู ูุธุงู ุงููุณุงุทุฉ</h3>
                                <p class="text-sm text-slate-400" data-en="Relies on the !done command for rating separately.">ูุนุชูุฏ ุนูู ุงูุชูููู ุจุฃูุฑ !done ุจุดูู ูููุตู.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="mm_enabled" <%= config.middlemanSystem?.enabled ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Ticket Category">ูุณู ุงูุชุฐุงูุฑ (Category)</label>
                                <select name="mm_categoryId" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white font-bold cursor-pointer">
                                    <option value="" data-en="-- Select Category --">-- ุงุฎุชุฑ ุงููุณู --</option>
                                    <% categories.forEach(cat => { %> 
                                        <option value="<%= cat.id %>" <%= config.middlemanSystem?.categoryId === cat.id ? 'selected' : '' %>>๐ <%= cat.name %></option> 
                                    <% }) %>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Panel Channel">ุฑูู ุฅุฑุณุงู ุงูุจุงูู ุงูุฎุงุฑุฌู</label>
                                <select name="mm_panelChannelId" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white font-bold cursor-pointer">
                                    <option value="" data-en="-- Select Channel --">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %> 
                                        <option value="<%= ch.id %>" <%= config.middlemanSystem?.panelChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> 
                                    <% }) %>
                                </select>
                            </div>
                        </div>

                        <h3 class="text-2xl font-bold text-white mb-6 border-b border-dark-700 pb-2" data-en="๐ผ๏ธ Outer Panel Design">๐ผ๏ธ ุชุตููู ุงูุจุงูู ุงูุฎุงุฑุฌู</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Outer Panel Title">ุนููุงู ุงูุฅููุจุฏ ุงูุฎุงุฑุฌู</label>
                                <input type="text" name="mm_panelTitle" value="<%= config.middlemanSystem?.panelTitle || 'ุชุฐูุฑุฉ ูุณุงุทุฉ ุขููุฉ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white font-bold input-glow">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Outer Panel Color">ููู ุงูุฅููุจุฏ ุงูุฎุงุฑุฌู</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="mm_panelColor_picker" value="<%= config.middlemanSystem?.panelColor || '#f2a658' %>" class="w-14 h-12 rounded-xl bg-dark-900 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('mm_panelColor').value = this.value">
                                    <input type="text" id="mm_panelColor" name="mm_panelColor" value="<%= config.middlemanSystem?.panelColor || '#f2a658' %>" class="flex-1 bg-dark-900 border border-dark-600 rounded-xl py-3 px-4 text-white font-mono uppercase text-center input-glow">
                                </div>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Outer Panel Description">ูุตู ุงูุฅููุจุฏ ุงูุฎุงุฑุฌู</label>
                                <textarea name="mm_panelDescription" rows="3" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-4 text-white resize-y input-glow"><%= config.middlemanSystem?.panelDescription || 'ูุทูุจ ูุณูุท ูุนุชูุฏุ ูุฑุฌู ูุชุญ ุชุฐูุฑุฉ ูู ููุง.' %></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Button Label">ุงุณู ุงูุฒุฑ (Button Label)</label>
                                <input type="text" name="mm_buttonLabel" value="<%= config.middlemanSystem?.buttonLabel || 'ุทูุจ ูุณูุท ๐ก๏ธ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white font-bold input-glow">
                            </div>
                        </div>
                        
                        <h3 class="text-2xl font-bold text-white mb-6 border-b border-dark-700 pb-2" data-en="๐ Modal & Inner Ticket Design">๐ ุงููุงูุฐุฉ (Modal) ูุงูุฅููุจุฏ ุงูุฏุงุฎูู</h3>
                        
                        <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Modal Title">ุนููุงู ุงููุงูุฐุฉ ุงูููุจุซูุฉ</label>
                        <input type="text" name="mm_modalTitle" value="<%= config.middlemanSystem?.modalTitle || 'ุจูุงูุงุช ุงููุณุงุทุฉ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white font-bold mb-6 input-glow">
                        
                        <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 mb-6 shadow-inner">
                            <h4 class="text-lg font-bold text-brand-light mb-4" data-en="Modal Questions">ุฃุณุฆูุฉ ุงููุงูุฐุฉ</h4>
                            <input type="hidden" name="mm_modalFieldsData" id="mm_modalFieldsData" value="<%= JSON.stringify(config.middlemanSystem?.modalFields || []) %>">
                            <div id="mm-fields-ui-container" class="space-y-4 mb-6">
                                </div>
                            <button type="button" onclick="addMmFieldUI()" class="w-full py-4 bg-emerald-600/10 hover:bg-emerald-600/30 text-emerald-400 font-bold rounded-xl border-2 border-dashed border-emerald-500 transition-all" data-en="โ Add Question to Modal">
                                โ ุฅุถุงูุฉ ุณุคุงู ูููุงูุฐุฉ
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Inner Ticket Title">ุนููุงู ุงูุฅููุจุฏ ุงูุฏุงุฎูู ููุชุฐูุฑุฉ</label>
                                <input type="text" name="mm_insideTicketTitle" value="<%= config.middlemanSystem?.insideTicketTitle || 'ุชุฐูุฑุฉ ุงููุณุงุทุฉ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white font-bold input-glow">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Inner Ticket Color">ููู ุงูุฅููุจุฏ ุงูุฏุงุฎูู ููุชุฐูุฑุฉ</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="mm_insideTicketColor_picker" value="<%= config.middlemanSystem?.insideTicketColor || '#f2a658' %>" class="w-14 h-12 rounded-xl bg-dark-900 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('mm_insideTicketColor').value = this.value">
                                    <input type="text" id="mm_insideTicketColor" name="mm_insideTicketColor" value="<%= config.middlemanSystem?.insideTicketColor || '#f2a658' %>" class="flex-1 bg-dark-900 border border-dark-600 rounded-xl py-3 px-4 text-white font-mono uppercase text-center input-glow">
                                </div>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Inner Ticket Description (Supports {user})">ูุตู ุงูุฅููุจุฏ ุงูุฏุงุฎูู (ูุฏุนู {user})</label>
                                <textarea name="mm_insideTicketDescription" rows="3" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-4 text-white resize-y input-glow"><%= config.middlemanSystem?.insideTicketDescription || 'ุฃููุงู ุจู {user}ุ ูุฑุฌู ุงูุชุธุงุฑ ุงููุณูุท.' %></textarea>
                            </div>
                            
                            <div class="md:col-span-2 bg-dark-800 p-6 rounded-xl border border-dark-600 shadow-lg">
                                <label class="block text-sm font-bold text-amber-400 mb-3" data-en="๐จ Modal Answers Embed Color (Code Blocks)">๐จ ููู ุฅููุจุฏ ุฅุฌุงุจุงุช ุงููุงูุฐุฉ ุงููุฎุตุต (ุงููุฑุจุนุงุช - Code Blocks)</label>
                                <div class="flex items-center space-x-4 space-x-reverse">
                                    <input type="color" id="mm_modalAnswersEmbedColor_picker" value="<%= config.middlemanSystem?.modalAnswersEmbedColor || '#f2a658' %>" class="w-16 h-12 rounded-xl bg-dark-900 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('mm_modalAnswersEmbedColor').value = this.value">
                                    <input type="text" id="mm_modalAnswersEmbedColor" name="mm_modalAnswersEmbedColor" value="<%= config.middlemanSystem?.modalAnswersEmbedColor || '#f2a658' %>" class="flex-1 bg-dark-900 border border-dark-600 rounded-xl py-3 px-4 text-white font-mono uppercase text-center input-glow">
                                </div>
                                <p class="text-xs text-slate-400 mt-3" data-en="This is the specific embed color where the user's answers will be displayed in Code Blocks.">ุงูุฅููุจุฏ ุงูุฐู ุณุชุธูุฑ ุจุฏุงุฎูู ุงููุฑุจุนุงุช ุงูุฎุงุตุฉ ุจุฅุฌุงุจุงุช ุงูุนุถู.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-custom_panels" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Dynamic Ticket Panels ๐ซ">ุงูุจุงููุงุช ุงูุฏููุงููููุฉ ๐ซ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-blue-500">
                        <input type="hidden" name="ticketPanelsData" id="ticketPanelsData" value="<%= JSON.stringify(config.ticketPanels || []) %>">
                        
                        <div id="dynamic-panels-container" class="space-y-10">
                            </div>
                        
                        <button type="button" onclick="addNewPanelUI()" class="mt-10 flex items-center justify-center w-full px-8 py-5 bg-blue-600 hover:bg-blue-500 text-white font-black text-xl rounded-2xl shadow-[0_10px_30px_rgba(37,99,235,0.4)] transition-all transform hover:-translate-y-1" data-en="โ Add New Ticket Panel">
                            <span class="text-3xl mr-3">โ</span> ุฅุถุงูุฉ ุจุงูู ุชุฐุงูุฑ ุฌุฏูุฏ
                        </button>
                    </div>
                </div>

                <div id="section-ticket_controls" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Internal Ticket Controls ๐๏ธ">ุงูุชุญูู ุงูุฏุงุฎูู ููุชูุช ๐๏ธ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-indigo-500">
                        
                        <div class="flex flex-col md:flex-row items-center justify-between p-6 bg-dark-900/80 rounded-2xl border border-indigo-500/30 mb-8 shadow-inner gap-4">
                            <div>
                                <h3 class="text-xl font-bold text-white mb-1" data-en="๐ Two-Step Close System">๐ ุงูุฅุบูุงู ุจุฎุทูุชูู (Two-Step Close)</h3>
                                <p class="text-sm text-slate-400" data-en="Pressing Close will show Reopen/Delete buttons instead of deleting immediately.">ุนูุฏ ุงูุถุบุท ุนูู Closeุ ูุง ุชูุญุฐู ุงูุชุฐูุฑุฉ ููุฑุงูุ ุจู ุชุธูุฑ ุฃุฒุฑุงุฑ (Reopen / Delete / Delete With Reason).</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="tc_twoStepClose" id="tc_twoStepClose" <%= config.ticketControls?.twoStepClose !== false ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 relative overflow-hidden shadow-sm">
                                <div class="absolute top-0 right-0 bg-brand text-[12px] font-bold px-3 py-1 rounded-bl-xl text-white">Counter</div>
                                <label class="block text-sm font-bold text-white mb-3 mt-2" data-en="Next Ticket Number">ุฑูู ุงูุชูุช ุงููุงุฏู (ูุฅููุงู ุงูุนุฏ ุงููุฏูู)</label>
                                <input type="number" name="tc_ticketCounter" value="<%= config.ticketControls?.ticketCounter || 1 %>" min="1" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-4 px-4 text-brand-light font-mono text-3xl text-center font-black outline-none focus:border-brand">
                            </div>

                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 shadow-sm">
                                <label class="block text-sm font-bold text-white mb-3" data-en="Transcript Channel (Saved Messages)">ุฑูู ุญูุธ ุงูุชุฑุงูุณูุฑูุจุช (ุฑุณุงุฆู ุงูุชุฐูุฑุฉ)</label>
                                <select name="tc_transcriptChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-4 px-4 text-white input-glow cursor-pointer font-bold">
                                    <option value="" data-en="-- Select Channel --">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %> 
                                        <option value="<%= ch.id %>" <%= config.ticketControls?.transcriptChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> 
                                    <% }) %>
                                </select>
                            </div>

                            <div class="md:col-span-2 bg-dark-900/60 p-6 rounded-2xl border-2 border-blue-500/30 shadow-lg">
                                <label class="block text-lg font-black text-blue-400 mb-3" data-en="๐ Ticket Logs Channel (Open, Close, Claim)">๐ ุฑูู ููุฌ ุงูุชุฐุงูุฑ (ูุชุญุ ุฅุบูุงูุ ุงุณุชูุงู Claim)</label>
                                <select name="tc_ticketLogChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-4 px-4 text-white input-glow cursor-pointer font-bold mb-3">
                                    <option value="" data-en="-- Select Channel --">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %> 
                                        <option value="<%= ch.id %>" <%= config.ticketControls?.ticketLogChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> 
                                    <% }) %>
                                </select>
                                <p class="text-sm text-slate-400 font-bold" data-en="Detailed logs for every ticket action will be sent here.">ุณูุชู ุฅุฑุณุงู ุณุฌูุงุช ููุตูุฉ ููู ุชุฐูุฑุฉ ุฅูู ูุฐุง ุงูุฑูู (ูู ูุงู ุจูุชุญูุงุ ุฅุบูุงููุงุ ุฃู ุงุณุชูุงููุง).</p>
                            </div>
                        </div>

                        <h3 class="text-2xl font-bold text-amber-400 mb-6 border-b border-dark-700 pb-2" data-en="๐ต๏ธ Claim Settings">๐ต๏ธ ุฅุนุฏุงุฏุงุช ุฒุฑ ุงูุงุณุชูุงู (Claim Settings)</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-6 bg-dark-900/50 rounded-2xl border border-dark-700 transition-all shadow-sm" id="hide_claim_container">
                                <div>
                                    <h3 class="text-lg font-bold text-white mb-1" data-en="Hide Ticket on Claim">ุฅุฎูุงุก ุงูุชุฐูุฑุฉ ุนูุฏ ุงูุงุณุชูุงู</h3>
                                    <p class="text-xs text-slate-400" data-en="Hides the ticket from other staff members once claimed.">ูุฎูู ุงูุชูุช ุนู ุจุงูู ุทุงูู ุงูุฅุฏุงุฑุฉ ุจูุฌุฑุฏ ุถุบุท ุงูุฅุฏุงุฑู ุนูู Claim.</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" name="tc_hideTicketOnClaim" id="tc_hideTicketOnClaim" <%= config.ticketControls?.hideTicketOnClaim ? 'checked' : '' %>>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between p-6 bg-dark-900/50 rounded-2xl border border-dark-700 transition-all shadow-sm" id="read_claim_container">
                                <div>
                                    <h3 class="text-lg font-bold text-white mb-1" data-en="Read-Only for Other Staff">ููุน ุงูุฅุฏุงุฑููู ุงูุขุฎุฑูู ูู ุงููุชุงุจุฉ (Read-Only)</h3>
                                    <p class="text-xs text-slate-400" data-en="Allows staff to view the ticket but prevents them from typing.">ูุณูุญ ููุฅุฏุงุฑุฉ ุจุฑุคูุฉ ุงูุชูุช ูููู ูููุนูู ูู ุงููุชุงุจุฉ ููู ุจุนุฏ ุงูุงุณุชูุงู.</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" name="tc_readOnlyStaffOnClaim" id="tc_readOnlyStaffOnClaim" <%= config.ticketControls?.readOnlyStaffOnClaim ? 'checked' : '' %>>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-warnings" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Warnings & Management Panel โ๏ธ">ูุธุงู ุงูุชุญุฐูุฑุงุช ูุจุงูู ุงูุฅุฏุงุฑุฉ โ๏ธ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-orange-500">
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Max Warnings Limit">ุฃูุตู ุนุฏุฏ ููุชุญุฐูุฑุงุช (ูุจู ุงูุนููุจุฉ)</label>
                                <input type="number" name="warn_maxWarnings" value="<%= config.warnings?.maxWarnings || 3 %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-4 text-white text-center font-black text-2xl input-glow">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Auto Punishment Action">ุงูุนููุจุฉ ุงูุชููุงุฆูุฉ (ุจุนุฏ ุจููุบ ุงูุญุฏ)</label>
                                <select name="warn_autoAction" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-4 text-white font-bold cursor-pointer input-glow">
                                    <option value="none" <%= config.warnings?.autoAction === 'none' ? 'selected' : '' %> data-en="โ Disabled (No Action)">โ ูุนุทู (ุจุฏูู ุนููุจุฉ ุชููุงุฆูุฉ)</option>
                                    <option value="timeout" <%= config.warnings?.autoAction === 'timeout' ? 'selected' : '' %> data-en="โณ Timeout">โณ ุฅุณูุงุช (Timeout)</option>
                                    <option value="kick" <%= config.warnings?.autoAction === 'kick' ? 'selected' : '' %> data-en="๐ข Kick">๐ข ุทุฑุฏ (Kick)</option>
                                    <option value="ban" <%= config.warnings?.autoAction === 'ban' ? 'selected' : '' %> data-en="๐จ Ban">๐จ ุญุธุฑ (Ban)</option>
                                </select>
                            </div>
                        </div>

                        <div class="bg-dark-900/80 p-8 rounded-3xl border border-red-500/40 mb-10 shadow-lg">
                            <h3 class="text-2xl font-black text-red-400 mb-6 flex items-center border-b border-dark-700 pb-3" data-en="๐ด Staff Warnings Panel">๐ด ุจุงูู ุชุญูู ุงูุชุญุฐูุฑุงุช (ููุฑุณู ููุฅุฏุงุฑุฉ)</h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-6">
                                <div>
                                    <label class="text-sm font-bold text-slate-400 block mb-2" data-en="Panel Channel">ุฑูู ุฅุฑุณุงู ุงูุจุงูู</label>
                                    <select name="warn_panelChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl p-3.5 text-white font-bold cursor-pointer input-glow">
                                        <option value="" data-en="-- Select Channel --">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                        <% textChannels.forEach(ch => { %>
                                            <option value="<%= ch.id %>" <%= config.warnings?.panelChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option>
                                        <% }) %>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-sm font-bold text-slate-400 block mb-2" data-en="Panel Color">ููู ุงูุจุงูู</label>
                                    <div class="flex items-center space-x-3 space-x-reverse">
                                        <input type="color" id="warn_panelColor_picker" value="<%= config.warnings?.panelColor || '#ed4245' %>" class="w-16 h-12 rounded-xl bg-dark-800 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('warn_panelColor').value = this.value">
                                        <input type="text" id="warn_panelColor" name="warn_panelColor" value="<%= config.warnings?.panelColor || '#ed4245' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white font-mono uppercase text-center input-glow">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div>
                                    <label class="text-sm font-bold text-slate-400 block mb-2" data-en="Panel Title">ุนููุงู ุงูุจุงูู</label>
                                    <input type="text" name="warn_panelTitle" value="<%= config.warnings?.panelTitle || 'ููุญุฉ ุชุญูู ุงูุชุญุฐูุฑุงุช' %>" class="w-full bg-dark-800 border border-dark-600 rounded-xl p-3.5 text-white font-bold input-glow">
                                </div>
                                <div>
                                    <label class="text-sm font-bold text-slate-400 block mb-2" data-en="Panel Description">ูุตู ุงูุจุงูู</label>
                                    <input type="text" name="warn_panelDescription" value="<%= config.warnings?.panelDescription || 'ุงุณุชุฎุฏู ุงูุฃุฒุฑุงุฑ ุฃุฏูุงู ูุฅุฏุงุฑุฉ ุชุญุฐูุฑุงุช ุงูุฃุนุถุงุก ุจูู ุณูููุฉ.' %>" class="w-full bg-dark-800 border border-dark-600 rounded-xl p-3.5 text-white input-glow">
                                </div>
                            </div>
                        </div>

                        <div class="bg-dark-900/60 p-8 rounded-3xl border border-dark-700 shadow-inner">
                            <div class="flex justify-between items-center mb-6 border-b border-dark-600 pb-4">
                                <div>
                                    <h4 class="text-2xl font-black text-brand-light" data-en="Warning Reasons & DM Messages">ุฃุณุจุงุจ ุงูุชุญุฐูุฑ ูุฑุณุงุฆู ุงูุฎุงุต (DM)</h4>
                                    <p class="text-sm text-slate-400 mt-2" data-en="Add rules. Each rule will send a specific message to the member.">ุฃุถู ุงูููุงููู ููุง. ูู ุณุจุจ ุณููุชูู ุฑุณุงูุฉ ุฎุงุตุฉ ุชูุฑุณู ููุนุถู ุนูุฏ ุชุญุฐูุฑู.</p>
                                </div>
                                <div class="flex space-x-3 space-x-reverse">
                                    <button type="button" onclick="addWarnReason('ar')" class="px-5 py-3 bg-brand hover:bg-brand-light text-sm text-white font-black rounded-xl transition-all shadow-md" data-en="โ Add Reason (AR)">โ ุฅุถุงูุฉ ุณุจุจ (ุนุฑุจู)</button>
                                    <button type="button" onclick="addWarnReason('en')" class="px-5 py-3 bg-indigo-600 hover:bg-indigo-500 text-sm text-white font-black rounded-xl transition-all shadow-md" dir="ltr">โ Add (EN)</button>
                                </div>
                            </div>
                            
                            <input type="hidden" name="warn_reasonsDataAr" id="warn_reasonsDataAr" value="<%= JSON.stringify(config.warnings?.reasonsDataAr || [{reason: 'ุณุจ ูุดุชู', dmMessage: 'ููุฏ ุชู ุชุญุฐูุฑู ุจุณุจุจ ุงูุณุจ ูุงูุดุชู. ูุฑุฌู ุงุญุชุฑุงู ุงูููุงููู.'}]) %>">
                            <input type="hidden" name="warn_reasonsDataEn" id="warn_reasonsDataEn" value="<%= JSON.stringify(config.warnings?.reasonsDataEn || [{reason: 'Swearing', dmMessage: 'You have been warned for swearing.'}]) %>">
                            
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                <div id="warn-ar-container" class="space-y-4">
                                    </div>
                                <div id="warn-en-container" class="space-y-4" dir="ltr">
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>

<div id="section-commands" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Custom Commands & Punishments โจ๏ธ">ุชุฎุตูุต ุงูุฃูุงูุฑ ูุงูุนููุจุงุช โจ๏ธ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-cyan-500">
                        <h3 class="text-2xl font-bold text-red-400 mb-6" data-en="๐จ Punishment Commands">๐จ ุฃูุงูุฑ ุงูุนููุจุงุช (ุงูุฃุณุงุณูุฉ ูุงูุนูุณูุฉ)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                            
                            <div class="bg-dark-900/50 p-5 rounded-xl border border-red-500/30 shadow-md">
                                <label class="block text-xs font-bold text-slate-400 mb-2" data-en="Ban Command">ุฃูุฑ ุงูุจุงูุฏ (Ban)</label>
                                <input type="text" name="cmd_banCmd" value="<%= config.commands?.banCmd || 'ban' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-3 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-xs font-bold text-emerald-400 mb-2" data-en="Unban Command">ุฃูุฑ ูู ุงูุจุงูุฏ (Unban)</label>
                                <input type="text" name="cmd_unbanCmd" value="<%= config.commands?.unbanCmd || 'unban' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-3 text-white font-mono text-sm mb-4 input-glow">
                                <label class="block text-xs font-bold text-slate-300 mb-2" data-en="Allowed Roles">ุงูุฑุชุจ ุงููุณููุญุฉ:</label>
                                <select name="role_banAllowed" multiple class="w-full h-20 bg-dark-800 border border-dark-600 rounded-lg p-2 text-xs text-white custom-scrollbar focus:border-brand outline-none">
                                    <% serverRoles.forEach(r => { %>
                                        <option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.ban || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option>
                                    <% }) %>
                                </select>
                            </div>
                            
                            <div class="bg-dark-900/50 p-5 rounded-xl border border-orange-500/30 shadow-md">
                                <label class="block text-xs font-bold text-slate-400 mb-2" data-en="Timeout Command">ุฃูุฑ ุงูุชุงูู ุฃูุช (Timeout)</label>
                                <input type="text" name="cmd_timeoutCmd" value="<%= config.commands?.timeoutCmd || 'timeout' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-3 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-xs font-bold text-emerald-400 mb-2" data-en="Untimeout Command">ุฃูุฑ ูู ุงูุชุงูู (Untimeout)</label>
                                <input type="text" name="cmd_untimeoutCmd" value="<%= config.commands?.untimeoutCmd || 'untimeout' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-3 text-white font-mono text-sm mb-4 input-glow">
                                <label class="block text-xs font-bold text-slate-300 mb-2" data-en="Allowed Roles">ุงูุฑุชุจ ุงููุณููุญุฉ:</label>
                                <select name="role_timeoutAllowed" multiple class="w-full h-20 bg-dark-800 border border-dark-600 rounded-lg p-2 text-xs text-white custom-scrollbar focus:border-brand outline-none">
                                    <% serverRoles.forEach(r => { %>
                                        <option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.timeout || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option>
                                    <% }) %>
                                </select>
                            </div>

                            <div class="bg-dark-900/50 p-5 rounded-xl border border-yellow-500/30 shadow-md">
                                <label class="block text-xs font-bold text-slate-400 mb-2" data-en="Warn Command">ุฃูุฑ ุงูุชุญุฐูุฑ (Warn)</label>
                                <input type="text" name="cmd_warnCmd" value="<%= config.commands?.warnCmd || 'warn' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-3 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-xs font-bold text-emerald-400 mb-2" data-en="Unwarn Command">ุฃูุฑ ูู ุงูุชุญุฐูุฑ (Unwarn)</label>
                                <input type="text" name="cmd_unwarnCmd" value="<%= config.commands?.unwarnCmd || 'unwarn' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-3 text-white font-mono text-sm mb-4 input-glow">
                                <label class="block text-xs font-bold text-slate-300 mb-2" data-en="Allowed Roles">ุงูุฑุชุจ ุงููุณููุญุฉ:</label>
                                <select name="role_warnAllowed" multiple class="w-full h-20 bg-dark-800 border border-dark-600 rounded-lg p-2 text-xs text-white custom-scrollbar focus:border-brand outline-none">
                                    <% serverRoles.forEach(r => { %>
                                        <option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.warn || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option>
                                    <% }) %>
                                </select>
                            </div>

                            <div class="bg-dark-900/50 p-5 rounded-xl border border-slate-500/30 shadow-md">
                                <label class="block text-xs font-bold text-slate-400 mb-2" data-en="Mute Command">ุฃูุฑ ุงููููุช ุงููุชุงุจู (Mute)</label>
                                <input type="text" name="cmd_muteCmd" value="<%= config.commands?.muteCmd || 'mute' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-3 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-xs font-bold text-emerald-400 mb-2" data-en="Unmute Command">ุฃูุฑ ูู ุงููููุช (Unmute)</label>
                                <input type="text" name="cmd_unmuteCmd" value="<%= config.commands?.unmuteCmd || 'unmute' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-3 text-white font-mono text-sm mb-4 input-glow">
                                <label class="block text-xs font-bold text-slate-300 mb-2" data-en="Allowed Roles">ุงูุฑุชุจ ุงููุณููุญุฉ:</label>
                                <select name="role_muteAllowed" multiple class="w-full h-20 bg-dark-800 border border-dark-600 rounded-lg p-2 text-xs text-white custom-scrollbar focus:border-brand outline-none">
                                    <% serverRoles.forEach(r => { %>
                                        <option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.mute || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option>
                                    <% }) %>
                                </select>
                            </div>
                        </div>

                        <hr class="border-dark-700 my-8">
                        <h3 class="text-2xl font-bold text-brand-light mb-6" data-en="๐๏ธ General Admin Commands">๐๏ธ ุงูุฃูุงูุฑ ุงูุฅุฏุงุฑูุฉ ุงูุนุงูุฉ ูุงูุถุฑูุจุฉ</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-5 mb-8">
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-emerald-500/30 shadow-sm">
                                <label class="block text-xs font-bold text-emerald-400 mb-2" data-en="Tax">ุงูุถุฑูุจุฉ (Tax)</label>
                                <input type="text" name="cmd_taxCmd" value="<%= config.commands?.taxCmd || 'tax' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-2.5 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-[10px] font-bold text-slate-400 mb-1" data-en="Roles:">ุงูุฑุชุจ:</label>
                                <select name="role_taxAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded-lg p-1.5 text-xs text-white custom-scrollbar">
                                    <% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.tax || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %>
                                </select>
                            </div>
                            
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-dark-700 shadow-sm">
                                <label class="block text-xs font-bold text-slate-300 mb-2" data-en="Clear Chat">ูุณุญ (Clear)</label>
                                <input type="text" name="cmd_clearCmd" value="<%= config.commands?.clearCmd || 'clear' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-2.5 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-[10px] font-bold text-slate-400 mb-1" data-en="Roles:">ุงูุฑุชุจ:</label>
                                <select name="role_clearAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded-lg p-1.5 text-xs text-white custom-scrollbar">
                                    <% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.clear || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %>
                                </select>
                            </div>
                            
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-dark-700 shadow-sm">
                                <label class="block text-xs font-bold text-slate-300 mb-2" data-en="Come">ุงุณุชุฏุนุงุก (Come)</label>
                                <input type="text" name="cmd_comeCmd" value="<%= config.commands?.comeCmd || 'come' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-2.5 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-[10px] font-bold text-slate-400 mb-1" data-en="Roles:">ุงูุฑุชุจ:</label>
                                <select name="role_comeAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded-lg p-1.5 text-xs text-white custom-scrollbar">
                                    <% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.come || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %>
                                </select>
                            </div>
                            
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-blue-500/30 shadow-sm">
                                <label class="block text-xs font-bold text-blue-400 mb-2" data-en="Move">ุณุญุจ ุตูุชู (Move)</label>
                                <input type="text" name="cmd_moveCmd" value="<%= config.commands?.moveCmd || 'move' %>" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-2.5 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-[10px] font-bold text-slate-400 mb-1" data-en="Roles:">ุงูุฑุชุจ:</label>
                                <select name="role_moveAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded-lg p-1.5 text-xs text-white custom-scrollbar">
                                    <% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.move || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %>
                                </select>
                            </div>
                            
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-dark-700 shadow-sm">
                                <label class="block text-[11px] font-bold text-slate-300 mb-2" data-en="Lock/Unlock">ููู ุงูุฑูู (Lock/Unlock)</label>
                                <input type="text" name="cmd_lockCmd" value="<%= config.commands?.lockCmd || 'lock' %>" class="w-full bg-dark-800 border border-dark-600 rounded p-2 text-white font-mono text-[11px] mb-1.5 input-glow" placeholder="ููู">
                                <input type="text" name="cmd_unlockCmd" value="<%= config.commands?.unlockCmd || 'unlock' %>" class="w-full bg-dark-800 border border-dark-600 rounded p-2 text-white font-mono text-[11px] mb-2 input-glow" placeholder="ูุชุญ">
                                <label class="block text-[10px] font-bold text-slate-400 mb-1" data-en="Roles:">ุงูุฑุชุจ:</label>
                                <select name="role_lockAllowed" multiple class="w-full h-12 bg-dark-800 border border-dark-600 rounded-lg p-1 text-[10px] text-white custom-scrollbar">
                                    <% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.lock || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %>
                                </select>
                            </div>
                        </div>

                        <h3 class="text-xl font-bold text-amber-500 mb-4 border-t border-dark-700 pt-6" data-en="โ๏ธ Middleman & Trade Commands">โ๏ธ ุฃูุงูุฑ ุงููุณุงุทุฉ ุงูุนููุง (Trade, Approve, Done)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-dark-800 p-5 rounded-2xl border border-dark-600 shadow-sm">
                                <label class="block text-sm font-bold text-white mb-2">ุฃูุฑ Trade</label>
                                <input type="text" name="cmd_tradeCmd" value="<%= config.commands?.tradeCmd || 'trade' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl p-3 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-xs font-bold text-slate-400 mb-2" data-en="Roles:">ุงูุฑุชุจ:</label>
                                <select name="role_tradeAllowed" multiple class="w-full h-20 bg-dark-900 border border-dark-700 rounded-xl p-2 text-xs text-white custom-scrollbar">
                                    <% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.trade || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %>
                                </select>
                            </div>
                            <div class="bg-dark-800 p-5 rounded-2xl border border-dark-600 shadow-sm">
                                <label class="block text-sm font-bold text-white mb-2">ุฃูุฑ Approve</label>
                                <input type="text" name="cmd_approveCmd" value="<%= config.commands?.approveCmd || 'approve' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl p-3 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-xs font-bold text-slate-400 mb-2" data-en="Roles:">ุงูุฑุชุจ:</label>
                                <select name="role_approveAllowed" multiple class="w-full h-20 bg-dark-900 border border-dark-700 rounded-xl p-2 text-xs text-white custom-scrollbar">
                                    <% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.approve || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %>
                                </select>
                            </div>
                            <div class="bg-dark-800 p-5 rounded-2xl border border-dark-600 shadow-sm">
                                <label class="block text-sm font-bold text-white mb-2">ุฃูุฑ Done</label>
                                <input type="text" name="cmd_doneCmd" value="<%= config.commands?.doneCmd || 'done' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl p-3 text-white font-mono text-sm mb-3 input-glow">
                                <label class="block text-xs font-bold text-slate-400 mb-2" data-en="Roles:">ุงูุฑุชุจ:</label>
                                <select name="role_doneAllowed" multiple class="w-full h-20 bg-dark-900 border border-dark-700 rounded-xl p-2 text-xs text-white custom-scrollbar">
                                    <% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.done || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-logs" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Detailed Server Logs ๐">ุณุฌูุงุช ุงูุณูุฑูุฑ ุงูุฏูููุฉ ๐</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-teal-500">
                        <h3 class="text-2xl font-bold text-red-400 mb-6 flex items-center" data-en="๐ Security & Reactions Logs">๐ ุงูููุฌุงุช ุงูุฃูููุฉ (ุงูุฑูุฃูุชุงุชุ ุงูุซุฑูุฏุงุชุ ุงูุฑุชุจ)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-red-500/30 shadow-sm">
                                <label class="block text-xs font-bold text-red-400 mb-2">ููุฌ ุงูุชูุงุนูุงุช (ุงูุฑูุฃูุชุงุช)</label>
                                <select name="log_reactionLogId" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-2.5 text-white text-xs mb-3 cursor-pointer">
                                    <option value="">-- ูุนุทู --</option>
                                    <% textChannels.forEach(ch => { %><option value="<%= ch.id %>" <%= config.serverLogs?.reactionLogId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option><% }) %>
                                </select>
                                <input type="color" name="log_reactionColor" value="<%= config.serverLogs?.reactionColor || '#e74c3c' %>" class="w-full h-8 rounded-lg cursor-pointer bg-dark-800 border border-dark-600 p-1">
                            </div>
                            
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-amber-500/30 shadow-sm">
                                <label class="block text-xs font-bold text-amber-400 mb-2">ููุฌ ุงูุฑููุงุช (ุฅูุดุงุก/ุญุฐู)</label>
                                <select name="log_channelCreateDeleteLogId" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-2.5 text-white text-xs mb-3 cursor-pointer">
                                    <option value="">-- ูุนุทู --</option>
                                    <% textChannels.forEach(ch => { %><option value="<%= ch.id %>" <%= config.serverLogs?.channelCreateDeleteLogId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option><% }) %>
                                </select>
                                <input type="color" name="log_channelColor" value="<%= config.serverLogs?.channelColor || '#1abc9c' %>" class="w-full h-8 rounded-lg cursor-pointer bg-dark-800 border border-dark-600 p-1">
                            </div>
                            
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-brand/30 shadow-sm">
                                <label class="block text-[11px] font-bold text-brand-light mb-2">ููุฌ ุงูุซุฑูุฏุงุช (ุฅูุดุงุก/ุญุฐู)</label>
                                <select name="log_threadCreateDeleteLogId" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-2.5 text-white text-xs mb-3 cursor-pointer">
                                    <option value="">-- ูุนุทู --</option>
                                    <% textChannels.forEach(ch => { %><option value="<%= ch.id %>" <%= config.serverLogs?.threadCreateDeleteLogId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option><% }) %>
                                </select>
                                <input type="color" name="log_threadColor" value="<%= config.serverLogs?.threadColor || '#34495e' %>" class="w-full h-8 rounded-lg cursor-pointer bg-dark-800 border border-dark-600 p-1">
                            </div>

                            <div class="bg-dark-900/50 p-4 rounded-xl border border-fuchsia-500/30 shadow-sm">
                                <label class="block text-[11px] font-bold text-fuchsia-400 mb-2">ููุฌ ุงูุฑุชุจ (ุฅูุดุงุก/ุญุฐู)</label>
                                <select name="log_roleCreateDeleteLogId" class="w-full bg-dark-800 border border-dark-600 rounded-lg p-2.5 text-white text-xs mb-3 cursor-pointer">
                                    <option value="">-- ูุนุทู --</option>
                                    <% textChannels.forEach(ch => { %><option value="<%= ch.id %>" <%= config.serverLogs?.roleCreateDeleteLogId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option><% }) %>
                                </select>
                                <input type="color" name="log_roleCreateColor" value="<%= config.serverLogs?.roleCreateColor || '#e024ce' %>" class="w-full h-8 rounded-lg cursor-pointer bg-dark-800 border border-dark-600 p-1">
                            </div>

                        </div>

                        <hr class="border-dark-700 my-8">
                        
                        <h3 class="text-2xl font-bold text-blue-400 mb-6 flex items-center" data-en="๐ก๏ธ Punishments Logs">๐ก๏ธ ููุฌุงุช ุงูุนููุจุงุช (ุฅุนุทุงุก ููู)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-dark-800 p-5 rounded-2xl border border-dark-600 shadow-md">
                                <label class="block text-sm font-bold text-red-500 mb-2">ููุฌ ุงูุจุงูุฏ ูุงูุทุฑุฏ</label>
                                <select name="log_banKickLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-3 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.banKickLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_banColor" value="<%= config.serverLogs?.banColor || '#992d22' %>" class="w-full h-10 rounded-lg mb-4 cursor-pointer" title="ููู ุงูุจุงูุฏ">
                                
                                <label class="block text-sm font-bold text-emerald-500 mb-2 pt-4 border-t border-dark-700">ููุฌ ูู ุงูุจุงูุฏ (Unban)</label>
                                <select name="log_unbanLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-3 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.unbanLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_unbanColor" value="<%= config.serverLogs?.unbanColor || '#2ecc71' %>" class="w-full h-10 rounded-lg cursor-pointer" title="ููู ูู ุงูุจุงูุฏ">
                            </div>

                            <div class="bg-dark-800 p-5 rounded-2xl border border-dark-600 shadow-md">
                                <label class="block text-sm font-bold text-orange-500 mb-2">ููุฌ ุงูุชุงูู ุฃูุช (Timeout)</label>
                                <select name="log_timeoutLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-3 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.timeoutLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_timeoutColor" value="<%= config.serverLogs?.timeoutColor || '#e67e22' %>" class="w-full h-10 rounded-lg mb-4 cursor-pointer" title="ููู ุงูุชุงูู">
                                
                                <label class="block text-sm font-bold text-emerald-500 mb-2 pt-4 border-t border-dark-700">ููุฌ ูู ุงูุชุงูู (Untimeout)</label>
                                <select name="log_untimeoutLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-3 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.untimeoutLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_untimeoutColor" value="<%= config.serverLogs?.untimeoutColor || '#2ecc71' %>" class="w-full h-10 rounded-lg cursor-pointer" title="ููู ูู ุงูุชุงูู">
                            </div>

                            <div class="bg-dark-800 p-5 rounded-2xl border border-dark-600 shadow-md">
                                <label class="block text-sm font-bold text-yellow-400 mb-2">ููุฌ ุงูุชุญุฐูุฑุงุช (Warn)</label>
                                <select name="log_warningsLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-3 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.warningsLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_warnColor" value="<%= config.serverLogs?.warnColor || '#f1c40f' %>" class="w-full h-10 rounded-lg mb-4 cursor-pointer" title="ููู ุงูุชุญุฐูุฑ">
                                
                                <label class="block text-sm font-bold text-emerald-500 mb-2 pt-4 border-t border-dark-700">ููุฌ ูู ุงูุชุญุฐูุฑ (Unwarn)</label>
                                <select name="log_unwarningsLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-3 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.unwarningsLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_unwarnColor" value="<%= config.serverLogs?.unwarnColor || '#2ecc71' %>" class="w-full h-10 rounded-lg cursor-pointer" title="ููู ูู ุงูุชุญุฐูุฑ">
                            </div>
                        </div>

                        <hr class="border-dark-700 my-8">
                        <h3 class="text-2xl font-bold text-slate-300 mb-6" data-en="๐ฌ General Action Logs">๐ฌ ููุฌุงุช ุงูุญุฑูุฉ ุงูุนุงูุฉ</h3>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-5">
                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600 shadow-sm">
                                <label class="text-[12px] font-bold text-slate-400 block mb-2">ุญุฐู ุงูุฑุณุงุฆู</label>
                                <select name="log_messageDeleteLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-2.5 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.messageDeleteLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_msgDelColor" value="<%= config.serverLogs?.msgDelColor || '#ed4245' %>" class="w-full h-8 rounded-lg cursor-pointer">
                            </div>
                            
                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600 shadow-sm">
                                <label class="text-[12px] font-bold text-slate-400 block mb-2">ุชุนุฏูู ุงูุฑุณุงุฆู</label>
                                <select name="log_messageEditLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-2.5 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.messageEditLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_msgEditColor" value="<%= config.serverLogs?.msgEditColor || '#fee75c' %>" class="w-full h-8 rounded-lg cursor-pointer">
                            </div>
                            
                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600 shadow-sm">
                                <label class="text-[12px] font-bold text-amber-500 block mb-2">ุญุฐู ุตูุฑ ููุท</label>
                                <select name="log_imageDeleteLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-2.5 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.imageDeleteLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_imgDelColor" value="<%= config.serverLogs?.imgDelColor || '#e67e22' %>" class="w-full h-8 rounded-lg cursor-pointer">
                            </div>
                            
                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600 shadow-sm">
                                <label class="text-[12px] font-bold text-slate-400 block mb-2">ุฅุนุทุงุก/ุณุญุจ ุฑุชุจ (ุงูุฃุนุถุงุก)</label>
                                <select name="log_roleGiveTakeLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-2.5 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.roleGiveTakeLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_roleColor" value="<%= config.serverLogs?.roleColor || '#9b59b6' %>" class="w-full h-8 rounded-lg cursor-pointer">
                            </div>
                            
                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600 shadow-sm">
                                <label class="text-[12px] font-bold text-slate-400 block mb-2">ุฏุฎูู/ุฎุฑูุฌ ุฃุนุถุงุก</label>
                                <select name="log_memberJoinLeaveLogId" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-2.5 mb-3 cursor-pointer"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.memberJoinLeaveLogId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                                <div class="flex space-x-2 space-x-reverse">
                                    <input type="color" name="log_joinColor" value="<%= config.serverLogs?.joinColor || '#3ba55d' %>" class="w-1/2 h-8 rounded-lg cursor-pointer" title="ููู ุงูุฏุฎูู">
                                    <input type="color" name="log_leaveColor" value="<%= config.serverLogs?.leaveColor || '#ed4245' %>" class="w-1/2 h-8 rounded-lg cursor-pointer" title="ููู ุงูุฎุฑูุฌ">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-roles" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Staff Roles & Permissions ๐">ุงูุฑุชุจ ูุงูุตูุงุญูุงุช ๐</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-purple-500">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Main Admin Role">ุฑุชุจุฉ ุงูุฏุนู ุงูููู ุงูุฃุณุงุณูุฉ</label>
                                <select name="role_adminRoleId" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white font-bold cursor-pointer input-glow">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑุชุจุฉ --</option>
                                    <% serverRoles.forEach(role => { %> 
                                        <option value="<%= role.id %>" <%= config.roles?.adminRoleId === role.id ? 'selected' : '' %>>๐ก๏ธ <%= role.name %></option> 
                                    <% }) %>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Main Middleman Role">ุฑุชุจุฉ ุงููุณูุท ุงูุฃุณุงุณูุฉ</label>
                                <select name="role_middlemanRoleId" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white font-bold cursor-pointer input-glow">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑุชุจุฉ --</option>
                                    <% serverRoles.forEach(role => { %> 
                                        <option value="<%= role.id %>" <%= config.roles?.middlemanRoleId === role.id ? 'selected' : '' %>>โ๏ธ <%= role.name %></option> 
                                    <% }) %>
                                </select>
                            </div>
                        </div>

                        <hr class="border-dark-700 my-8">
                        <h3 class="text-xl font-bold text-white mb-6" data-en="๐ High Staff & Trade Roles (Multi-Select)">๐ ุฑุชุจ ุงูุฅุฏุงุฑุฉ ุงูุนููุง ูุงูุชุฑูุฏ (ุชุญุฏูุฏ ูุชุนุฏุฏ)</h3>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 shadow-md">
                                <label class="block text-sm font-bold text-amber-400 mb-3" data-en="High Staff Roles">ุงูุฅุฏุงุฑุฉ ุงูุนููุง (High Staff)</label>
                                <select name="role_highAdminRoles" multiple class="w-full h-40 bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white custom-scrollbar focus:border-brand outline-none">
                                    <% serverRoles.forEach(role => { %> 
                                        <option value="<%= role.id %>" <%= (config.roles?.highAdminRoles || []).includes(role.id) ? 'selected' : '' %>><%= role.name %></option> 
                                    <% }) %>
                                </select>
                            </div>
                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 shadow-md">
                                <label class="block text-sm font-bold text-blue-400 mb-3" data-en="Trade Ping Roles">ุฑุชุจ ููุดู ุงูุชุฑูุฏ</label>
                                <select name="role_tradePingRoleIds" multiple class="w-full h-40 bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white custom-scrollbar focus:border-brand outline-none">
                                    <% serverRoles.forEach(role => { %> 
                                        <option value="<%= role.id %>" <%= (config.roles?.tradePingRoleIds || []).includes(role.id) ? 'selected' : '' %>><%= role.name %></option> 
                                    <% }) %>
                                </select>
                            </div>
                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 shadow-md">
                                <label class="block text-sm font-bold text-emerald-400 mb-3" data-en="Trade Approve Roles">ุฑุชุจ ุงูููุงููุฉ ุนูู ุงูุชุฑูุฏ</label>
                                <select name="role_tradeApproveRoleIds" multiple class="w-full h-40 bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white custom-scrollbar focus:border-brand outline-none">
                                    <% serverRoles.forEach(role => { %> 
                                        <option value="<%= role.id %>" <%= (config.roles?.tradeApproveRoleIds || []).includes(role.id) ? 'selected' : '' %>><%= role.name %></option> 
                                    <% }) %>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-ratings" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Dual Rating System โญ">ุงูุชููููุงุช ุงููุฒุฏูุฌุฉ โญ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-yellow-500">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            
                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 shadow-lg">
                                <h3 class="text-xl font-bold text-brand-light mb-6 flex items-center" data-en="๐ก๏ธ Staff Rating Log">๐ก๏ธ ุชููููุงุช ุงูุฏุนู ุงูููู</h3>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฑูู ุงูููุฌ (Staff Rating)</label>
                                <select name="rating_staffLogChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3.5 px-4 text-white font-bold mb-6 cursor-pointer input-glow">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %> 
                                        <option value="<%= ch.id %>" <%= config.ratings?.staffLogChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> 
                                    <% }) %>
                                </select>
                                
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Embed Color">ููู ุฅููุจุฏ ุงูุชูููู</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="rating_staff_color_picker" value="<%= config.ratings?.staffEmbedColor || '#3ba55d' %>" class="w-14 h-12 rounded-xl cursor-pointer bg-dark-800 border border-dark-600 p-1" onchange="document.getElementById('rating_staffEmbedColor').value = this.value">
                                    <input type="text" id="rating_staffEmbedColor" name="rating_staffEmbedColor" value="<%= config.ratings?.staffEmbedColor || '#3ba55d' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white font-mono uppercase text-center input-glow" oninput="document.getElementById('rating_staff_color_picker').value = this.value">
                                </div>
                            </div>

                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 shadow-lg">
                                <h3 class="text-xl font-bold text-amber-500 mb-6 flex items-center" data-en="โ๏ธ Middleman Rating Log">โ๏ธ ุชููููุงุช ุงููุณุทุงุก</h3>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฑูู ุงูููุฌ (Middleman Rating)</label>
                                <select name="rating_middlemanLogChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3.5 px-4 text-white font-bold mb-6 cursor-pointer input-glow">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %> 
                                        <option value="<%= ch.id %>" <%= config.ratings?.middlemanLogChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> 
                                    <% }) %>
                                </select>
                                
                                <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Embed Color">ููู ุฅููุจุฏ ุงูุชูููู</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="rating_mm_color_picker" value="<%= config.ratings?.middlemanEmbedColor || '#f2a658' %>" class="w-14 h-12 rounded-xl cursor-pointer bg-dark-800 border border-dark-600 p-1" onchange="document.getElementById('rating_middlemanEmbedColor').value = this.value">
                                    <input type="text" id="rating_middlemanEmbedColor" name="rating_middlemanEmbedColor" value="<%= config.ratings?.middlemanEmbedColor || '#f2a658' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white font-mono uppercase text-center input-glow" oninput="document.getElementById('rating_mm_color_picker').value = this.value">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

<div id="section-protection" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Protection & Anti-Nuke ๐ก๏ธ">ุงูุญูุงูุฉ ูุงูู Anti-Nuke ๐ก๏ธ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-red-600">
                        <div class="flex justify-between items-center bg-dark-900/50 p-6 rounded-2xl border border-dark-700 mb-4 shadow-sm">
                            <div>
                                <h3 class="text-lg font-bold text-white mb-1" data-en="Anti-Link System">ููุน ูุดุฑ ุงูุฑูุงุจุท (Anti-Link)</h3>
                                <p class="text-xs text-slate-400" data-en="Prevents normal members from sending links.">ูููุน ุงูุฃุนุถุงุก ุงูุนุงุฏููู ูู ุฅุฑุณุงู ุฑูุงุจุท ูู ุงูุณูุฑูุฑ.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="prot_antiLinkEnabled" <%= config.protection?.antiLinkEnabled ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="flex justify-between items-center bg-dark-900/50 p-6 rounded-2xl border border-dark-700 mb-4 shadow-sm">
                            <div>
                                <h3 class="text-lg font-bold text-white mb-1" data-en="Anti-Spam System">ููุน ุงูุชูุฑุงุฑ ูุงูุณุจุงู (Anti-Spam)</h3>
                                <p class="text-xs text-slate-400" data-en="Prevents members from spamming messages.">ูููุน ุงูุฃุนุถุงุก ูู ุฅุฑุณุงู ุฑุณุงุฆู ูุชูุฑุฑุฉ ุจุณุฑุนุฉ.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="prot_antiSpamEnabled" <%= config.protection?.antiSpamEnabled ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="flex justify-between items-center bg-red-900/20 p-6 rounded-2xl border border-red-500/30 shadow-md">
                            <div>
                                <h3 class="text-xl font-bold text-red-400 mb-1" data-en="Maximum Protection (Anti-Nuke)">ูุธุงู ุงูุญูุงูุฉ ุงููุตูู (Anti-Nuke)</h3>
                                <p class="text-xs text-red-300/70" data-en="Protects the server from mass channel/role deletion.">ูุญูู ุงูุณูุฑูุฑ ูู ุงููุณุญ ุงูุนุดูุงุฆู ููุฑููุงุช ุฃู ุงูุฑุชุจ ุฃู ุงูุฃุนุถุงุก.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="prot_antiNukeEnabled" <%= config.protection?.antiNukeEnabled ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div id="section-welcome" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Welcome & Leave System ๐">ุงูุชุฑุญูุจ ูุงููุบุงุฏุฑุฉ ๐</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-pink-500">
                        
                        <div class="bg-dark-900/40 p-6 rounded-3xl border border-pink-500/30 mb-8 shadow-lg">
                            <div class="flex justify-between items-center mb-6 border-b border-dark-700 pb-4">
                                <div>
                                    <span class="font-black text-2xl text-pink-400 block mb-1" data-en="Enable Welcome System">ุชูุนูู ูุธุงู ุงูุชุฑุญูุจ (Welcome)</span>
                                    <span class="text-sm text-slate-400" data-en="Sends a customized image and message when a member joins.">ูุฑุณู ุฑุณุงูุฉ ูุตูุฑุฉ ูุฎุตุตุฉ ุนูุฏ ุฏุฎูู ุฃู ุนุถู ุฌุฏูุฏ.</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" name="wel_welcomeEnabled" <%= config.welcomeSystem?.welcomeEnabled !== false ? 'checked' : '' %>>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-6">
                                <div>
                                    <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Welcome Channel">ุฑูู ุฅุฑุณุงู ุงูุชุฑุญูุจ</label>
                                    <select name="wel_welcomeChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-4 px-4 text-white font-bold cursor-pointer input-glow">
                                        <option value="" data-en="-- Select Channel --">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                        <% textChannels.forEach(ch => { %>
                                            <option value="<%= ch.id %>" <%= config.welcomeSystem?.welcomeChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option>
                                        <% }) %>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-slate-300 mb-2" data-en="Background URL">ุฑุงุจุท ุตูุฑุฉ ุงูุฎูููุฉ (Background URL)</label>
                                    <input type="text" name="wel_backgroundUrl" value="<%= config.welcomeSystem?.backgroundUrl || '' %>" placeholder="https://..." dir="ltr" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-4 px-4 text-white text-left font-mono input-glow">
                                </div>
                            </div>

                            <div class="bg-dark-800 p-6 rounded-2xl border border-dark-600 mb-6 shadow-inner">
                                <label class="block text-lg font-bold text-brand-light mb-3" data-en="๐ Custom Welcome Message">๐ ูุต ุฑุณุงูุฉ ุงูุชุฑุญูุจ ุงููุฎุตุตุฉ</label>
                                <p class="text-sm text-slate-400 mb-4 leading-relaxed">
                                    ุงููุชุบูุฑุงุช ุงููุชุงุญุฉ ููุงุณุชุฎุฏุงู:<br>
                                    <code class="text-amber-400 bg-dark-900 px-2 py-1 rounded inline-block mt-2 mr-1">{user}</code> ูููุดู ุงูุนุถู.<br>
                                    <code class="text-amber-400 bg-dark-900 px-2 py-1 rounded inline-block mt-2 mr-1">{server}</code> ูุงุณู ุงูุณูุฑูุฑ.<br>
                                    <code class="text-amber-400 bg-dark-900 px-2 py-1 rounded inline-block mt-2 mr-1">{memberCount}</code> ูุฑูู ุงูุนุถู.
                                </p>
                                <textarea name="wel_welcomeMessage" rows="4" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-5 text-white font-bold resize-y text-lg input-glow" placeholder="ูุฑุญุจุงู ุจู {user} ูู ุณูุฑูุฑ {server}. ุฃูุช ุงูุนุถู ุฑูู {memberCount} !"><%= config.welcomeSystem?.welcomeMessage || 'ูุฑุญุจุงู ุจู {user} ูู ุณูุฑูุฑ {server}. ุฃูุช ุงูุนุถู ุฑูู {memberCount} !' %></textarea>
                            </div>

                            <div class="flex items-center justify-between bg-dark-800 p-5 rounded-2xl border border-dark-600">
                                <div class="w-1/2 pr-4 border-l border-dark-700">
                                    <label class="text-xs font-bold text-slate-400 block mb-2" data-en="Avatar Border Color">ููู ุฅุทุงุฑ ุงูุตูุฑุฉ (Avatar Border):</label>
                                    <input type="color" name="wel_avatarBorderHex" value="<%= config.welcomeSystem?.avatarBorderHex || '#ffffff' %>" class="w-16 h-10 rounded-xl bg-dark-900 p-1 cursor-pointer border border-dark-600">
                                </div>
                                <div class="w-1/2 pl-4">
                                    <label class="text-xs font-bold text-slate-400 block mb-2" data-en="Text Color">ููู ุงููุต ุฏุงุฎู ุงูุตูุฑุฉ:</label>
                                    <input type="color" name="wel_textColorHex" value="<%= config.welcomeSystem?.textColorHex || '#ffffff' %>" class="w-16 h-10 rounded-xl bg-dark-900 p-1 cursor-pointer border border-dark-600">
                                </div>
                            </div>
                        </div>

                        <div class="bg-dark-900/40 p-6 rounded-3xl border border-slate-600/30 shadow-md">
                            <div class="flex justify-between items-center mb-6 border-b border-dark-700 pb-4">
                                <div>
                                    <span class="font-bold text-xl text-slate-300 block mb-1" data-en="Enable Leave System">ุชูุนูู ุฑุณุงุฆู ุงููุบุงุฏุฑุฉ (Leave)</span>
                                    <span class="text-xs text-slate-500" data-en="Sends a message when a member leaves.">ูุฑุณู ุฑุณุงูุฉ ูุตูุฉ ุนูุฏ ุฎุฑูุฌ ุนุถู ูู ุงูุณูุฑูุฑ.</span>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" name="wel_leaveEnabled" <%= config.welcomeSystem?.leaveEnabled ? 'checked' : '' %>>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-4">
                                <div>
                                    <label class="block text-sm font-bold text-slate-400 mb-2" data-en="Leave Channel">ุฑูู ุงููุบุงุฏุฑุฉ</label>
                                    <select name="wel_leaveChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white font-bold cursor-pointer input-glow">
                                        <option value="" data-en="-- Select Channel --">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                        <% textChannels.forEach(ch => { %>
                                            <option value="<%= ch.id %>" <%= config.welcomeSystem?.leaveChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option>
                                        <% }) %>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-slate-400 mb-2" data-en="Leave Message">ุฑุณุงูุฉ ุงููุบุงุฏุฑุฉ (ูุฏุนู {user})</label>
                                    <textarea name="wel_leaveMessage" rows="2" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white font-bold resize-y input-glow" placeholder="ููุฏ ุบุงุฏุฑ {user} ุงูุณูุฑูุฑ ๐ข"><%= config.welcomeSystem?.leaveMessage || 'ููุฏ ุบุงุฏุฑ {user} ุงูุณูุฑูุฑ ๐ข' %></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-economy" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Economy & Tax ๐ฐ">ุงูุงูุชุตุงุฏ ูุงูุถุฑูุจุฉ ๐ฐ</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-green-500">
                        <div class="flex justify-between items-center bg-dark-900/50 p-6 rounded-2xl border border-dark-700 mb-8">
                            <div>
                                <span class="font-bold text-xl text-emerald-400 block mb-1" data-en="Enable Economy & Tax Commands">ุชูุนูู ุงูุงูุชุตุงุฏ ูุงูุถุฑูุจุฉ</span>
                                <span class="text-sm text-slate-400" data-en="Enables the ProBot Tax calculation commands.">ููุนู ุฃูุงูุฑ ุญุณุงุจ ุงูุถุฑูุจุฉ (Tax).</span>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="eco_enabled" <%= config.economy?.enabled !== false ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 w-full md:w-1/2">
                            <label class="block text-sm font-bold text-slate-300 mb-3" data-en="ProBot Tax Percentage (%)">ูุณุจุฉ ุถุฑูุจุฉ ุงูุชุญููู (ุงูุจุฑู ุจูุช) ุงููุฆููุฉ %</label>
                            <input type="number" name="eco_taxPercentage" value="<%= config.economy?.taxPercentage || 5 %>" class="w-full bg-dark-800 border border-dark-600 rounded-xl p-4 text-white font-bold text-center text-2xl input-glow">
                            <p class="text-[11px] text-slate-500 mt-3 text-center" data-en="Example: 5 means the bot calculates 5% tax.">ูุซุงู: ูู 5ุ ุงูุจูุช ููุญุณุจ ุถุฑูุจุฉ ุงูุจุฑูุจูุช 5% ุชููุงุฆูุงู.</p>
                        </div>
                    </div>
                </div>
                
                <div id="section-leveling" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-4xl font-black text-white mb-6 border-b border-dark-700 pb-4" data-en="Leveling System ๐">ูุธุงู ุงููููุงุช (Leveling) ๐</h2>
                    
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-blue-400">
                        <div class="flex items-center justify-between bg-dark-900/50 p-6 rounded-2xl border border-dark-700 mb-8">
                            <div>
                                <h3 class="text-xl font-bold text-white mb-1" data-en="Enable Leveling System">ุชูุนูู ูุธุงู ุงูุชูููู</h3>
                                <p class="text-sm text-slate-400" data-en="Members gain XP by sending messages.">ููุชุณุจ ุงูุฃุนุถุงุก ุฎุจุฑุฉ (XP) ุนุดูุงุฆูุฉ ุนูุฏ ุงูุชุญุฏุซ ูู ุงูุณูุฑูุฑ.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="lvl_enabled" id="lvl_enabled" <%= config.leveling?.enabled !== false ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3" data-en="Level Up Channel">ุฑูู ุฅุฑุณุงู ุฑุณุงุฆู ุงูุชูููู</label>
                                <select name="lvl_levelUpChannelId" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-4 text-white font-bold cursor-pointer input-glow">
                                    <option value="" data-en="-- Same Channel as Message --">-- ููุณ ุงูุฑูู ุงูุชู ูุชุญุฏุซ ุจูุง ุงูุนุถู --</option>
                                    <% textChannels.forEach(ch => { %>
                                        <option value="<%= ch.id %>" <%= config.leveling?.levelUpChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option>
                                    <% }) %>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3" data-en="Level Up Message ({user}, {level})">ุฑุณุงูุฉ ุงูุชูููู (ูุฏุนู {user} ู {level})</label>
                                <textarea name="lvl_levelUpMessage" rows="2" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-4 text-white resize-y font-bold input-glow" placeholder="ูุจุฑูู {user} ูุตูุช ูููู {level}!"><%= config.leveling?.levelUpMessage || '๐ ูุจุฑูู {user}ุ ููุฏ ูุตูุช ุฅูู ุงููุณุชูู **{level}**!' %></textarea>
                            </div>
                        </div>

                        <div class="bg-dark-900/80 p-8 rounded-3xl border border-blue-500/30 shadow-inner">
                            <div class="flex flex-col md:flex-row justify-between items-center mb-6 border-b border-dark-700 pb-4 gap-4">
                                <div>
                                    <h3 class="text-2xl font-bold text-brand-light" data-en="๐๏ธ Role Rewards">๐๏ธ ุฌูุงุฆุฒ ุงูุฑุชุจ ูููุณุชููุงุช (Role Rewards)</h3>
                                    <p class="text-sm text-slate-400 mt-2" data-en="Member gets the role automatically at the specified level.">ุณูุญุตู ุงูุนุถู ุนูู ุงูุฑุชุจุฉ ุงููุญุฏุฏุฉ ุชููุงุฆูุงู ุนูุฏ ูุตููู ูููุณุชูู ุงููุทููุจ.</p>
                                </div>
                                <button type="button" onclick="addLevelRewardUI()" class="px-6 py-4 bg-blue-600 hover:bg-blue-500 text-white font-black text-sm rounded-xl transition-all shadow-lg whitespace-nowrap" data-en="โ Add Role Reward">
                                    โ ุฅุถุงูุฉ ุฌุงุฆุฒุฉ ุฑุชุจุฉ
                                </button>
                            </div>
                            
                            <input type="hidden" name="lvl_roleRewardsData" id="lvl_roleRewardsData" value="<%= JSON.stringify(config.leveling?.roleRewards || []) %>">
                            <div id="level-rewards-container" class="space-y-4">
                                </div>
                        </div>
                    </div>
                </div>

            </form>
        </div>
    </main>

    <script>
        // -----------------------------------------------------------
        // 1. ูุธุงู ุงูุชููู ุงูุณูุณ ุจูู ุงูุฃูุณุงู
        // -----------------------------------------------------------
        function switchSection(target) {
            document.querySelectorAll('.settings-section').forEach(s => s.classList.remove('active'));
            document.getElementById('section-' + target).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(b => { 
                b.classList.remove('bg-brand','text-white'); 
                b.classList.add('text-slate-400'); 
            });
            
            const activeBtn = document.querySelector(`[data-target="${target}"]`);
            if(activeBtn) { 
                activeBtn.classList.add('bg-brand','text-white'); 
                activeBtn.classList.remove('text-slate-400'); 
            }
        }

        // -----------------------------------------------------------
        // 2. ุฐูุงุก ุฒุฑุงูุฑ ุงูุชูุช (ููุน ุชุนุงุฑุถ ุงูุฅุฎูุงุก ูุน ุงููุฑุงุกุฉ ููุท)
        // -----------------------------------------------------------
        const hideBtn = document.getElementById('tc_hideTicketOnClaim');
        const readBtn = document.getElementById('tc_readOnlyStaffOnClaim');
        
        if (hideBtn && readBtn) {
            function syncTicketToggles() {
                if (hideBtn.checked) { 
                    readBtn.checked = false; 
                    document.getElementById('read_claim_container').style.opacity = '0.4'; 
                    readBtn.disabled = true; 
                } else { 
                    document.getElementById('read_claim_container').style.opacity = '1'; 
                    readBtn.disabled = false; 
                }
                
                if (readBtn.checked) { 
                    hideBtn.checked = false; 
                    document.getElementById('hide_claim_container').style.opacity = '0.4'; 
                    hideBtn.disabled = true; 
                } else if (!readBtn.checked && !hideBtn.checked) { 
                    document.getElementById('hide_claim_container').style.opacity = '1'; 
                    hideBtn.disabled = false; 
                }
            }
            hideBtn.addEventListener('change', syncTicketToggles);
            readBtn.addEventListener('change', syncTicketToggles);
            syncTicketToggles(); 
        }

        // -----------------------------------------------------------
        // 3. ุตุงูุน ุงูุฅููุจุฏ ุงูููุฑู (Live Embed)
        // -----------------------------------------------------------
        async function sendLiveEmbed(guildId) {
            const channelId = document.getElementById('live_embed_channel').value;
            const title = document.getElementById('live_embed_title').value;
            const description = document.getElementById('live_embed_desc').value;
            const color = document.getElementById('live_embed_color').value;
            const imageUrl = document.getElementById('live_embed_image').value;
            const statusDiv = document.getElementById('live_embed_status');
            
            if(!channelId || (!title && !description)) { 
                statusDiv.className = 'mb-6 p-4 rounded-xl bg-red-500/20 text-red-400 border border-red-500'; 
                statusDiv.innerText = 'โ ูุฑุฌู ุงุฎุชูุงุฑ ุงูุฑูู ููุชุงุจุฉ ูุญุชูู ุงูุฅููุจุฏ.'; 
                statusDiv.classList.remove('hidden'); 
                return; 
            }
            
            statusDiv.className = 'mb-6 p-4 rounded-xl bg-blue-500/20 text-blue-400 border border-blue-500'; 
            statusDiv.innerText = 'โณ ุฌุงุฑู ุงูุฅุฑุณุงู ููุฏูุณููุฑุฏ...'; 
            statusDiv.classList.remove('hidden');
            
            try {
                const res = await fetch(`/api/send-embed/${guildId}`, { 
                    method: 'POST', 
                    headers: { 'Content-Type': 'application/json' }, 
                    body: JSON.stringify({ channelId, title, description, color, imageUrl }) 
                });
                const data = await res.json();
                
                if(data.success) { 
                    statusDiv.className = 'mb-6 p-4 rounded-xl bg-emerald-500/20 text-emerald-400 border border-emerald-500'; 
                    statusDiv.innerText = 'โ ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญ!'; 
                    document.getElementById('live_embed_title').value = ''; 
                    document.getElementById('live_embed_desc').value = ''; 
                    document.getElementById('live_embed_image').value = ''; 
                } else { 
                    statusDiv.className = 'mb-6 p-4 rounded-xl bg-red-500/20 text-red-400 border border-red-500'; 
                    statusDiv.innerText = data.error || 'โ ูุดู ุงูุฅุฑุณุงู.'; 
                }
            } catch(e) { 
                statusDiv.className = 'mb-6 p-4 rounded-xl bg-red-500/20 text-red-400 border border-red-500'; 
                statusDiv.innerText = 'โ ุญุฏุซ ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุจูุช.'; 
            }
        }

        // ==========================================================
        // ๐งฑ ุงููุญุฑูุงุช ุงูุฏููุงููููุฉ ููุจูุงูุงุช ุงููุนูุฏุฉ (ุงููุตูููุงุช)
        // ==========================================================
        let panelsArray = JSON.parse(document.getElementById('ticketPanelsData').value || '[]');
        let mmFields = JSON.parse(document.getElementById('mm_modalFieldsData').value || '[]');
        let roleRewards = JSON.parse(document.getElementById('lvl_roleRewardsData').value || '[]');
        
        // ๐จ ุชุนุฏูู ูุธุงู ุงูุชุญุฐูุฑุงุช ููุตุจุญ Object ูุญุชูู ุนูู (ุงูุณุจุจ + ุฑุณุงูุฉ ุงูุฎุงุต) ๐จ
        let warnDataAr = JSON.parse(document.getElementById('warn_reasonsDataAr')?.value || '[{"reason": "ุณุจ ูุดุชู", "dmMessage": "ููุฏ ุชู ุชุญุฐูุฑู ุจุณุจุจ ุงูุณุจ ูุงูุดุชู. ูุฑุฌู ุงุญุชุฑุงู ุงูููุงููู."}]');
        let warnDataEn = JSON.parse(document.getElementById('warn_reasonsDataEn')?.value || '[{"reason": "Swearing", "dmMessage": "You have been warned for swearing."}]');

        // -----------------------------------------------------------
        // ูุญุฑู ุงูุชุญุฐูุฑุงุช ุงูุฌุฏูุฏ (ุณุจุจ + ุฑุณุงูุฉ ุฎุงุตุฉ DM)
        // -----------------------------------------------------------
        function renderWarns(lang) {
            const arr = lang === 'ar' ? warnDataAr : warnDataEn;
            const container = document.getElementById(`warn-${lang}-container`);
            container.innerHTML = '';
            
            arr.forEach((item, index) => {
                container.innerHTML += `
                    <div class="bg-dark-800 p-4 rounded-xl border border-dark-600 mb-3 transition-all shadow-md relative">
                        <button type="button" onclick="${lang === 'ar' ? 'warnDataAr' : 'warnDataEn'}.splice(${index}, 1); renderWarns('${lang}');" class="absolute top-3 left-3 text-red-500 bg-red-500/10 hover:bg-red-500 hover:text-white px-3 py-1.5 rounded-lg text-xs font-bold transition-all">ุญุฐู ๐๏ธ</button>
                        
                        <label class="block text-xs font-bold text-slate-400 mb-1">ุงูุณุจุจ (Reason):</label>
                        <input type="text" class="w-full bg-dark-900 border border-dark-700 text-white text-sm rounded-lg p-3 font-bold mb-3 focus:border-brand outline-none ${lang === 'en' ? 'text-left' : ''}" dir="${lang === 'en' ? 'ltr' : 'rtl'}" value="${item.reason}" onchange="${lang === 'ar' ? 'warnDataAr' : 'warnDataEn'}[${index}].reason = this.value">
                        
                        <label class="block text-xs font-bold text-brand-light mb-1">ุฑุณุงูุฉ ุงูุฎุงุต ููุนุถู (DM Message):</label>
                        <textarea class="w-full bg-dark-900 border border-dark-700 text-white text-sm rounded-lg p-3 resize-y focus:border-brand outline-none ${lang === 'en' ? 'text-left' : ''}" dir="${lang === 'en' ? 'ltr' : 'rtl'}" rows="2" onchange="${lang === 'ar' ? 'warnDataAr' : 'warnDataEn'}[${index}].dmMessage = this.value">${item.dmMessage}</textarea>
                    </div>
                `;
            });
        }
        function addWarnReason(lang) { 
            if(lang === 'ar') warnDataAr.push({reason: 'ุณุจุจ ุฌุฏูุฏ', dmMessage: 'ููุฏ ุชู ุชุญุฐูุฑู ุจุณุจุจ...'}); 
            else warnDataEn.push({reason: 'New Reason', dmMessage: 'You have been warned for...'}); 
            renderWarns(lang); 
        }

        // -----------------------------------------------------------
        // ูุญุฑู ุฃุณุฆูุฉ ูุงูุฐุฉ ุงููุณุงุทุฉ (Middleman Modal)
        // -----------------------------------------------------------
        function renderMmFields() {
            const container = document.getElementById('mm-fields-ui-container'); 
            container.innerHTML = '';
            
            if(mmFields.length === 0) {
                container.innerHTML = '<div class="text-center text-slate-500 text-sm p-4 border-2 border-dashed border-dark-600 rounded-xl font-bold">ูุง ุชูุฌุฏ ุฃุณุฆูุฉ ูููุงูุฐุฉ ุญุงููุงู. ุงูุนููู ุณููุชุญ ุงูุชุฐูุฑุฉ ููุฑุงู.</div>';
                return;
            }

            mmFields.forEach((field, index) => {
                container.innerHTML += `
                    <div class="bg-dark-800 p-6 rounded-2xl border border-dark-600 mb-4 relative shadow-md">
                        <div class="absolute top-0 right-0 bg-dark-700 text-xs px-3 py-1 rounded-bl-lg text-slate-300 font-bold">ุงูุณุคุงู ุฑูู ${index + 1}</div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                            <div>
                                <label class="text-sm font-bold text-slate-400 mb-2 block">ูุต ุงูุณุคุงู</label>
                                <input type="text" class="w-full bg-dark-900 border border-dark-700 rounded-xl p-3 text-white text-sm font-bold focus:border-brand outline-none" value="${field.label || ''}" onchange="mmFields[${index}].label = this.value">
                            </div>
                            <div>
                                <label class="text-sm font-bold text-slate-400 mb-2 block">ูุซุงู ุฅุฑุดุงุฏู (Placeholder)</label>
                                <input type="text" class="w-full bg-dark-900 border border-dark-700 rounded-xl p-3 text-white text-sm focus:border-brand outline-none" placeholder="ูุซุงู ููุนููู..." value="${field.placeholder || ''}" onchange="mmFields[${index}].placeholder = this.value">
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center mt-5 pt-4 border-t border-dark-700">
                            <div class="flex space-x-6 space-x-reverse text-sm font-bold text-brand-light">
                                <label class="cursor-pointer flex items-center">
                                    <input type="radio" name="mm_style_${index}" value="Short" class="mr-2 ml-2 accent-brand w-5 h-5" ${field.style !== 'Paragraph' ? 'checked' : ''} onchange="mmFields[${index}].style = this.value"> ุฅุฌุงุจุฉ ูุตูุฑุฉ
                                </label>
                                <label class="cursor-pointer flex items-center">
                                    <input type="radio" name="mm_style_${index}" value="Paragraph" class="mr-2 ml-2 accent-brand w-5 h-5" ${field.style === 'Paragraph' ? 'checked' : ''} onchange="mmFields[${index}].style = this.value"> ุฅุฌุงุจุฉ ุทูููุฉ (ููุฑุฉ)
                                </label>
                            </div>
                            <button type="button" onclick="mmFields.splice(${index}, 1); renderMmFields();" class="text-sm bg-red-600 hover:bg-red-500 text-white px-5 py-2.5 rounded-xl font-bold transition-all shadow-md">ุญุฐู ุงูุณุคุงู ๐๏ธ</button>
                        </div>
                    </div>
                `;
            });
        }
        function addMmFieldUI() { mmFields.push({ label: 'ุณุคุงู ุฌุฏูุฏ', placeholder: 'ุงูุชุจ ุฅุฌุงุจุชู ููุง...', style: 'Short' }); renderMmFields(); }

        // -----------------------------------------------------------
        // ูุญุฑู ุฌูุงุฆุฒ ูุธุงู ุงูุชูููู (Leveling Rewards)
        // -----------------------------------------------------------
        const sRolesHTML = `<%- serverRoles.map(r => `<option value="${r.id}">${r.name}</option>`).join('') %>`;
        
        function renderLvlRewards() {
            const container = document.getElementById('level-rewards-container'); 
            container.innerHTML = '';
            
            if(roleRewards.length === 0){ 
                container.innerHTML = '<div class="text-center text-slate-500 text-base p-8 border-2 border-dashed border-dark-600 rounded-2xl font-bold">ูู ุชูู ุจุฅุถุงูุฉ ุฃู ุฌูุงุฆุฒ ุฑุชุจ ููู ูุณุชููุงุช ุญุชู ุงูุขู.</div>'; 
                return; 
            }
            
            roleRewards.forEach((reward, index) => {
                container.innerHTML += `
                    <div class="flex flex-col md:flex-row items-center space-x-0 md:space-x-6 md:space-x-reverse space-y-4 md:space-y-0 bg-dark-800 p-6 rounded-2xl border border-dark-600 mb-3 shadow-lg hover:border-blue-500/50 transition-colors">
                        <div class="flex items-center w-full md:w-auto">
                            <span class="text-brand-light font-black text-base w-40">ุนูุฏ ุงููุตูู ูู ููู:</span>
                            <input type="number" min="1" class="w-24 bg-dark-900 border border-dark-600 rounded-xl py-3 px-3 text-white font-black text-center text-xl focus:border-brand outline-none" value="${reward.levelRequired}" onchange="roleRewards[${index}].levelRequired = parseInt(this.value)">
                        </div>
                        <div class="flex items-center w-full md:flex-1">
                            <span class="text-slate-400 font-bold text-base w-24">ูุฃุฎุฐ ุฑุชุจุฉ:</span>
                            <select class="flex-1 bg-dark-900 border border-dark-600 rounded-xl py-3 px-4 text-white font-bold cursor-pointer focus:border-brand outline-none" onchange="roleRewards[${index}].roleId = this.value">
                                <option value="">-- ูุฑุฌู ุงุฎุชูุงุฑ ุงูุฑุชุจุฉ --</option>
                                ${sRolesHTML.replace(`value="${reward.roleId}"`, `value="${reward.roleId}" selected`)}
                            </select>
                        </div>
                        <button type="button" onclick="roleRewards.splice(${index}, 1); renderLvlRewards();" class="w-full md:w-auto bg-red-600 hover:bg-red-500 text-white px-8 py-3 rounded-xl font-black transition-all shadow-md">ุฅุฒุงูุฉ ๐๏ธ</button>
                    </div>
                `;
            });
        }
        function addLevelRewardUI() { roleRewards.push({ levelRequired: 5, roleId: '' }); renderLvlRewards(); }

        // -----------------------------------------------------------
        // ูุญุฑู ุงูุจุงููุงุช ุงููุชุนุฏุฏุฉ ุงูุนููุงู (ูุนุงูุฌ ุฌููุน ุงูุนูุงููู)
        // -----------------------------------------------------------
        const catsHTML = `<%- categories.map(cat => `<option value="${cat.id}">${cat.name}</option>`).join('') %>`;
        const chsHTML = `<%- textChannels.map(ch => `<option value="${ch.id}">${ch.name}</option>`).join('') %>`;
        
        function renderAllPanels() {
            const container = document.getElementById('dynamic-panels-container'); 
            container.innerHTML = '';
            
            if(panelsArray.length === 0) { 
                container.innerHTML = `<div class="text-center p-12 bg-dark-900/50 rounded-3xl border-2 border-dashed border-dark-700 text-slate-500 font-bold text-lg">ูุง ุชูุฌุฏ ุจุงููุงุช ุชุฐุงูุฑ ุญุงููุงู. ุงุจุฏุฃ ุจุฅุถุงูุฉ ุฃูู ุจุงูู ูู.</div>`; 
                return; 
            }

            panelsArray.forEach((panel, pIdx) => {
                let buttonsHTML = '';
                
                (panel.buttons || []).forEach((btn, bIdx) => {
                    let modalHTML = '';
                    
                    if(btn.requireModal) {
                        modalHTML += `
                            <div class="mt-6 p-6 bg-dark-900/80 rounded-2xl border border-dark-700 shadow-inner">
                                <div class="flex justify-between items-center mb-6 border-b border-dark-600 pb-4">
                                    <span class="text-base font-bold text-brand-light">๐ ุฃุณุฆูุฉ ุงููุงูุฐุฉ ุงูููุจุซูุฉ (ุณุชุนุฑุถ ุงูุฅุฌุงุจุงุช ูู Code Blocks)</span>
                                    <button type="button" onclick="if(!panelsArray[${pIdx}].buttons[${bIdx}].modalFields) panelsArray[${pIdx}].buttons[${bIdx}].modalFields=[]; panelsArray[${pIdx}].buttons[${bIdx}].modalFields.push({label:'',placeholder:'',style:'Short'}); renderAllPanels();" class="text-sm bg-brand hover:bg-brand-light text-white px-5 py-2.5 rounded-xl font-bold transition-all shadow-md">โ ุฅุถุงูุฉ ุณุคุงู</button>
                                </div>
                        `;
                        
                        (btn.modalFields || []).forEach((mf, mIdx) => {
                            modalHTML += `
                                <div class="flex flex-col md:flex-row md:space-x-4 md:space-x-reverse space-y-4 md:space-y-0 mb-4 bg-dark-800 p-4 rounded-xl border border-dark-600">
                                    <input type="text" class="w-full md:w-1/3 bg-dark-900 border border-dark-700 text-sm text-white rounded-xl p-3.5 font-bold focus:border-brand outline-none" placeholder="ุงูุณุคุงู ุงูุฐู ุณูุธูุฑ ููุนููู" value="${mf.label}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].modalFields[${mIdx}].label=this.value">
                                    <input type="text" class="w-full md:flex-1 bg-dark-900 border border-dark-700 text-sm text-white rounded-xl p-3.5 focus:border-brand outline-none" placeholder="ูุซุงู ุฅุฑุดุงุฏู ููุฅุฌุงุจุฉ (ุงุฎุชูุงุฑู)" value="${mf.placeholder}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].modalFields[${mIdx}].placeholder=this.value">
                                    <select class="w-full md:w-auto bg-dark-900 border border-dark-700 text-sm text-white font-bold rounded-xl p-3.5 cursor-pointer outline-none" onchange="panelsArray[${pIdx}].buttons[${bIdx}].modalFields[${mIdx}].style=this.value">
                                        <option value="Short" ${mf.style !== 'Paragraph' ? 'selected' : ''}>ุฅุฌุงุจุฉ ูุตูุฑุฉ</option>
                                        <option value="Paragraph" ${mf.style === 'Paragraph' ? 'selected' : ''}>ุฅุฌุงุจุฉ ุทูููุฉ (ููุฑุฉ)</option>
                                    </select>
                                    <button type="button" onclick="panelsArray[${pIdx}].buttons[${bIdx}].modalFields.splice(${mIdx},1); renderAllPanels();" class="w-full md:w-auto bg-red-600 hover:bg-red-500 text-white px-6 rounded-xl font-bold transition-all shadow-sm">ุญุฐู</button>
                                </div>
                            `;
                        });
                        modalHTML += `</div>`;
                    }

                    buttonsHTML += `
                        <div class="bg-dark-800 p-8 rounded-3xl border border-dark-600 mb-8 relative shadow-xl">
                            <button type="button" onclick="panelsArray[${pIdx}].buttons.splice(${bIdx},1); renderAllPanels();" class="absolute top-5 left-5 text-red-400 bg-red-500/10 hover:bg-red-500 hover:text-white px-5 py-2.5 rounded-xl text-sm font-bold transition-all">ุญุฐู ูุฐุง ุงูุฒุฑ ๐๏ธ</button>
                            
                            <h5 class="text-xl font-black text-white mb-8 border-b border-dark-700 pb-4">๐ ุฅุนุฏุงุฏุงุช ุงูุฒุฑ ุฑูู ${bIdx + 1}</h5>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                                <div>
                                    <label class="text-sm font-bold text-slate-400 block mb-3">ุงุณู ุงูุฒุฑ (ุงูุฐู ุณูุธูุฑ ููุนููู)</label>
                                    <input type="text" class="w-full bg-dark-900 border border-dark-700 text-base text-white font-bold rounded-xl p-4 focus:border-brand outline-none" value="${btn.label}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].label=this.value">
                                </div>
                                <div>
                                    <label class="text-sm font-bold text-slate-400 block mb-3">ููู ุงูุฒุฑ (ุณุชุงูู ุฏูุณููุฑุฏ)</label>
                                    <select class="w-full bg-dark-900 border border-dark-700 text-base font-bold text-white rounded-xl p-4 cursor-pointer outline-none" onchange="panelsArray[${pIdx}].buttons[${bIdx}].buttonStyle=this.value">
                                        <option value="Primary" ${btn.buttonStyle === 'Primary' ? 'selected' : ''}>ุฃุฒุฑู (Primary)</option>
                                        <option value="Success" ${btn.buttonStyle === 'Success' ? 'selected' : ''}>ุฃุฎุถุฑ (Success)</option>
                                        <option value="Danger" ${btn.buttonStyle === 'Danger' ? 'selected' : ''}>ุฃุญูุฑ (Danger)</option>
                                        <option value="Secondary" ${btn.buttonStyle === 'Secondary' ? 'selected' : ''}>ุฑูุงุฏู (Secondary)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="flex flex-wrap items-center space-x-8 space-x-reverse text-base font-bold bg-dark-900/60 p-6 rounded-2xl border border-dark-700 mb-8 gap-y-4 shadow-inner">
                                <label class="text-amber-400 flex items-center cursor-pointer ml-8">
                                    <input type="checkbox" ${btn.isMiddleman ? 'checked' : ''} onchange="panelsArray[${pIdx}].buttons[${bIdx}].isMiddleman=this.checked" class="mr-3 ml-3 w-6 h-6 accent-amber-400"> 
                                    ๐ค ุชูุนูู ูุธุงู ุงููุณุงุทุฉ ููุฐุง ุงูุฒุฑ
                                </label>
                                <label class="text-emerald-400 flex items-center cursor-pointer">
                                    <input type="checkbox" ${btn.requireModal ? 'checked' : ''} onchange="panelsArray[${pIdx}].buttons[${bIdx}].requireModal=this.checked; if(this.checked && !panelsArray[${pIdx}].buttons[${bIdx}].modalFields) panelsArray[${pIdx}].buttons[${bIdx}].modalFields=[]; renderAllPanels();" class="mr-3 ml-3 w-6 h-6 accent-emerald-400"> 
                                    ๐ ุทูุจ ุฃุณุฆูุฉ ููุจุซูุฉ (Modal) ูุจู ูุชุญ ุงูุชุฐูุฑุฉ
                                </label>
                            </div>
                            
                            <h6 class="text-lg font-black text-brand-light mb-6 mt-8 border-t border-dark-700 pt-6">๐จ ุฅููุจุฏ ุงูุชุฐูุฑุฉ ุงูุฏุงุฎูู ุงูุฎุงุต ุจูุฐุง ุงูุฒุฑ:</h6>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div>
                                    <label class="text-xs font-bold text-slate-400 block mb-2">ุนููุงู ุงูุฅููุจุฏ ุงูุฏุงุฎูู (Title)</label>
                                    <input type="text" class="w-full bg-dark-900 border border-dark-700 text-sm text-white rounded-xl p-4 font-bold focus:border-brand outline-none" placeholder="ูุซุงู: ุชุฐูุฑุฉ ุงูุฏุนู ุงูููู" value="${btn.insideEmbedTitle || 'ุชุฐูุฑุฉ ุฌุฏูุฏุฉ'}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].insideEmbedTitle=this.value">
                                </div>
                                <div>
                                    <label class="text-xs font-bold text-slate-400 block mb-2">ูุตู ุงูุฅููุจุฏ ุงูุฏุงุฎูู (Description)</label>
                                    <input type="text" class="w-full bg-dark-900 border border-dark-700 text-sm text-white rounded-xl p-4 focus:border-brand outline-none" placeholder="ุฃููุงู ุจู ูู ุงูุชุฐูุฑุฉุ ูุฑุฌู ุงูุงูุชุธุงุฑ..." value="${btn.insideEmbedDesc || ''}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].insideEmbedDesc=this.value">
                                </div>
                                
                                <div class="md:col-span-2 bg-dark-900/40 p-6 rounded-2xl border border-dark-700 shadow-inner">
                                    <label class="text-sm font-black text-amber-400 block mb-4">๐จ ููู ุฅููุจุฏ ุฅุฌุงุจุงุช ุงููุงูุฐุฉ ุงููุฎุตุต (ุงููุฑุจุนุงุช - Code Blocks)</label>
                                    <div class="flex items-center space-x-6 space-x-reverse">
                                        <input type="color" class="w-16 h-14 bg-dark-900 rounded-xl p-1.5 cursor-pointer border-2 border-dark-600 shadow-sm" value="${btn.modalAnswersEmbedColor || '#2b2d31'}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].modalAnswersEmbedColor=this.value">
                                        <input type="text" class="flex-1 bg-dark-900 text-lg font-mono uppercase text-center rounded-xl border border-dark-600 py-3" value="${btn.modalAnswersEmbedColor || '#2b2d31'}" readonly>
                                    </div>
                                    <p class="text-xs text-slate-400 mt-3 font-bold">ูุฐุง ูู ููู ุงูุฅููุจุฏ ุงููููุตู ุงูุฐู ุณูุชู ุนุฑุถ ุฅุฌุงุจุงุช ุงูุนููู ุจุฏุงุฎูู ุจุดูู ููุธู ุฏุงุฎู ุงูุชุฐูุฑุฉ.</p>
                                </div>
                            </div>
                            
                            ${modalHTML}
                        </div>
                    `;
                });

                container.innerHTML += `
                    <div class="bg-dark-900/80 border-2 border-blue-500/40 rounded-[2.5rem] p-10 relative shadow-[0_10px_40px_rgba(0,0,0,0.5)] mb-12">
                        <button type="button" onclick="panelsArray.splice(${pIdx},1); renderAllPanels();" class="absolute top-8 left-8 bg-red-600 hover:bg-red-500 text-white px-6 py-3.5 rounded-xl text-base font-black shadow-lg transition-all transform hover:scale-105 border border-red-400">ุญุฐู ุงูุจุงูู ุจุงููุงูู ๐๏ธ</button>
                        
                        <div class="flex items-center space-x-6 space-x-reverse mb-10 border-b-2 border-dark-700 pb-8">
                            <input type="color" class="w-20 h-20 rounded-2xl bg-dark-800 p-2 cursor-pointer border-2 border-dark-600 shadow-inner" value="${panel.panelColor || '#5865F2'}" onchange="panelsArray[${pIdx}].panelColor=this.value" title="ููู ุงูุจุงูู ุงูุฎุงุฑุฌู">
                            <div class="flex-1">
                                <label class="text-sm font-bold text-slate-400 block mb-2">ุนููุงู ุงูุจุงูู ุงูุฎุงุฑุฌู (ุงูุฐู ุณูุธูุฑ ูู ุงูุฑูู)</label>
                                <input type="text" class="bg-transparent text-4xl font-black text-white focus:border-b-4 focus:border-brand outline-none w-full md:w-3/4 pb-2 transition-all" placeholder="ูุซุงู: ููุญุฉ ุงูุฏุนู ุงูููู" value="${panel.panelTitle || ''}" onchange="panelsArray[${pIdx}].panelTitle=this.value">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                            <div class="bg-dark-800 p-6 rounded-2xl border border-dark-600 shadow-inner">
                                <label class="text-base font-bold text-slate-300 block mb-4">ุฑูู ุฅุฑุณุงู ุงูุจุงูู</label>
                                <select class="w-full bg-dark-900 text-white font-bold text-lg rounded-xl p-4 cursor-pointer outline-none border border-dark-700 focus:border-brand" onchange="panelsArray[${pIdx}].channelId=this.value">
                                    <option value="">-- ูุฑุฌู ุงุฎุชูุงุฑ ุงูุฑูู --</option>
                                    ${chsHTML.replace(`value="${panel.channelId}"`, `value="${panel.channelId}" selected`)}
                                </select>
                            </div>
                            
                            <div class="bg-dark-800 p-6 rounded-2xl border border-dark-600 shadow-inner">
                                <label class="text-base font-bold text-slate-300 block mb-4">ูุณู ูุชุญ ุงูุชุฐุงูุฑ (Category)</label>
                                <select class="w-full bg-dark-900 text-white font-bold text-lg rounded-xl p-4 cursor-pointer outline-none border border-dark-700 focus:border-brand" onchange="panelsArray[${pIdx}].categoryId=this.value">
                                    <option value="">-- ูุฑุฌู ุงุฎุชูุงุฑ ุงููุณู --</option>
                                    ${catsHTML.replace(`value="${panel.categoryId}"`, `value="${panel.categoryId}" selected`)}
                                </select>
                            </div>
                            
                            <div class="md:col-span-2 bg-dark-800 p-6 rounded-2xl border border-dark-600 shadow-inner">
                                <label class="text-base font-bold text-slate-300 block mb-4">ูุตู ุงูุจุงูู ุงูุฎุงุฑุฌู (Description)</label>
                                <textarea class="w-full bg-dark-900 text-white text-lg rounded-xl p-5 outline-none resize-y border border-dark-700 focus:border-brand leading-relaxed font-bold" rows="3" placeholder="ุงูุชุจ ููุง ุงููุตู ุงูุฐู ุณูุธูุฑ ููุฃุนุถุงุก ูู ุงูุฅููุจุฏ ุงูุฎุงุฑุฌู..." onchange="panelsArray[${pIdx}].panelDescription=this.value">${panel.panelDescription || ''}</textarea>
                            </div>
                        </div>

                        <div class="p-8 bg-dark-900/60 rounded-3xl border border-dark-700 shadow-inner">
                            <h4 class="text-3xl font-black text-brand-light mb-8">๐ ุฃุฒุฑุงุฑ ุงูุจุงูู</h4>
                            ${buttonsHTML}
                            
                            <button type="button" onclick="panelsArray[${pIdx}].buttons.push({id:'btn_'+Math.random().toString(36).substr(2,7),label:'ุฒุฑ ุฌุฏูุฏ',buttonStyle:'Primary',requireModal:false,insideEmbedTitle:'ุชุฐูุฑุฉ ุฌุฏูุฏุฉ',modalAnswersEmbedColor:'#2b2d31'}); renderAllPanels();" class="w-full mt-6 py-6 border-4 border-dashed border-brand/40 bg-brand/5 hover:bg-brand/20 rounded-2xl text-brand-light font-black text-xl transition-all shadow-md transform hover:-translate-y-1">
                                โ ุฅุถุงูุฉ ุฒุฑ ุฌุฏูุฏ ููุฐุง ุงูุจุงูู
                            </button>
                        </div>
                    </div>
                `;
            });
        }

        function addNewPanelUI() { 
            panelsArray.push({
                panelId: 'pnl_' + Math.random().toString(36).substr(2,7), 
                panelTitle: 'ุจุงูู ุชุฐุงูุฑ ุฌุฏูุฏ', 
                panelColor: '#5865F2', 
                panelDescription: 'ูุทูุจ ุงูุฏุนู ุงูููู ูุฑุฌู ุงูุถุบุท ุนูู ุงูุฒุฑ ุฃุฏูุงู.',
                buttons: []
            }); 
            renderAllPanels(); 
        }

        // -----------------------------------------------------------
        // ๐ ุฏุงูุฉ ุงูุญูุธ ุงูุณุญุฑูุฉ (ูููุน ูุณุญ ุงูุฏุงุชุง ุงููุนูุฏุฉ)
        // -----------------------------------------------------------
        function syncAllDataBeforeSave() {
            // ููู ูู ุงูุจูุงูุงุช ูู ุงููุตูููุงุช ุฅูู ุญููู HTML ูุฎููุฉ ูุจู ุงูุฅุฑุณุงู
            document.getElementById('warn_reasonsDataAr').value = JSON.stringify(warnDataAr);
            document.getElementById('warn_reasonsDataEn').value = JSON.stringify(warnDataEn);
            document.getElementById('mm_modalFieldsData').value = JSON.stringify(mmFields);
            document.getElementById('ticketPanelsData').value = JSON.stringify(panelsArray);
            document.getElementById('lvl_roleRewardsData').value = JSON.stringify(roleRewards);
            
            // ุชุญููู ุงูุฒุฑ ููุนุทู ุงูุทุจุงุน ุงูุชุญููู ูุงููุฌุงุญ
            const saveBtn = document.querySelector('button[type="submit"]');
            saveBtn.innerHTML = '<span class="mr-3 ml-2 text-3xl animate-spin">โณ</span> ุฌุงุฑู ุงูุญูุธ ูุชุญุฏูุซ ุงูุณูุฑูุฑ...';
            saveBtn.classList.replace('bg-emerald-500', 'bg-emerald-700');
            saveBtn.classList.replace('border-emerald-400/50', 'border-emerald-700');
            saveBtn.classList.remove('hover:bg-emerald-400', 'hover:-translate-y-2');
            
            return true; // ุงูุณูุงุญ ููููุฑู ุจุงูุงูุทูุงู
        }

        // -----------------------------------------------------------
        // ๐ ูุญุฑู ุงูุชุฑุฌูุฉ ุงูุฏููุงูููู ููุฏุงุดุจูุฑุฏ (ููุจ ุงููุงุฌูุฉ LTR ู RTL)
        // -----------------------------------------------------------
        const systemLang = document.getElementById('system-language');
        
        function applyDashboardLanguage() {
            const isEnglish = systemLang && systemLang.value === 'en';
            
            if(isEnglish) {
                document.documentElement.setAttribute('dir', 'ltr');
                document.documentElement.setAttribute('lang', 'en');
                document.body.style.fontFamily = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
                
                // ุชุฑุฌูุฉ ุงููุตูุต ุงูุชู ุชุญุชูู ุนูู Data Attribute
                document.querySelectorAll('[data-en]').forEach(el => {
                    if(!el.hasAttribute('data-ar')) el.setAttribute('data-ar', el.innerText);
                    el.innerText = el.getAttribute('data-en');
                });
                
                document.getElementById('save-btn-text').innerText = "Save Settings Now";
            } else {
                document.documentElement.setAttribute('dir', 'rtl');
                document.documentElement.setAttribute('lang', 'ar');
                document.body.style.fontFamily = "'Tajawal', sans-serif";
                
                document.querySelectorAll('[data-ar]').forEach(el => {
                    el.innerText = el.getAttribute('data-ar');
                });
                
                document.getElementById('save-btn-text').innerText = "ุญูุธ ุงูุชุนุฏููุงุช ุงูุขู";
            }
            
            // ุฅุนุงุฏุฉ ุฑุณู ุงูููููุงุช ูุชุญุฏูุซ ุงุชุฌุงูุงุชูุง
            renderWarns(isEnglish ? 'en' : 'ar');
        }
        
        if(systemLang) {
            systemLang.addEventListener('change', applyDashboardLanguage);
            // ุชุดุบูู ุงูุชุฑุฌูุฉ ุนูุฏ ุงูุชุญููู ุงูุฃููู
            setTimeout(applyDashboardLanguage, 100); 
        }

        // -----------------------------------------------------------
        // ๐ ุชุดุบูู ุฌููุน ุงููุญุฑูุงุช ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        // -----------------------------------------------------------
        window.onload = () => { 
            // ุฑุณู ุฌููุน ุงูุฃูุณุงู ุงูุฏููุงููููุฉ ูุชุธูุฑ ูููุณุชุฎุฏู ุจุดูู ุตุญูุญ
            renderWarns('ar'); 
            renderWarns('en'); 
            renderMmFields(); 
            renderAllPanels(); 
            renderLvlRewards();
        };
    </script>
</body>
</html>
