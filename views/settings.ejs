<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MNC Ultimate Control | ุฅุนุฏุงุฏุงุช ุงูุฅูุจุฑุงุทูุฑูุฉ</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Tajawal', 'sans-serif'] },
                    colors: { 
                        brand: { DEFAULT: '#5865F2', dark: '#4752C4', light: '#7289DA' }, 
                        dark: { 900: '#0b0f19', 800: '#151b2b', 700: '#1f2937', 600: '#334155' } 
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #0b0f19; color: #f8fafc; overflow-x: hidden; scroll-behavior: smooth; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0b0f19; }
        ::-webkit-scrollbar-thumb { background: #1f2937; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #5865F2; }
        
        .glass-card { 
            background: rgba(21, 27, 43, 0.8); 
            backdrop-filter: blur(20px); 
            border: 1px solid rgba(255, 255, 255, 0.05); 
            box-shadow: 0 10px 40px -10px rgba(0,0,0,0.6); 
        }
        
        .input-glow:focus { 
            box-shadow: 0 0 0 3px rgba(88, 101, 242, 0.3); 
            border-color: #5865F2; 
            outline: none; 
        }
        
        /* ุชุฃุซูุฑุงุช ุงูุฃูุณุงู ูุชุธูุฑ ุจูุนููุฉ */
        .settings-section { display: none; animation: fadeIn 0.4s ease forwards; }
        .settings-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* ========================================================================= */
        /* ๐๏ธ ุงูุฅุตูุงุญ ุงูุฌุฐุฑู ููุฒุฑุงูุฑ ุงูุฏุงุฆุฑูุฉ (Toggles) ูุชูุงุณุจ ุงุชุฌุงู ุงููููู ูููุณุงุฑ */
        /* ========================================================================= */
        .switch {
            position: relative;
            display: inline-block;
            width: 54px;
            height: 28px;
        }
        .switch input { 
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #374151;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            right: 4px; /* ุงูุจุฏุงูุฉ ูู ุงููููู */
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #10B981; /* ููู ุฃุฎุถุฑ ุนูุฏ ุงูุชูุนูู */
        }
        input:checked + .slider:before {
            transform: translateX(-26px); /* ุชุญุฑู ูููุณุงุฑ ุจูููุฉ ุณุงูุจุฉ ูููุน ุงูุฎุฑูุฌ ุนู ุงูุฅุทุงุฑ */
        }
    </style>
</head>

<% 
    // =========================================================================
    // ๐ง ุงุณุชุฎุฑุงุฌ ุจูุงูุงุช ุงูุณูุฑูุฑ
    // =========================================================================
    let textChannels = []; let voiceChannels = []; let categories = []; let serverRoles = [];
    let guildName = "Unknown Server"; let guildIconUrl = "https://cdn.discordapp.com/embed/avatars/0.png";

    if (bot && guildId) {
        const currentGuild = bot.guilds.cache.get(guildId);
        if (currentGuild) {
            guildName = currentGuild.name;
            if (currentGuild.icon) guildIconUrl = `https://cdn.discordapp.com/icons/${guildId}/${currentGuild.icon}.png`;
            
            textChannels = currentGuild.channels.cache.filter(c => c.type === 0 || c.type === 5 || c.type === 15).sort((a,b) => a.position - b.position).map(c => ({ id: c.id, name: c.name }));
            categories = currentGuild.channels.cache.filter(c => c.type === 4).sort((a,b) => a.position - b.position).map(c => ({ id: c.id, name: c.name }));
            serverRoles = currentGuild.roles.cache.filter(r => r.id !== guildId).sort((a,b) => b.position - a.position).map(r => ({ id: r.id, name: r.name }));
        }
    }
%>

<body class="flex h-screen overflow-hidden selection:bg-brand selection:text-white">

    <aside class="w-72 flex-shrink-0 border-l border-dark-700 bg-dark-800 flex flex-col z-20 shadow-[5px_0_20px_rgba(0,0,0,0.5)]">
        <div class="h-24 flex flex-col items-center justify-center border-b border-dark-700 bg-dark-900/60 relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-r from-brand/10 to-transparent"></div>
            <h1 class="text-2xl font-black text-white tracking-wider relative z-10">MNC <span class="text-brand">CONTROL</span></h1>
        </div>

        <nav class="flex-1 overflow-y-auto py-6 px-4 space-y-2 custom-scrollbar" id="sidebar-nav">
            
            <div class="text-[11px] font-black text-slate-500 uppercase tracking-widest mb-3 px-2">ุงูุฃุณุงุณูุงุช ูุงูุฐูุงุก</div>
            
            <button onclick="switchSection('general')" class="nav-btn active-nav w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all bg-brand text-white font-bold" data-target="general">
                <span class="text-lg">โ๏ธ</span> <span>ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ ูุงูุฃููุงู</span>
            </button>
            
            <button onclick="switchSection('ai_system')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-amber-400 hover:bg-dark-700 font-bold" data-target="ai_system">
                <span class="text-lg">โจ</span> <span>ุงูุฐูุงุก ุงูุงุตุทูุงุนู (AI)</span>
            </button>
            
            <button onclick="switchSection('live_embed')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="live_embed">
                <span class="text-lg">๐จ</span> <span>ุตุงูุน ุงูุฅููุจุฏ ุงูููุฑู</span>
            </button>

            <div class="text-[11px] font-black text-slate-500 uppercase tracking-widest mb-3 mt-8 px-2">ุงูุชุฐุงูุฑ ูุงููุณุงุทุฉ</div>
            
            <button onclick="switchSection('middleman')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="middleman">
                <span class="text-lg">โ๏ธ</span> <span>ูุธุงู ุงููุณุงุทุฉ (ุงููุนุฒูู)</span>
            </button>
            
            <button onclick="switchSection('custom_panels')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="custom_panels">
                <span class="text-lg">๐ซ</span> <span>ุงูุจุงููุงุช ุงูุฏููุงููููุฉ</span>
            </button>
            
            <button onclick="switchSection('ticket_controls')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="ticket_controls">
                <span class="text-lg">๐๏ธ</span> <span>ุงูุชุญูู ุงูุฏุงุฎูู ููุชูุช</span>
            </button>

            <div class="text-[11px] font-black text-slate-500 uppercase tracking-widest mb-3 mt-8 px-2">ุงูุฅุฏุงุฑุฉ ูุงูุนููุจุงุช</div>
            
            <button onclick="switchSection('warnings')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-orange-400 hover:bg-dark-700 font-bold" data-target="warnings">
                <span class="text-lg">โ๏ธ</span> <span>ูุธุงู ุงูุชุญุฐูุฑุงุช ูุจุงูู ุงูุฅุฏุงุฑุฉ</span>
            </button>
            
            <button onclick="switchSection('commands')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="commands">
                <span class="text-lg">โจ๏ธ</span> <span>ุชุฎุตูุต ุงูุฃูุงูุฑ (ุงูุนููุจุงุช)</span>
            </button>
            
            <button onclick="switchSection('logs')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="logs">
                <span class="text-lg">๐</span> <span>ุงูุณุฌูุงุช ุงูุฏูููุฉ ูุงูุฃููุงู</span>
            </button>
            
            <button onclick="switchSection('roles')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="roles">
                <span class="text-lg">๐</span> <span>ุงูุฑุชุจ ูุงูุตูุงุญูุงุช ุงูุนููุง</span>
            </button>
            
            <button onclick="switchSection('ratings')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="ratings">
                <span class="text-lg">โญ</span> <span>ุงูุชููููุงุช ุงููุฒุฏูุฌุฉ</span>
            </button>

            <div class="text-[11px] font-black text-slate-500 uppercase tracking-widest mb-3 mt-8 px-2">ุงูุญูุงูุฉ ูุงูุชูุงุนู</div>
            
            <button onclick="switchSection('protection')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="protection">
                <span class="text-lg">๐ก๏ธ</span> <span>ุงูุญูุงูุฉ ูุงูู Anti-Nuke</span>
            </button>
            
            <button onclick="switchSection('welcome')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="welcome">
                <span class="text-lg">๐</span> <span>ุงูุชุฑุญูุจ ูุงููุบุงุฏุฑุฉ</span>
            </button>
            
            <button onclick="switchSection('economy')" class="nav-btn w-full flex items-center space-x-3 space-x-reverse px-4 py-3.5 rounded-xl transition-all text-slate-400 hover:bg-dark-700 hover:text-white font-bold" data-target="economy">
                <span class="text-lg">๐ฐ</span> <span>ุงูุงูุชุตุงุฏ ูุงููููุงุช ุงูุชููุงุฆูุฉ</span>
            </button>

        </nav>
    </aside>

    <main class="flex-1 flex flex-col h-screen relative bg-dark-900">
        
        <header class="h-24 flex-shrink-0 border-b border-dark-700 bg-dark-800/80 backdrop-blur-xl flex items-center px-10 z-10 shadow-md relative">
            <div class="absolute inset-0 bg-gradient-to-r from-brand/5 to-transparent pointer-events-none"></div>
            <div class="flex items-center space-x-5 space-x-reverse z-10">
                <img src="<%= guildIconUrl %>" alt="Guild Icon" class="w-14 h-14 rounded-xl border border-dark-600 shadow-lg object-cover">
                <div>
                    <h2 class="text-2xl font-black text-white tracking-wide"><%= guildName %></h2>
                    <p class="text-xs text-slate-400 font-mono mt-1">Guild ID: <%= guildId %></p>
                </div>
            </div>
        </header>

        <button type="submit" form="mega-settings-form" onclick="return syncAllDataBeforeSave()" class="fixed bottom-8 left-8 z-[100] flex items-center px-8 py-5 bg-emerald-500 hover:bg-emerald-400 text-dark-900 text-xl font-black rounded-2xl shadow-[0_0_40px_rgba(16,185,129,0.4)] transition-all transform hover:-translate-y-2 hover:scale-105 border border-emerald-400/50">
            <span class="mr-3 ml-2 text-3xl">๐พ</span> ุญูุธ ุงูุชุนุฏููุงุช ุงูุขู
        </button>

        <div class="flex-1 overflow-y-auto p-6 md:p-10 z-10 custom-scrollbar relative" id="main-scroll-area">
            
            <% if (typeof success !== 'undefined' && success) { %>
                <div class="mb-8 bg-emerald-500/10 border-r-4 border-emerald-500 text-emerald-400 px-6 py-5 rounded-xl flex items-center shadow-lg mx-auto max-w-5xl">
                    <span class="text-2xl ml-4">โ</span>
                    <div>
                        <h4 class="font-bold text-lg">ุชู ุงูุญูุธ ุจูุฌุงุญ!</h4>
                        <p class="text-sm opacity-80">ุชู ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุทุจูู ุงูุฅุนุฏุงุฏุงุช ุนูู ุงูุณูุฑูุฑ ููุฑุงู.</p>
                    </div>
                </div>
            <% } %>

            <form action="/settings/<%= guildId %>/save" method="POST" id="mega-settings-form">
                
                <div id="section-general" class="settings-section active max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ ูุงูุฃููุงู โ๏ธ</h2>
                        <p class="text-slate-400">ุงูุจุงุฏุฆุฉ ุงูุฃุณุงุณูุฉ ูุฃููุงู ุงูุฅููุจุฏุงุช ุงูุซุงุจุชุฉ ูู ุงูุณูุฑูุฑ.</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-brand">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3">ุงูุจุงุฏุฆุฉ (Prefix)</label>
                                <input type="text" name="prefix" value="<%= config.prefix || '!' %>" required class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-5 text-white input-glow font-mono text-2xl text-center font-black">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3">ูุบุฉ ุงููุธุงู ุงูุฃุณุงุณูุฉ</label>
                                <select name="language" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-5 text-white input-glow font-bold text-lg cursor-pointer">
                                    <option value="ar" <%= config.language === 'ar' ? 'selected' : '' %>>๐ธ๐ฆ ุงูุนุฑุจูุฉ (Arabic)</option>
                                    <option value="en" <%= config.language === 'en' ? 'selected' : '' %>>๐บ๐ธ ุงูุฅูุฌููุฒูุฉ (English)</option>
                                </select>
                            </div>
                        </div>

                        <hr class="border-dark-700 my-8">
                        <h3 class="text-2xl font-bold text-white mb-6">๐จ ุชูุญูุฏ ุฃุดูุงู ุงูุฅููุจุฏ (Global Embeds)</h3>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <label class="block text-sm font-bold text-brand-light mb-3">โน๏ธ ุงูููู ุงูุฃุณุงุณู (Primary)</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="emb_primaryColor_picker" value="<%= config.embedSetup?.primaryColor || '#5865F2' %>" class="w-14 h-12 rounded-xl bg-dark-900 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('emb_primaryColor').value = this.value">
                                    <input type="text" id="emb_primaryColor" name="emb_primaryColor" value="<%= config.embedSetup?.primaryColor || '#5865F2' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-3 text-white font-mono uppercase text-center" oninput="document.getElementById('emb_primaryColor_picker').value = this.value">
                                </div>
                            </div>
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <label class="block text-sm font-bold text-emerald-400 mb-3">โ ููู ุฑุณุงุฆู ุงููุฌุงุญ</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="emb_successColor_picker" value="<%= config.embedSetup?.successColor || '#3ba55d' %>" class="w-14 h-12 rounded-xl bg-dark-900 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('emb_successColor').value = this.value">
                                    <input type="text" id="emb_successColor" name="emb_successColor" value="<%= config.embedSetup?.successColor || '#3ba55d' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-3 text-white font-mono uppercase text-center" oninput="document.getElementById('emb_successColor_picker').value = this.value">
                                </div>
                            </div>
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <label class="block text-sm font-bold text-red-400 mb-3">โ ููู ุฑุณุงุฆู ุงูุฎุทุฃ</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="emb_errorColor_picker" value="<%= config.embedSetup?.errorColor || '#ed4245' %>" class="w-14 h-12 rounded-xl bg-dark-900 border border-dark-600 p-1 cursor-pointer" onchange="document.getElementById('emb_errorColor').value = this.value">
                                    <input type="text" id="emb_errorColor" name="emb_errorColor" value="<%= config.embedSetup?.errorColor || '#ed4245' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-3 text-white font-mono uppercase text-center" oninput="document.getElementById('emb_errorColor_picker').value = this.value">
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-slate-300 mb-2">ูุต ุงูููุชุฑ ุงูููุญุฏ (Footer Text)</label>
                                <input type="text" name="emb_footerText" value="<%= config.embedSetup?.footerText || 'Enterprise System ยฉ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-bold">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฑุงุจุท ุฃููููุฉ ุงูููุชุฑ (Footer Icon)</label>
                                <input type="text" name="emb_footerIconUrl" value="<%= config.embedSetup?.footerIconUrl || '' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow text-left font-mono text-sm" dir="ltr" placeholder="https://...">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฑุงุจุท ุงูุตูุฑุฉ ุงูุฌุงูุจูุฉ (Thumbnail)</label>
                                <input type="text" name="emb_thumbnailUrl" value="<%= config.embedSetup?.thumbnailUrl || '' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow text-left font-mono text-sm" dir="ltr" placeholder="https://...">
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-ai_system" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-amber-400 mb-2 tracking-tight">ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุชูุฏู โจ</h2>
                        <p class="text-slate-400">ุชุญูู ูุงูู ูู ุดุฎุตูุฉ ุงูุจูุชุ ูููุนูุ ูุงูุณูุงุญ ููุฃุนุถุงุก ุจุงุฎุชูุงุฑ ูู ูุชุญุฏุซูู ุฅููู.</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-amber-400 shadow-[0_0_30px_rgba(251,191,36,0.1)]">
                        
                        <div class="flex flex-col md:flex-row items-center justify-between bg-dark-900/80 p-5 rounded-2xl border border-amber-500/30 mb-8 gap-4">
                            <div>
                                <h3 class="text-xl font-bold text-white mb-1">๐ค ุชูุนูู ูุธุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุงููุญุงุฏุซุงุช</h3>
                                <p class="text-sm text-slate-400">ูุฌุนู ุงูุจูุช ูุฑุฏ ุนูู ุงูุฑุณุงุฆู ูู ุงูุฑูู ุงููุฎุตุตุฉ ูุฃูู ุฅูุณุงู ุญูููู.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="ai_enabled" id="ai_enabled" <%= config.aiSystem?.enabled !== false ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="flex items-center justify-between p-5 bg-dark-800 rounded-2xl border border-dark-600 mb-8">
                            <div>
                                <h3 class="text-lg font-bold text-brand-light">ุงูุณูุงุญ ููุนุถู ุจุงุฎุชูุงุฑ ุงูุดุฎุตูุฉ (Hybrid Mode)</h3>
                                <p class="text-xs text-slate-400 mt-1">ุฅุฐุง ุชู ุงูุชูุนููุ ูููู ููุนุถู ูุชุงุจุฉ ุฃูุฑ ูุงุฎุชูุงุฑ ุงูุชุญุฏุซ ูุน ุงูููุฏ ุฃู ุงูุจูุชุ ูุฅุฐุง ุชู ุงูุฅุบูุงู ุณูุนุชูุฏ ุนูู ุงูุฅุนุฏุงุฏุงุช ุฃุฏูุงู ููุท.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="ai_allowUserChoice" id="ai_allowUserChoice" <%= config.aiSystem?.allowUserChoice !== false ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <h4 class="text-blue-400 font-bold mb-4 text-lg border-b border-dark-600 pb-2">๐ฆ ุฅุนุฏุงุฏุงุช ุดุฎุตูุฉ ุงูููุฏ</h4>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุงุณู ุงูุจูุช</label>
                                <input type="text" name="ai_defaultBoyName" value="<%= config.aiSystem?.defaultBoyName || 'ุฒูุฒู' %>" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white input-glow font-bold mb-4">
                            </div>
                            
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <h4 class="text-pink-400 font-bold mb-4 text-lg border-b border-dark-600 pb-2">๐ง ุฅุนุฏุงุฏุงุช ุดุฎุตูุฉ ุงูุจูุช</h4>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุงุณู ุงูุจูุช</label>
                                <input type="text" name="ai_defaultGirlName" value="<%= config.aiSystem?.defaultGirlName || 'ุณูุณู' %>" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white input-glow font-bold mb-4">
                            </div>
                        </div>

                        <div class="bg-dark-900/80 p-5 rounded-2xl border border-dark-700">
                            <label class="block text-sm font-bold text-slate-300 mb-3 text-lg">ุฑูู ุงูุฏุฑุฏุดุฉ ูุน ุงูุฐูุงุก ุงูุงุตุทูุงุนู</label>
                            <select name="ai_chatChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-4 px-4 text-amber-50 input-glow cursor-pointer font-bold text-lg">
                                <option value="">-- ุงุฎุชุฑ ุงูุฑูู ููุชุญุฏุซ ูููุง ุงูุฃุนุถุงุก --</option>
                                <% textChannels.forEach(ch => { %> <option value="<%= ch.id %>" <%= config.aiSystem?.chatChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> <% }) %>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="section-live_embed" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ุตุงูุน ุงูุฅููุจุฏ ุงูููุฑู ๐จ</h2>
                        <p class="text-slate-400">ุตูู ุฑุณุงูุฉ ูุฃุฑุณููุง ูุฃู ุฑูู ูู ุงูุณูุฑูุฑ ููุฑุงู.</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 border-t-4 border-t-fuchsia-500">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-6">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3">ุงุฎุชุฑ ุงูุฑูู ููุฅุฑุณุงู</label>
                                <select id="live_embed_channel" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white input-glow font-bold cursor-pointer">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %><option value="<%= ch.id %>">๐ฌ <%= ch.name %></option><% }) %>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-3">ููู ุงูุฅููุจุฏ</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="live_embed_color_picker" value="#5865F2" class="w-14 h-12 rounded-xl cursor-pointer bg-dark-900 border border-dark-700 p-1" onchange="document.getElementById('live_embed_color').value = this.value">
                                    <input type="text" id="live_embed_color" value="#5865F2" class="flex-1 bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white input-glow font-mono uppercase text-center" oninput="document.getElementById('live_embed_color_picker').value = this.value">
                                </div>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="block text-sm font-bold text-slate-300 mb-2">ุงูุนููุงู (Title)</label>
                            <input type="text" id="live_embed_title" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-bold text-lg" placeholder="ุงูุชุจ ุนููุงู ุงูุฅููุจุฏ...">
                        </div>

                        <div class="mb-6">
                            <label class="block text-sm font-bold text-slate-300 mb-2">ุงููุตู / ุงูููุงููู (Description) - ูุฏุนู ุงูุฒุฎุงุฑู</label>
                            <textarea id="live_embed_desc" rows="6" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-4 px-5 text-white input-glow resize-y leading-relaxed" placeholder="ุงูุชุจ ูุญุชูู ุงูุฅููุจุฏ ููุง..."></textarea>
                        </div>

                        <div class="mb-8">
                            <label class="block text-sm font-bold text-slate-300 mb-2">ุฑุงุจุท ุตูุฑุฉ (ุงุฎุชูุงุฑู)</label>
                            <input type="text" id="live_embed_image" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow text-left font-mono" dir="ltr" placeholder="https://...">
                        </div>

                        <div id="live_embed_status" class="hidden mb-6 px-5 py-4 rounded-xl font-bold text-sm text-center shadow-inner"></div>

                        <button type="button" onclick="sendLiveEmbed('<%= guildId %>')" class="w-full py-4 bg-fuchsia-600 hover:bg-fuchsia-500 text-white font-black text-xl rounded-xl transition-all shadow-lg shadow-fuchsia-500/30">
                            ๐ ุฅุฑุณุงู ุงูุฅููุจุฏ ููุฏูุณููุฑุฏ ุงูุขู!
                        </button>
                    </div>
                </div>

                <div id="section-middleman" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ูุธุงู ุงููุณุงุทุฉ ุงููุนุฒูู โ๏ธ</h2>
                        <p class="text-slate-400">ุจุงูู ูููุตู ูููุงู ูุทูุจ ุงููุณุทุงุกุ ูุนุชูุฏ ุนูู ุฃูุฑ <code class="text-brand bg-dark-800 px-2 py-1 rounded">!done</code> ููุชูููู.</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-amber-500">
                        <div class="flex items-center justify-between bg-dark-900/50 p-6 rounded-2xl border border-dark-700 mb-8">
                            <div>
                                <h3 class="text-xl font-bold text-white mb-1">ุชูุนูู ูุธุงู ุงููุณุงุทุฉ</h3>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="mm_enabled" id="mm_enabled" <%= config.middlemanSystem?.enabled ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ูุณู ุงูุชุฐุงูุฑ (Category)</label>
                                <select name="mm_categoryId" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white input-glow cursor-pointer font-bold">
                                    <option value="">-- ุงุฎุชุฑ ุงููุณู --</option>
                                    <% categories.forEach(cat => { %> <option value="<%= cat.id %>" <%= config.middlemanSystem?.categoryId === cat.id ? 'selected' : '' %>>๐ <%= cat.name %></option> <% }) %>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฑูู ุฅุฑุณุงู ุงูุจุงูู ุงูุฎุงุฑุฌู</label>
                                <select name="mm_panelChannelId" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white input-glow cursor-pointer font-bold">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %> <option value="<%= ch.id %>" <%= config.middlemanSystem?.panelChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> <% }) %>
                                </select>
                            </div>
                        </div>

                        <hr class="border-dark-700 my-8">
                        <h3 class="text-xl font-bold text-white mb-6">๐ผ๏ธ ุชุตููู ุงูุจุงูู ุงูุฎุงุฑุฌู</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุนููุงู ุงูุฅููุจุฏ ุงูุฎุงุฑุฌู</label>
                                <input type="text" name="mm_panelTitle" value="<%= config.middlemanSystem?.panelTitle || 'ุชุฐูุฑุฉ ูุณุงุทุฉ ุขููุฉ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-bold">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ููู ุงูุฅููุจุฏ ุงูุฎุงุฑุฌู</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="mm_panelColor_picker" value="<%= config.middlemanSystem?.panelColor || '#f2a658' %>" class="w-14 h-12 rounded-xl cursor-pointer bg-dark-900 border border-dark-700 p-1" onchange="document.getElementById('mm_panelColor').value = this.value">
                                    <input type="text" id="mm_panelColor" name="mm_panelColor" value="<%= config.middlemanSystem?.panelColor || '#f2a658' %>" class="flex-1 bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-mono uppercase text-center" oninput="document.getElementById('mm_panelColor_picker').value = this.value">
                                </div>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-slate-300 mb-2">ูุตู ุงูุฅููุจุฏ ุงูุฎุงุฑุฌู</label>
                                <textarea name="mm_panelDescription" rows="3" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow resize-y"><%= config.middlemanSystem?.panelDescription || 'ูุทูุจ ูุณูุท ูุนุชูุฏุ ูุฑุฌู ูุชุญ ุชุฐูุฑุฉ ูู ููุง.' %></textarea>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุงุณู ุงูุฒุฑ (Button Label)</label>
                                <input type="text" name="mm_buttonLabel" value="<%= config.middlemanSystem?.buttonLabel || 'ุทูุจ ูุณูุท ๐ก๏ธ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-bold">
                            </div>
                        </div>

                        <hr class="border-dark-700 my-8">
                        <h3 class="text-xl font-bold text-white mb-6">๐ ุงููุงูุฐุฉ ุงูููุจุซูุฉ (Modal) ูุงูุฅููุจุฏ ุงูุฏุงุฎูู</h3>
                        
                        <div class="mb-6">
                            <label class="block text-sm font-bold text-slate-300 mb-2">ุนููุงู ุงููุงูุฐุฉ (Modal Title)</label>
                            <input type="text" name="mm_modalTitle" value="<%= config.middlemanSystem?.modalTitle || 'ุจูุงูุงุช ุงููุณุงุทุฉ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-bold">
                        </div>

                        <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 mb-8">
                            <h4 class="text-lg font-bold text-brand-light mb-4">ุฃุณุฆูุฉ ุงููุงูุฐุฉ</h4>
                            <input type="hidden" name="mm_modalFieldsData" id="mm_modalFieldsData" value="<%= JSON.stringify(config.middlemanSystem?.modalFields || []) %>">
                            <div id="mm-fields-ui-container" class="space-y-4 mb-6">
                                </div>
                            <button type="button" onclick="addMmFieldUI()" class="w-full py-4 bg-emerald-600/20 hover:bg-emerald-600 text-emerald-400 hover:text-white font-bold text-lg rounded-xl border border-dashed border-emerald-500 transition-colors">
                                โ ุฅุถุงูุฉ ุณุคุงู ูููุงูุฐุฉ
                            </button>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุนููุงู ุงูุฅููุจุฏ ุงูุฏุงุฎูู</label>
                                <input type="text" name="mm_insideTicketTitle" value="<%= config.middlemanSystem?.insideTicketTitle || 'ุชุฐูุฑุฉ ุงููุณุงุทุฉ' %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-bold">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ููู ุงูุฅููุจุฏ ุงูุฏุงุฎูู ููุชุฐูุฑุฉ</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="mm_insideTicketColor_picker" value="<%= config.middlemanSystem?.insideTicketColor || '#f2a658' %>" class="w-14 h-12 rounded-xl cursor-pointer bg-dark-900 border border-dark-700 p-1" onchange="document.getElementById('mm_insideTicketColor').value = this.value">
                                    <input type="text" id="mm_insideTicketColor" name="mm_insideTicketColor" value="<%= config.middlemanSystem?.insideTicketColor || '#f2a658' %>" class="flex-1 bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-mono uppercase text-center" oninput="document.getElementById('mm_insideTicketColor_picker').value = this.value">
                                </div>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-bold text-slate-300 mb-2">ูุตู ุงูุฅููุจุฏ ุงูุฏุงุฎูู (ูุฏุนู {user})</label>
                                <textarea name="mm_insideTicketDescription" rows="2" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow resize-y"><%= config.middlemanSystem?.insideTicketDescription || 'ุฃููุงู ุจู {user}ุ ูุฑุฌู ุงูุชุธุงุฑ ุงููุณูุท.' %></textarea>
                            </div>
                            
                            <div class="md:col-span-2 bg-dark-800 p-4 rounded-xl border border-dark-600 mt-2">
                                <label class="block text-sm font-bold text-amber-400 mb-2">๐จ ููู ุฅููุจุฏ ุฅุฌุงุจุงุช ุงููุงูุฐุฉ ุงููุฎุตุต (ุงููุฑุจุนุงุช - Code Blocks)</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="mm_modalAnswersColor_picker" value="<%= config.middlemanSystem?.modalAnswersEmbedColor || '#f2a658' %>" class="w-14 h-12 rounded-xl cursor-pointer bg-dark-900 border border-dark-700 p-1" onchange="document.getElementById('mm_modalAnswersEmbedColor').value = this.value">
                                    <input type="text" id="mm_modalAnswersEmbedColor" name="mm_modalAnswersEmbedColor" value="<%= config.middlemanSystem?.modalAnswersEmbedColor || '#f2a658' %>" class="flex-1 bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white input-glow font-mono uppercase text-center" oninput="document.getElementById('mm_modalAnswersColor_picker').value = this.value">
                                </div>
                                <p class="text-xs text-slate-400 mt-2">ูุฐุง ูู ููู ุงูุฅููุจุฏ ุงููููุตู ุงูุฐู ุณุชูุนุฑุถ ุจุฏุงุฎูู ุฅุฌุงุจุงุช ุงูุนููู ูู ุงูุชุฐูุฑุฉ.</p>
                            </div>
                        </div>
                    </div>
                </div>

<div id="section-custom_panels" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ุงูุจุงููุงุช ุงูุฏููุงููููุฉ ๐ซ</h2>
                        <p class="text-slate-400">ุงุตูุน ุจุงููุงุช ุชุฐุงูุฑ ูุง ููุงุฆูุฉุ ูุน ุชุญูู ูุงูู ุจุงูุฒุฑุงูุฑ ูุฃููุงู ุฅููุจุฏ ุงูุฅุฌุงุจุงุช.</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-blue-500">
                        <input type="hidden" name="ticketPanelsData" id="ticketPanelsData" value="<%= JSON.stringify(config.ticketPanels || []) %>">
                        
                        <div id="dynamic-panels-container" class="space-y-10">
                            </div>

                        <button type="button" onclick="addNewPanelUI()" class="mt-10 flex items-center justify-center w-full px-8 py-5 bg-blue-600 hover:bg-blue-500 text-white font-black text-xl rounded-2xl transition-all shadow-[0_0_30px_rgba(37,99,235,0.4)] transform hover:-translate-y-1">
                            <span class="text-3xl mr-3">โ</span> ุฅุถุงูุฉ ุจุงูู ุชุฐุงูุฑ ุฌุฏูุฏ
                        </button>
                    </div>
                </div>

                <div id="section-ticket_controls" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ุงูุชุญูู ุงูุฏุงุฎูู ููุชูุช ๐๏ธ</h2>
                        <p class="text-slate-400">ุงูุชุฑุงูุณูุฑูุจุชุ ุฃุฒุฑุงุฑ ุงูุงุณุชูุงูุ ููุธุงู ุฅุบูุงู ุงูุชุฐุงูุฑ ุงููุฒุฏูุฌ.</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-indigo-500">
                        
                        <div class="flex flex-col md:flex-row items-center justify-between p-6 bg-dark-900/80 rounded-2xl border border-indigo-500/30 mb-8 shadow-inner gap-4">
                            <div>
                                <h3 class="text-xl font-bold text-white mb-1">๐ ุงูุฅุบูุงู ุจุฎุทูุชูู (Two-Step Close)</h3>
                                <p class="text-sm text-slate-400">ุนูุฏ ุงูุถุบุท ุนูู Closeุ ูุง ุชูุญุฐู ุงูุชุฐูุฑุฉุ ุจู ุชุธูุฑ ุฃุฒุฑุงุฑ (Reopen / Delete / Delete With Reason) ููุฅุฏุงุฑู.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" name="tc_twoStepClose" id="tc_twoStepClose" <%= config.ticketControls?.twoStepClose !== false ? 'checked' : '' %>>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 relative overflow-hidden">
                                <div class="absolute top-0 right-0 bg-brand text-xs font-bold px-3 py-1 rounded-bl-xl text-white">Counter ๐ข</div>
                                <label class="block text-sm font-bold text-white mb-3 mt-2">ุฑูู ุงูุชูุช ุงููุงุฏู (ูุฅููุงู ุงูุนุฏ ุงููุฏูู)</label>
                                <input type="number" name="tc_ticketCounter" value="<%= config.ticketControls?.ticketCounter || 1 %>" min="1" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-4 px-4 text-brand-light font-mono text-3xl text-center font-black outline-none focus:border-brand">
                            </div>
                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700 relative">
                                <label class="block text-sm font-bold text-white mb-3">ุฑูู ุงูุชุฑุงูุณูุฑูุจุช (ุญูุธ ุงูุฑุณุงุฆู)</label>
                                <select name="tc_transcriptChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-4 px-4 text-white input-glow cursor-pointer font-bold">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %> <option value="<%= ch.id %>" <%= config.ticketControls?.transcriptChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> <% }) %>
                                </select>
                            </div>
                        </div>

                        <h3 class="text-2xl font-bold text-amber-400 mb-6">๐ต๏ธ ุฅุนุฏุงุฏุงุช ุฒุฑ ุงูุงุณุชูุงู (Claim)</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-5 bg-dark-900/50 rounded-2xl border border-dark-700 transition-all" id="hide_claim_container">
                                <div>
                                    <h3 class="text-lg font-bold text-white">ุฅุฎูุงุก ุงูุชุฐูุฑุฉ ุนูุฏ ุงูุงุณุชูุงู</h3>
                                    <p class="text-xs text-slate-400 mt-1">ูุฎูู ุงูุชูุช ุนู ุจุงูู ุทุงูู ุงูุฅุฏุงุฑุฉ.</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" name="tc_hideTicketOnClaim" id="tc_hideTicketOnClaim" <%= config.ticketControls?.hideTicketOnClaim ? 'checked' : '' %>>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div class="flex items-center justify-between p-5 bg-dark-900/50 rounded-2xl border border-dark-700 transition-all" id="read_claim_container">
                                <div>
                                    <h3 class="text-lg font-bold text-white">ููุน ุงูุฅุฏุงุฑููู ุงูุขุฎุฑูู ูู ุงููุชุงุจุฉ (Read-Only)</h3>
                                    <p class="text-xs text-slate-400 mt-1">ูุณูุญ ููุฅุฏุงุฑุฉ ุจุฑุคูุฉ ุงูุชูุช ูููู ูููุนูู ูู ุงููุชุงุจุฉ ููู.</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" name="tc_readOnlyStaffOnClaim" id="tc_readOnlyStaffOnClaim" <%= config.ticketControls?.readOnlyStaffOnClaim ? 'checked' : '' %>>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-ratings" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ุงูุชููููุงุช ุงููุฒุฏูุฌุฉ โญ</h2>
                        <p class="text-slate-400">ุชุฎุตูุต ุฑููุงุช ูุฃููุงู ุงูุชููููุงุช ุงูุฎุงุตุฉ ุจุงูุฏุนู ุงูููู ูุงููุณุงุทุฉ.</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-yellow-500">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700">
                                <h3 class="text-xl font-bold text-brand-light mb-6 flex items-center">๐ก๏ธ ุชููููุงุช ุงูุฏุนู ุงูููู</h3>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฑูู ุงูููุฌ (Staff Rating)</label>
                                <select name="rating_staffLogChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white font-bold mb-6">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %> <option value="<%= ch.id %>" <%= config.ratings?.staffLogChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> <% }) %>
                                </select>
                                
                                <label class="block text-sm font-bold text-slate-300 mb-2">ููู ุฅููุจุฏ ุงูุชูููู</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="rating_staff_color_picker" value="<%= config.ratings?.staffEmbedColor || '#3ba55d' %>" class="w-14 h-12 rounded-xl cursor-pointer bg-dark-800 border border-dark-600 p-1" onchange="document.getElementById('rating_staffEmbedColor').value = this.value">
                                    <input type="text" id="rating_staffEmbedColor" name="rating_staffEmbedColor" value="<%= config.ratings?.staffEmbedColor || '#3ba55d' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white font-mono uppercase text-center" oninput="document.getElementById('rating_staff_color_picker').value = this.value">
                                </div>
                            </div>

                            <div class="bg-dark-900/50 p-6 rounded-2xl border border-dark-700">
                                <h3 class="text-xl font-bold text-amber-500 mb-6 flex items-center">โ๏ธ ุชููููุงุช ุงููุณุทุงุก</h3>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฑูู ุงูููุฌ (Middleman Rating)</label>
                                <select name="rating_middlemanLogChannelId" class="w-full bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white font-bold mb-6">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option>
                                    <% textChannels.forEach(ch => { %> <option value="<%= ch.id %>" <%= config.ratings?.middlemanLogChannelId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option> <% }) %>
                                </select>
                                
                                <label class="block text-sm font-bold text-slate-300 mb-2">ููู ุฅููุจุฏ ุงูุชูููู</label>
                                <div class="flex items-center space-x-3 space-x-reverse">
                                    <input type="color" id="rating_mm_color_picker" value="<%= config.ratings?.middlemanEmbedColor || '#f2a658' %>" class="w-14 h-12 rounded-xl cursor-pointer bg-dark-800 border border-dark-600 p-1" onchange="document.getElementById('rating_middlemanEmbedColor').value = this.value">
                                    <input type="text" id="rating_middlemanEmbedColor" name="rating_middlemanEmbedColor" value="<%= config.ratings?.middlemanEmbedColor || '#f2a658' %>" class="flex-1 bg-dark-800 border border-dark-600 rounded-xl py-3 px-4 text-white font-mono uppercase text-center" oninput="document.getElementById('rating_mm_color_picker').value = this.value">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-roles" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ุงูุฑุชุจ ูุงูุตูุงุญูุงุช ๐</h2>
                        <p class="text-slate-400">ุญุฏุฏ ุงูุฑุชุจ ุงููุณุคููุฉ (ุงุถุบุท Ctrl ูุชุญุฏูุฏ ุฃูุซุฑ ูู ุฑุชุจุฉ ูู ุงูููุงุฆู ุงููุชุนุฏุฏุฉ).</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-purple-500">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฑุชุจุฉ ุงูุฏุนู ุงูููู ุงูุฃุณุงุณูุฉ</label>
                                <select name="role_adminRoleId" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white input-glow cursor-pointer font-bold">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑุชุจุฉ --</option>
                                    <% serverRoles.forEach(role => { %> <option value="<%= role.id %>" <%= config.roles?.adminRoleId === role.id ? 'selected' : '' %>>๐ก๏ธ <%= role.name %></option> <% }) %>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฑุชุจุฉ ุงููุณูุท ุงูุฃุณุงุณูุฉ</label>
                                <select name="role_middlemanRoleId" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white input-glow cursor-pointer font-bold">
                                    <option value="">-- ุงุฎุชุฑ ุงูุฑุชุจุฉ --</option>
                                    <% serverRoles.forEach(role => { %> <option value="<%= role.id %>" <%= config.roles?.middlemanRoleId === role.id ? 'selected' : '' %>>โ๏ธ <%= role.name %></option> <% }) %>
                                </select>
                            </div>
                        </div>

                        <hr class="border-dark-700 my-8">
                        <h3 class="text-xl font-bold text-white mb-6">๐ ุฑุชุจ ุงูุฅุฏุงุฑุฉ ุงูุนููุง ูุงูุชุฑูุฏ (ูุชุนุฏุฏ)</h3>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-dark-900/50 p-5 rounded-xl border border-dark-700">
                                <label class="block text-sm font-bold text-amber-400 mb-3">ุงูุฅุฏุงุฑุฉ ุงูุนููุง (High Staff)</label>
                                <select name="role_highAdminRoles" multiple class="w-full h-32 bg-dark-800 border border-dark-600 rounded-xl py-2 px-3 text-white input-glow custom-scrollbar">
                                    <% serverRoles.forEach(role => { %> <option value="<%= role.id %>" <%= (config.roles?.highAdminRoles || []).includes(role.id) ? 'selected' : '' %>><%= role.name %></option> <% }) %>
                                </select>
                                <p class="text-[10px] text-slate-500 mt-2">ูุทููุจุฉ ููููุงููุฉ ูู ุฃูุฑ Approve ููุชุฎุทู ุจุนุถ ุงููููุฏ.</p>
                            </div>
                            <div class="bg-dark-900/50 p-5 rounded-xl border border-dark-700">
                                <label class="block text-sm font-bold text-blue-400 mb-3">ุฑุชุจ ููุดู ุงูุชุฑูุฏ</label>
                                <select name="role_tradePingRoleIds" multiple class="w-full h-32 bg-dark-800 border border-dark-600 rounded-xl py-2 px-3 text-white input-glow custom-scrollbar">
                                    <% serverRoles.forEach(role => { %> <option value="<%= role.id %>" <%= (config.roles?.tradePingRoleIds || []).includes(role.id) ? 'selected' : '' %>><%= role.name %></option> <% }) %>
                                </select>
                            </div>
                            <div class="bg-dark-900/50 p-5 rounded-xl border border-dark-700">
                                <label class="block text-sm font-bold text-emerald-400 mb-3">ุฑุชุจ ุงูููุงููุฉ ุนูู ุงูุชุฑูุฏ</label>
                                <select name="role_tradeApproveRoleIds" multiple class="w-full h-32 bg-dark-800 border border-dark-600 rounded-xl py-2 px-3 text-white input-glow custom-scrollbar">
                                    <% serverRoles.forEach(role => { %> <option value="<%= role.id %>" <%= (config.roles?.tradeApproveRoleIds || []).includes(role.id) ? 'selected' : '' %>><%= role.name %></option> <% }) %>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-commands" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ุชุฎุตูุต ุงูุฃูุงูุฑ ูุงูุนููุจุงุช โจ๏ธ</h2>
                        <p class="text-slate-400">ุชุบููุฑ ุงุณู ุฃู ุฃูุฑ ูุชุญุฏูุฏ ุงูุฑุชุจ ุงููุณููุญ ููุง ุจุงุณุชุฎุฏุงูู ุจุญุฑูุฉ ุชุงูุฉ.</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-cyan-500">
                        
                        <h3 class="text-2xl font-bold text-red-400 mb-6">๐จ ุฃูุงูุฑ ุงูุนููุจุงุช (ุงูุฃุณุงุณูุฉ ูุงูุนูุณูุฉ)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
                            
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-red-500/30">
                                <label class="block text-[11px] text-slate-400 mb-1">ุฃูุฑ ุงูุจุงูุฏ</label>
                                <input type="text" name="cmd_banCmd" value="<%= config.commands?.banCmd || 'ban' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <label class="block text-[11px] text-emerald-400 mb-1">ุฃูุฑ ูู ุงูุจุงูุฏ</label>
                                <input type="text" name="cmd_unbanCmd" value="<%= config.commands?.unbanCmd || 'unban' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <label class="block text-xs font-bold text-slate-300 mt-2 mb-1">ุงูุฑุชุจ ุงููุณููุญุฉ:</label>
                                <select name="role_banAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.ban || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                            
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-orange-500/30">
                                <label class="block text-[11px] text-slate-400 mb-1">ุฃูุฑ ุงูุชุงูู ุฃูุช</label>
                                <input type="text" name="cmd_timeoutCmd" value="<%= config.commands?.timeoutCmd || 'timeout' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <label class="block text-[11px] text-emerald-400 mb-1">ุฃูุฑ ูู ุงูุชุงูู</label>
                                <input type="text" name="cmd_untimeoutCmd" value="<%= config.commands?.untimeoutCmd || 'untimeout' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <label class="block text-xs font-bold text-slate-300 mt-2 mb-1">ุงูุฑุชุจ ุงููุณููุญุฉ:</label>
                                <select name="role_timeoutAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.timeout || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>

                            <div class="bg-dark-900/50 p-4 rounded-xl border border-yellow-500/30">
                                <label class="block text-[11px] text-slate-400 mb-1">ุฃูุฑ ุงูุชุญุฐูุฑ</label>
                                <input type="text" name="cmd_warnCmd" value="<%= config.commands?.warnCmd || 'warn' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <label class="block text-[11px] text-emerald-400 mb-1">ุฃูุฑ ูู ุงูุชุญุฐูุฑ</label>
                                <input type="text" name="cmd_unwarnCmd" value="<%= config.commands?.unwarnCmd || 'unwarn' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <label class="block text-xs font-bold text-slate-300 mt-2 mb-1">ุงูุฑุชุจ ุงููุณููุญุฉ:</label>
                                <select name="role_warnAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.warn || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>

                            <div class="bg-dark-900/50 p-4 rounded-xl border border-slate-500/30">
                                <label class="block text-[11px] text-slate-400 mb-1">ุฃูุฑ ุงููููุช (ุงููุชุงุจู)</label>
                                <input type="text" name="cmd_muteCmd" value="<%= config.commands?.muteCmd || 'mute' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <label class="block text-[11px] text-emerald-400 mb-1">ุฃูุฑ ูู ุงููููุช</label>
                                <input type="text" name="cmd_unmuteCmd" value="<%= config.commands?.unmuteCmd || 'unmute' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <label class="block text-xs font-bold text-slate-300 mt-2 mb-1">ุงูุฑุชุจ ุงููุณููุญุฉ:</label>
                                <select name="role_muteAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.mute || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                        </div>

                        <hr class="border-dark-700 my-8">
                        <h3 class="text-2xl font-bold text-brand-light mb-6">๐๏ธ ุงูุฃูุงูุฑ ุงูุฅุฏุงุฑูุฉ ุงูุนุงูุฉ ูุงูุถุฑูุจุฉ</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-8">
                            <div class="bg-dark-900/50 p-3 rounded-xl border border-emerald-500/30">
                                <label class="block text-xs font-bold text-emerald-400 mb-1">ุงูุถุฑูุจุฉ (Tax)</label>
                                <input type="text" name="cmd_taxCmd" value="<%= config.commands?.taxCmd || 'tax' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <select name="role_taxAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.tax || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                            <div class="bg-dark-900/50 p-3 rounded-xl border border-dark-700">
                                <label class="block text-xs font-bold text-slate-300 mb-1">ูุณุญ (Clear)</label>
                                <input type="text" name="cmd_clearCmd" value="<%= config.commands?.clearCmd || 'clear' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <select name="role_clearAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.clear || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                            <div class="bg-dark-900/50 p-3 rounded-xl border border-dark-700">
                                <label class="block text-xs font-bold text-slate-300 mb-1">ุงุณุชุฏุนุงุก (Come)</label>
                                <input type="text" name="cmd_comeCmd" value="<%= config.commands?.comeCmd || 'come' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <select name="role_comeAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.come || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                            <div class="bg-dark-900/50 p-3 rounded-xl border border-blue-500/30">
                                <label class="block text-xs font-bold text-blue-400 mb-1">ุณุญุจ (Move)</label>
                                <input type="text" name="cmd_moveCmd" value="<%= config.commands?.moveCmd || 'move' %>" class="w-full bg-dark-800 rounded p-2 text-white font-mono text-sm mb-2">
                                <select name="role_moveAllowed" multiple class="w-full h-16 bg-dark-800 border border-dark-600 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.move || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                            <div class="bg-dark-900/50 p-3 rounded-xl border border-dark-700">
                                <label class="block text-[10px] text-slate-300 mb-1">ููู ุงูุฑูู (Lock/Unlock)</label>
                                <input type="text" name="cmd_lockCmd" value="<%= config.commands?.lockCmd || 'lock' %>" class="w-full bg-dark-800 rounded p-1.5 text-white font-mono text-[10px] mb-1">
                                <input type="text" name="cmd_unlockCmd" value="<%= config.commands?.unlockCmd || 'unlock' %>" class="w-full bg-dark-800 rounded p-1.5 text-white font-mono text-[10px] mb-1">
                                <select name="role_lockAllowed" multiple class="w-full h-12 bg-dark-800 border border-dark-600 rounded p-1 text-[10px] text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.lock || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                        </div>

                        <h3 class="text-xl font-bold text-amber-500 mb-4">โ๏ธ ุฃูุงูุฑ ุงููุณุงุทุฉ ุงูุนููุง (Trade, Approve, Done)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600">
                                <label class="block text-xs font-bold text-white mb-1">ุฃูุฑ Trade</label>
                                <input type="text" name="cmd_tradeCmd" value="<%= config.commands?.tradeCmd || 'trade' %>" class="w-full bg-dark-900 rounded p-2 text-white font-mono text-sm mb-2">
                                <select name="role_tradeAllowed" multiple class="w-full h-16 bg-dark-900 border border-dark-700 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.trade || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600">
                                <label class="block text-xs font-bold text-white mb-1">ุฃูุฑ Approve</label>
                                <input type="text" name="cmd_approveCmd" value="<%= config.commands?.approveCmd || 'approve' %>" class="w-full bg-dark-900 rounded p-2 text-white font-mono text-sm mb-2">
                                <select name="role_approveAllowed" multiple class="w-full h-16 bg-dark-900 border border-dark-700 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.approve || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600">
                                <label class="block text-xs font-bold text-white mb-1">ุฃูุฑ Done</label>
                                <input type="text" name="cmd_doneCmd" value="<%= config.commands?.doneCmd || 'done' %>" class="w-full bg-dark-900 rounded p-2 text-white font-mono text-sm mb-2">
                                <select name="role_doneAllowed" multiple class="w-full h-16 bg-dark-900 border border-dark-700 rounded p-1 text-xs text-white custom-scrollbar"><% serverRoles.forEach(r => { %><option value="<%= r.id %>" <%= (config.commands?.allowedRoles?.done || []).includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select>
                            </div>
                        </div>
                    </div>
                </div>

<div id="section-logs" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ุณุฌูุงุช ุงูุณูุฑูุฑ ุงูุฏูููุฉ ๐</h2>
                        <p class="text-slate-400">ุญุฏุฏ ุฑูู ูููู ุฅููุจุฏ ููู ุญุฑูุฉ (ุดุงููุฉ ุงูุนููุจุงุช ููู ุงูุนููุจุงุช).</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-teal-500">
                        
                        <h3 class="text-xl font-bold text-red-400 mb-6 flex items-center">๐ ุงูููุฌุงุช ุงูุฃูููุฉ ูุงูุฑูุฃูุชุงุช</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-red-500/30">
                                <label class="block text-xs font-bold text-red-400 mb-2">ููุฌ ุงูุชูุงุนูุงุช (ุงูุฑูุฃูุชุงุช)</label>
                                <select name="log_reactionLogId" class="w-full bg-dark-800 rounded-lg p-2 text-white text-xs mb-2"><option value="">-- ูุนุทู --</option><% textChannels.forEach(ch => { %><option value="<%= ch.id %>" <%= config.serverLogs?.reactionLogId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option><% }) %></select>
                                <input type="color" name="log_reactionColor" value="<%= config.serverLogs?.reactionColor || '#e74c3c' %>" class="w-full h-8 rounded cursor-pointer bg-dark-800 border border-dark-600 p-1">
                            </div>
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-amber-500/30">
                                <label class="block text-xs font-bold text-amber-400 mb-2">ููุฌ ุงูุฑููุงุช (ุฅูุดุงุก/ุญุฐู)</label>
                                <select name="log_channelCreateDeleteLogId" class="w-full bg-dark-800 rounded-lg p-2 text-white text-xs mb-2"><option value="">-- ูุนุทู --</option><% textChannels.forEach(ch => { %><option value="<%= ch.id %>" <%= config.serverLogs?.channelCreateDeleteLogId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option><% }) %></select>
                                <input type="color" name="log_channelColor" value="<%= config.serverLogs?.channelColor || '#1abc9c' %>" class="w-full h-8 rounded cursor-pointer bg-dark-800 border border-dark-600 p-1">
                            </div>
                            <div class="bg-dark-900/50 p-4 rounded-xl border border-brand/30">
                                <label class="block text-xs font-bold text-brand-light mb-2">ููุฌ ุงูุซุฑูุฏุงุช (Threads)</label>
                                <select name="log_threadCreateDeleteLogId" class="w-full bg-dark-800 rounded-lg p-2 text-white text-xs mb-2"><option value="">-- ูุนุทู --</option><% textChannels.forEach(ch => { %><option value="<%= ch.id %>" <%= config.serverLogs?.threadCreateDeleteLogId === ch.id ? 'selected' : '' %>>๐ฌ <%= ch.name %></option><% }) %></select>
                                <input type="color" name="log_threadColor" value="<%= config.serverLogs?.threadColor || '#34495e' %>" class="w-full h-8 rounded cursor-pointer bg-dark-800 border border-dark-600 p-1">
                            </div>
                        </div>

                        <hr class="border-dark-700 my-6">
                        
                        <h3 class="text-xl font-bold text-blue-400 mb-6 flex items-center">๐ก๏ธ ููุฌุงุช ุงูุนููุจุงุช (ุฅุนุทุงุก ููู)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600">
                                <label class="block text-[11px] text-red-500 mb-1">ููุฌ ุงูุจุงูุฏ ูุงูุทุฑุฏ</label>
                                <select name="log_banKickLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.banKickLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_banColor" value="<%= config.serverLogs?.banColor || '#992d22' %>" class="w-full h-6 rounded mb-2" title="ููู ุงูุจุงูุฏ">
                                
                                <label class="block text-[11px] text-emerald-500 mb-1 mt-2 border-t border-dark-700 pt-2">ููุฌ ูู ุงูุจุงูุฏ (Unban)</label>
                                <select name="log_unbanLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.unbanLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_unbanColor" value="<%= config.serverLogs?.unbanColor || '#2ecc71' %>" class="w-full h-6 rounded" title="ููู ูู ุงูุจุงูุฏ">
                            </div>

                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600">
                                <label class="block text-[11px] text-orange-500 mb-1">ููุฌ ุงูุชุงูู ุฃูุช (Timeout)</label>
                                <select name="log_timeoutLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.timeoutLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_timeoutColor" value="<%= config.serverLogs?.timeoutColor || '#e67e22' %>" class="w-full h-6 rounded mb-2" title="ููู ุงูุชุงูู">
                                
                                <label class="block text-[11px] text-emerald-500 mb-1 mt-2 border-t border-dark-700 pt-2">ููุฌ ูู ุงูุชุงูู (Untimeout)</label>
                                <select name="log_untimeoutLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.untimeoutLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_untimeoutColor" value="<%= config.serverLogs?.untimeoutColor || '#2ecc71' %>" class="w-full h-6 rounded" title="ููู ูู ุงูุชุงูู">
                            </div>

                            <div class="bg-dark-800 p-4 rounded-xl border border-dark-600">
                                <label class="block text-[11px] text-yellow-400 mb-1">ููุฌ ุงูุชุญุฐูุฑุงุช (Warn)</label>
                                <select name="log_warningsLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.warningsLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_warnColor" value="<%= config.serverLogs?.warnColor || '#f1c40f' %>" class="w-full h-6 rounded mb-2" title="ููู ุงูุชุญุฐูุฑ">
                                
                                <label class="block text-[11px] text-emerald-500 mb-1 mt-2 border-t border-dark-700 pt-2">ููุฌ ูู ุงูุชุญุฐูุฑ (Unwarn)</label>
                                <select name="log_unwarningsLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.unwarningsLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select>
                                <input type="color" name="log_unwarnColor" value="<%= config.serverLogs?.unwarnColor || '#2ecc71' %>" class="w-full h-6 rounded" title="ููู ูู ุงูุชุญุฐูุฑ">
                            </div>
                        </div>

                        <hr class="border-dark-700 my-6">

                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                            <div class="bg-dark-800 p-3 rounded-lg border border-dark-600"><label class="text-[10px] text-slate-400 block mb-1">ุญุฐู ุงูุฑุณุงุฆู</label><select name="log_messageDeleteLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.messageDeleteLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select><input type="color" name="log_msgDelColor" value="<%= config.serverLogs?.msgDelColor || '#ed4245' %>" class="w-full h-6 rounded"></div>
                            <div class="bg-dark-800 p-3 rounded-lg border border-dark-600"><label class="text-[10px] text-slate-400 block mb-1">ุชุนุฏูู ุงูุฑุณุงุฆู</label><select name="log_messageEditLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.messageEditLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select><input type="color" name="log_msgEditColor" value="<%= config.serverLogs?.msgEditColor || '#fee75c' %>" class="w-full h-6 rounded"></div>
                            <div class="bg-dark-800 p-3 rounded-lg border border-dark-600"><label class="text-[10px] text-amber-500 block mb-1">ุญุฐู ุตูุฑ ููุท</label><select name="log_imageDeleteLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.imageDeleteLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select><input type="color" name="log_imgDelColor" value="<%= config.serverLogs?.imgDelColor || '#e67e22' %>" class="w-full h-6 rounded"></div>
                            <div class="bg-dark-800 p-3 rounded-lg border border-dark-600"><label class="text-[10px] text-slate-400 block mb-1">ุฅุนุทุงุก/ุณุญุจ ุฑุชุจ</label><select name="log_roleGiveTakeLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.roleGiveTakeLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select><input type="color" name="log_roleColor" value="<%= config.serverLogs?.roleColor || '#9b59b6' %>" class="w-full h-6 rounded"></div>
                            <div class="bg-dark-800 p-3 rounded-lg border border-dark-600"><label class="text-[10px] text-slate-400 block mb-1">ุฏุฎูู/ุฎุฑูุฌ</label><select name="log_memberJoinLeaveLogId" class="w-full bg-dark-900 text-xs text-white rounded p-1 mb-1"><option value="">- ูุนุทู -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.serverLogs?.memberJoinLeaveLogId===c.id?'selected':''}>${c.name}</option>`).join('') %></select><div class="flex space-x-1 space-x-reverse"><input type="color" name="log_joinColor" value="<%= config.serverLogs?.joinColor || '#3ba55d' %>" class="w-1/2 h-6 rounded"><input type="color" name="log_leaveColor" value="<%= config.serverLogs?.leaveColor || '#ed4245' %>" class="w-1/2 h-6 rounded"></div></div>
                        </div>
                    </div>
                </div>

                <div id="section-warnings" class="settings-section max-w-5xl mx-auto">
                    <div class="mb-8 border-b border-dark-700 pb-4">
                        <h2 class="text-4xl font-black text-white mb-2">ุงูุชุญุฐูุฑุงุช ูุจุงูู ุงูุฅุฏุงุฑุฉ โ๏ธ</h2>
                        <p class="text-slate-400">ุจุงูู ุชุญูู ุงูุฅุฏุงุฑุฉุ ูุฃุณุจุงุจ ุงูุชุญุฐูุฑุงุช ุงูุฏููุงููููุฉ.</p>
                    </div>

                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-orange-500">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุฃูุตู ุนุฏุฏ ููุชุญุฐูุฑุงุช</label>
                                <input type="number" name="warn_maxWarnings" value="<%= config.warnings?.maxWarnings || 3 %>" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3 px-4 text-white text-center font-bold text-2xl">
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-300 mb-2">ุงูุนููุจุฉ ุงูุชููุงุฆูุฉ (ุจุนุฏ ุจููุบ ุงูุญุฏ)</label>
                                <select name="warn_autoAction" class="w-full bg-dark-900 border border-dark-700 rounded-xl py-3.5 px-4 text-white font-bold cursor-pointer">
                                    <option value="none" <%= config.warnings?.autoAction === 'none' ? 'selected' : '' %>>โ ูุนุทู (ุจุฏูู ุนููุจุฉ ุชููุงุฆูุฉ)</option>
                                    <option value="timeout" <%= config.warnings?.autoAction === 'timeout' ? 'selected' : '' %>>โณ ุฅุณูุงุช (Timeout)</option>
                                    <option value="kick" <%= config.warnings?.autoAction === 'kick' ? 'selected' : '' %>>๐ข ุทุฑุฏ (Kick)</option>
                                    <option value="ban" <%= config.warnings?.autoAction === 'ban' ? 'selected' : '' %>>๐จ ุญุธุฑ (Ban)</option>
                                </select>
                            </div>
                        </div>

                        <div class="bg-dark-900/80 p-6 rounded-2xl border border-red-500/30 mb-8 shadow-inner">
                            <h3 class="text-xl font-bold text-red-400 mb-4 flex items-center">๐ด ุจุงูู ุชุญูู ุงูุชุญุฐูุฑุงุช (ููุฑุณู ููุฅุฏุงุฑุฉ)</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-4">
                                <div><label class="text-xs text-slate-400 block mb-1">ุฑูู ุฅุฑุณุงู ุงูุจุงูู</label><select name="warn_panelChannelId" class="w-full bg-dark-800 border border-dark-600 rounded p-2 text-white text-sm"><option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.warnings?.panelChannelId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select></div>
                                <div><label class="text-xs text-slate-400 block mb-1">ููู ุงูุจุงูู</label><input type="color" name="warn_panelColor" value="<%= config.warnings?.panelColor || '#ed4245' %>" class="w-full h-10 rounded cursor-pointer bg-dark-800 border border-dark-600 p-1"></div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div><label class="text-xs text-slate-400 block mb-1">ุนููุงู ุงูุจุงูู</label><input type="text" name="warn_panelTitle" value="<%= config.warnings?.panelTitle || 'ููุญุฉ ุชุญูู ุงูุชุญุฐูุฑ' %>" class="w-full bg-dark-800 border border-dark-600 rounded p-2 text-white font-bold"></div>
                                <div><label class="text-xs text-slate-400 block mb-1">ูุตู ุงูุจุงูู</label><input type="text" name="warn_panelDescription" value="<%= config.warnings?.panelDescription || 'ุงุณุชุฎุฏู ุงูุฃุฒุฑุงุฑ ุฃุฏูุงู ูุฅุฏุงุฑุฉ ุชุญุฐูุฑุงุช ุงูุฃุนุถุงุก.' %>" class="w-full bg-dark-800 border border-dark-600 rounded p-2 text-white"></div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700">
                                <h4 class="text-brand-light font-bold mb-4 flex justify-between items-center"><span>ุงูุฃุณุจุงุจ (ุนุฑุจู) ๐ธ๐ฆ</span> <button type="button" onclick="addWarnReason('ar')" class="px-3 py-1 bg-brand hover:bg-brand-light text-xs text-white font-bold rounded">โ ุฅุถุงูุฉ ุณุจุจ</button></h4>
                                <input type="hidden" name="warn_presetReasonsAr" id="hidden_warn_ar">
                                <div id="warn-ar-container" class="space-y-2 mb-4 max-h-48 overflow-y-auto custom-scrollbar pr-2"></div>
                            </div>
                            <div class="bg-dark-900/50 p-5 rounded-2xl border border-dark-700" dir="ltr">
                                <h4 class="text-brand-light font-bold mb-4 flex justify-between items-center"><span>Reasons (En) ๐บ๐ธ</span> <button type="button" onclick="addWarnReason('en')" class="px-3 py-1 bg-brand hover:bg-brand-light text-xs text-white font-bold rounded">โ Add Reason</button></h4>
                                <input type="hidden" name="warn_presetReasonsEn" id="hidden_warn_en">
                                <div id="warn-en-container" class="space-y-2 mb-4 max-h-48 overflow-y-auto custom-scrollbar pl-2"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-protection" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-3xl font-black text-white mb-6">ุงูุญูุงูุฉ ูุงูู Anti-Nuke ๐ก๏ธ</h2>
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-red-600">
                        <div class="flex justify-between items-center bg-dark-900/50 p-4 rounded-xl mb-4"><span class="font-bold">ููุน ุงูุฑูุงุจุท (Anti-Link)</span><label class="switch"><input type="checkbox" name="prot_antiLinkEnabled" <%= config.protection?.antiLinkEnabled ? 'checked' : '' %>><span class="slider"></span></label></div>
                        <div class="flex justify-between items-center bg-dark-900/50 p-4 rounded-xl mb-4"><span class="font-bold">ููุน ุงูุณุจุงู (Anti-Spam)</span><label class="switch"><input type="checkbox" name="prot_antiSpamEnabled" <%= config.protection?.antiSpamEnabled ? 'checked' : '' %>><span class="slider"></span></label></div>
                        <div class="flex justify-between items-center bg-red-900/20 border border-red-500/30 p-4 rounded-xl"><span class="font-bold text-red-400">ููุงูุญุฉ ุชุฎุฑูุจ ุงูุณูุฑูุฑ (Anti-Nuke)</span><label class="switch"><input type="checkbox" name="prot_antiNukeEnabled" <%= config.protection?.antiNukeEnabled ? 'checked' : '' %>><span class="slider"></span></label></div>
                    </div>
                </div>

                <div id="section-welcome" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-3xl font-black text-white mb-6">ุงูุชุฑุญูุจ ูุงููุบุงุฏุฑุฉ ๐</h2>
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-pink-500">
                        <div class="flex justify-between items-center mb-6"><span class="font-bold text-xl">ุชูุนูู ูุธุงู ุงูุชุฑุญูุจ ุจุงูุตูุฑ</span><label class="switch"><input type="checkbox" name="wel_enabled" <%= config.welcomeSystem?.enabled ? 'checked' : '' %>><span class="slider"></span></label></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                            <select name="wel_channelId" class="w-full bg-dark-900 rounded-xl p-3 text-white"><option value="">- ุฑูู ุงูุชุฑุญูุจ -</option><%- textChannels.map(c=>`<option value="${c.id}" ${config.welcomeSystem?.channelId===c.id?'selected':''}>๐ฌ ${c.name}</option>`).join('') %></select>
                            <input type="text" name="wel_backgroundUrl" value="<%= config.welcomeSystem?.backgroundUrl || '' %>" placeholder="ุฑุงุจุท ุตูุฑุฉ ุงูุฎูููุฉ (ูููุถู 1024x300)" dir="ltr" class="w-full bg-dark-900 rounded-xl p-3 text-white text-left font-mono">
                        </div>
                        <div class="flex items-center space-x-4 space-x-reverse bg-dark-900/50 p-4 rounded-xl border border-dark-700">
                            <label class="text-xs font-bold text-slate-400">ููู ุฅุทุงุฑ ุงูุตูุฑุฉ (Avatar Border):</label>
                            <input type="color" name="wel_avatarBorderHex" value="<%= config.welcomeSystem?.avatarBorderHex || '#ffffff' %>" class="w-12 h-12 rounded-xl bg-dark-900 p-1 cursor-pointer">
                            <label class="text-xs font-bold text-slate-400 mr-6">ููู ุงููุต (Message Text):</label>
                            <input type="color" name="wel_textColorHex" value="<%= config.welcomeSystem?.textColorHex || '#ffffff' %>" class="w-12 h-12 rounded-xl bg-dark-900 p-1 cursor-pointer">
                        </div>
                    </div>
                </div>

                <div id="section-economy" class="settings-section max-w-5xl mx-auto">
                    <h2 class="text-3xl font-black text-white mb-6">ุงูุงูุชุตุงุฏ ูุงูุถุฑูุจุฉ ๐ฐ</h2>
                    <div class="glass-card rounded-3xl p-8 mb-8 border-t-4 border-t-green-500">
                        <div class="flex justify-between items-center bg-dark-900/50 p-4 rounded-xl mb-6"><span class="font-bold text-emerald-400">ุชูุนูู ุงูุงูุชุตุงุฏ ูุงูุถุฑูุจุฉ</span><label class="switch"><input type="checkbox" name="eco_enabled" <%= config.economy?.enabled !== false ? 'checked' : '' %>><span class="slider"></span></label></div>
                        <div class="bg-dark-900/50 p-4 rounded-xl border border-dark-700 w-1/2 mb-8">
                            <label class="block text-xs font-bold text-slate-400 mb-2">ูุณุจุฉ ุถุฑูุจุฉ ุฃูุฑ (Tax) ุงููุฆููุฉ %</label>
                            <input type="number" name="eco_taxPercentage" value="<%= config.economy?.taxPercentage || 5 %>" class="w-full bg-dark-800 rounded p-3 text-white font-bold text-center text-xl">
                            <p class="text-[10px] text-slate-500 mt-2 text-center">ูุซุงู: ูู 5ุ ุจูุช ุงูุจุฑูุจูุช ุจูุงุฎุฏ 5% ุถุฑูุจุฉ ุชุญููู.</p>
                        </div>
                    </div>
                </div>

            </form>
        </div>
    </main>

    <script>
        // 1. ูุธุงู ุงูุชููู
        function switchSection(target) {
            document.querySelectorAll('.settings-section').forEach(s => s.classList.remove('active'));
            document.getElementById('section-' + target).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b => { b.classList.remove('bg-brand','text-white'); b.classList.add('text-slate-400'); });
            const activeBtn = document.querySelector(`[data-target="${target}"]`);
            if(activeBtn) { activeBtn.classList.add('bg-brand','text-white'); activeBtn.classList.remove('text-slate-400'); }
        }

        // 2. ุฐูุงุก ุฒุฑุงูุฑ ุงูุชูุช (ููุน ุงูุชุนุงุฑุถ)
        const hideBtn = document.getElementById('tc_hideTicketOnClaim');
        const readBtn = document.getElementById('tc_readOnlyStaffOnClaim');
        if (hideBtn && readBtn) {
            function syncTicketToggles() {
                if (hideBtn.checked) { readBtn.checked = false; document.getElementById('read_claim_container').style.opacity = '0.4'; readBtn.disabled = true; }
                else { document.getElementById('read_claim_container').style.opacity = '1'; readBtn.disabled = false; }
                if (readBtn.checked) { hideBtn.checked = false; document.getElementById('hide_claim_container').style.opacity = '0.4'; hideBtn.disabled = true; }
                else if (!readBtn.checked && !hideBtn.checked) { document.getElementById('hide_claim_container').style.opacity = '1'; hideBtn.disabled = false; }
            }
            hideBtn.addEventListener('change', syncTicketToggles);
            readBtn.addEventListener('change', syncTicketToggles);
            syncTicketToggles();
        }

        // 3. ุตุงูุน ุงูุฅููุจุฏ ุงูููุฑู
        async function sendLiveEmbed(guildId) {
            const ch = document.getElementById('live_embed_channel').value;
            const t = document.getElementById('live_embed_title').value;
            const d = document.getElementById('live_embed_desc').value;
            const c = document.getElementById('live_embed_color').value;
            const i = document.getElementById('live_embed_image').value;
            const st = document.getElementById('live_embed_status');
            if(!ch || (!t&&!d)){ st.className='mb-6 p-4 rounded-xl bg-red-500/20 text-red-400 border border-red-500'; st.innerText='โ ูุฑุฌู ุงุฎุชูุงุฑ ุงูุฑูู ููุชุงุจุฉ ูุญุชูู ุงูุฅููุจุฏ.'; st.classList.remove('hidden'); return; }
            st.className='mb-6 p-4 rounded-xl bg-blue-500/20 text-blue-400 border border-blue-500'; st.innerText='โณ ุฌุงุฑู ุงูุฅุฑุณุงู ููุฏูุณููุฑุฏ...'; st.classList.remove('hidden');
            try {
                const res = await fetch(`/api/send-embed/${guildId}`, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({channelId:ch, title:t, description:d, color:c, imageUrl:i}) });
                const data = await res.json();
                if(data.success) { st.className='mb-6 p-4 rounded-xl bg-emerald-500/20 text-emerald-400 border border-emerald-500'; st.innerText='โ ุชู ุงูุฅุฑุณุงู ุจูุฌุงุญ!'; document.getElementById('live_embed_title').value=''; document.getElementById('live_embed_desc').value=''; }
                else { st.className='mb-6 p-4 rounded-xl bg-red-500/20 text-red-400 border border-red-500'; st.innerText=data.error; }
            } catch(e){ st.className='mb-6 p-4 rounded-xl bg-red-500/20 text-red-400 border border-red-500'; st.innerText='โ ุญุฏุซ ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุจูุช.'; }
        }

        // ==========================================================
        // ๐งฑ ุงููุญุฑูุงุช ุงูุฏููุงููููุฉ (Dynamic Engines)
        // ==========================================================
        let panelsArray = JSON.parse(document.getElementById('ticketPanelsData').value || '[]');
        let mmFields = JSON.parse(document.getElementById('mm_modalFieldsData').value || '[]');
        
        let warnAr = <%- JSON.stringify(config.warnings?.presetReasonsAr || ['ุณุจ ูุดุชู']) %>;
        let warnEn = <%- JSON.stringify(config.warnings?.presetReasonsEn || ['Swearing']) %>;

        // --- ูุญุฑู ุงูุชุญุฐูุฑุงุช ---
        function renderWarns(lang) {
            const arr = lang === 'ar' ? warnAr : warnEn;
            const container = document.getElementById(`warn-${lang}-container`);
            container.innerHTML = '';
            arr.forEach((w, i) => {
                container.innerHTML += `
                    <div class="flex items-center space-x-2 space-x-reverse bg-dark-800 p-2 rounded-lg border border-dark-600 mb-2">
                        <input type="text" class="flex-1 bg-transparent text-white text-sm outline-none font-bold ${lang==='en'?'text-left':''}" dir="${lang==='en'?'ltr':'rtl'}" value="${w}" onchange="${lang==='ar'?'warnAr':'warnEn'}[${i}]=this.value">
                        <button type="button" onclick="${lang==='ar'?'warnAr':'warnEn'}.splice(${i},1); renderWarns('${lang}');" class="text-red-500 bg-red-500/20 hover:bg-red-500 hover:text-white px-3 py-1.5 rounded-lg text-xs font-bold transition">ุญุฐู ๐๏ธ</button>
                    </div>`;
            });
        }
        function addWarnReason(lang) { if(lang==='ar') warnAr.push('ุณุจุจ ุฌุฏูุฏ'); else warnEn.push('New Reason'); renderWarns(lang); }

        // --- ูุญุฑู ููุงูุฐ ุงููุณุงุทุฉ ---
        function renderMmFields() {
            const c = document.getElementById('mm-fields-ui-container'); c.innerHTML = '';
            mmFields.forEach((f, i) => {
                c.innerHTML += `<div class="bg-dark-800 p-5 rounded-xl border border-dark-600 mb-3 relative">
                    <div class="absolute top-0 right-0 bg-dark-700 text-[10px] px-2 rounded-bl-lg text-slate-400">ุณุคุงู ${i+1}</div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                        <div><label class="text-xs text-slate-400 mb-1 block">ุงูุณุคุงู</label><input type="text" class="w-full bg-dark-900 rounded-lg p-2.5 text-white text-sm font-bold" value="${f.label||''}" onchange="mmFields[${i}].label=this.value"></div>
                        <div><label class="text-xs text-slate-400 mb-1 block">ูุซุงู ุฅุฑุดุงุฏู</label><input type="text" class="w-full bg-dark-900 rounded-lg p-2.5 text-white text-sm" value="${f.placeholder||''}" onchange="mmFields[${i}].placeholder=this.value"></div>
                    </div>
                    <div class="flex justify-between items-center mt-3 pt-3 border-t border-dark-700">
                        <div class="flex space-x-4 space-x-reverse text-xs font-bold text-brand-light">
                            <label><input type="radio" name="mm_s_${i}" value="Short" ${f.style!=='Paragraph'?'checked':''} onchange="mmFields[${i}].style=this.value"> ุฅุฌุงุจุฉ ูุตูุฑุฉ</label>
                            <label><input type="radio" name="mm_s_${i}" value="Paragraph" ${f.style==='Paragraph'?'checked':''} onchange="mmFields[${i}].style=this.value"> ุฅุฌุงุจุฉ ุทูููุฉ (Paragraph)</label>
                        </div>
                        <button type="button" onclick="mmFields.splice(${i},1); renderMmFields();" class="text-xs bg-red-600/80 hover:bg-red-500 text-white px-3 py-1.5 rounded-lg transition">ุญุฐู ุงูุณุคุงู ๐๏ธ</button>
                    </div>
                </div>`;
            });
        }
        function addMmFieldUI() { mmFields.push({label:'ุณุคุงู ุฌุฏูุฏ', placeholder:'ุงูุชุจ ููุง...', style:'Short'}); renderMmFields(); }

        // --- ูุญุฑู ุงูุจุงููุงุช ุงููุชุนุฏุฏุฉ ุงูุนููุงู ---
        const catsHTML = `<%- categories.map(cat=>`<option value="${cat.id}">${cat.name}</option>`).join('') %>`;
        const chsHTML = `<%- textChannels.map(ch=>`<option value="${ch.id}">${ch.name}</option>`).join('') %>`;
        
        function renderAllPanels() {
            const c = document.getElementById('dynamic-panels-container'); c.innerHTML = '';
            if(panelsArray.length === 0) { c.innerHTML = `<div class="text-center p-10 bg-dark-900/50 rounded-2xl border border-dashed border-dark-700 text-slate-500">ูุง ููุฌุฏ ุจุงููุงุช ุญุงููุงู. ุงุถุบุท ูุฅุถุงูุฉ ุจุงูู.</div>`; return; }

            panelsArray.forEach((p, pIdx) => {
                let btns = '';
                (p.buttons||[]).forEach((b, bIdx) => {
                    let mHTML = '';
                    if(b.requireModal) {
                        mHTML += `<div class="mt-4 p-4 bg-dark-900/80 rounded-xl border border-dark-700">
                            <div class="flex justify-between items-center mb-3"><span class="text-sm font-bold text-brand-light">๐ ุฃุณุฆูุฉ ุงููุงูุฐุฉ (ุงูุฅุฌุงุจุงุช ุณุชุนุฑุถ ูู Code Blocks)</span><button type="button" onclick="if(!panelsArray[${pIdx}].buttons[${bIdx}].modalFields) panelsArray[${pIdx}].buttons[${bIdx}].modalFields=[]; panelsArray[${pIdx}].buttons[${bIdx}].modalFields.push({label:'',placeholder:'',style:'Short'}); renderAllPanels();" class="text-xs bg-brand hover:bg-brand-light text-white px-3 py-1.5 rounded-lg font-bold">โ ุฅุถุงูุฉ ุณุคุงู</button></div>`;
                        (b.modalFields||[]).forEach((mf, mIdx) => {
                            mHTML += `<div class="flex space-x-2 space-x-reverse mb-2"><input type="text" class="w-1/2 bg-dark-800 border border-dark-600 text-xs text-white rounded-lg p-2 font-bold" placeholder="ุงูุณุคุงู" value="${mf.label}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].modalFields[${mIdx}].label=this.value"><input type="text" class="flex-1 bg-dark-800 border border-dark-600 text-xs text-white rounded-lg p-2" placeholder="ูุซุงู ููุนููู" value="${mf.placeholder}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].modalFields[${mIdx}].placeholder=this.value"><select class="bg-dark-800 text-xs text-white rounded-lg p-2" onchange="panelsArray[${pIdx}].buttons[${bIdx}].modalFields[${mIdx}].style=this.value"><option value="Short" ${mf.style!=='Paragraph'?'selected':''}>ูุตูุฑ</option><option value="Paragraph" ${mf.style==='Paragraph'?'selected':''}>ุทููู</option></select><button type="button" onclick="panelsArray[${pIdx}].buttons[${bIdx}].modalFields.splice(${mIdx},1); renderAllPanels();" class="bg-red-500 text-white px-3 rounded-lg font-bold">X</button></div>`;
                        });
                        mHTML += `</div>`;
                    }

                    btns += `<div class="bg-dark-800 p-5 rounded-2xl border border-dark-600 mb-4 relative shadow-inner">
                        <button type="button" onclick="panelsArray[${pIdx}].buttons.splice(${bIdx},1); renderAllPanels();" class="absolute top-3 left-3 text-red-400 bg-red-500/10 hover:bg-red-500 hover:text-white px-3 py-1 rounded-lg text-xs font-bold transition">ุญุฐู ุงูุฒุฑ ๐๏ธ</button>
                        <h5 class="text-sm font-bold text-white mb-4 border-b border-dark-700 pb-2">๐ ุฅุนุฏุงุฏุงุช ุงูุฒุฑ ${bIdx+1}</h5>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div><label class="text-[11px] font-bold text-slate-400 block mb-1">ุงุณู ุงูุฒุฑ</label><input type="text" class="w-full bg-dark-900 border border-dark-700 text-sm text-white font-bold rounded-xl p-2.5" value="${b.label}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].label=this.value"></div>
                            <div><label class="text-[11px] font-bold text-slate-400 block mb-1">ููู ุงูุฒุฑ (Discord Style)</label><select class="w-full bg-dark-900 border border-dark-700 text-sm font-bold text-white rounded-xl p-2.5" onchange="panelsArray[${pIdx}].buttons[${bIdx}].buttonStyle=this.value"><option value="Primary" ${b.buttonStyle==='Primary'?'selected':''}>ุฃุฒุฑู (Primary)</option><option value="Success" ${b.buttonStyle==='Success'?'selected':''}>ุฃุฎุถุฑ (Success)</option><option value="Danger" ${b.buttonStyle==='Danger'?'selected':''}>ุฃุญูุฑ (Danger)</option><option value="Secondary" ${b.buttonStyle==='Secondary'?'selected':''}>ุฑูุงุฏู (Secondary)</option></select></div>
                        </div>
                        <div class="flex space-x-6 space-x-reverse text-sm font-bold bg-dark-900/50 p-3 rounded-xl border border-dark-700 mb-4">
                            <label class="text-amber-400 flex items-center cursor-pointer"><input type="checkbox" ${b.isMiddleman?'checked':''} onchange="panelsArray[${pIdx}].buttons[${bIdx}].isMiddleman=this.checked" class="mr-2 ml-2 w-4 h-4"> ๐ค ุฒุฑ ูุณุงุทุฉ</label>
                            <label class="text-emerald-400 flex items-center cursor-pointer"><input type="checkbox" ${b.requireModal?'checked':''} onchange="panelsArray[${pIdx}].buttons[${bIdx}].requireModal=this.checked; if(this.checked && !panelsArray[${pIdx}].buttons[${bIdx}].modalFields) panelsArray[${pIdx}].buttons[${bIdx}].modalFields=[]; renderAllPanels();" class="mr-2 ml-2 w-4 h-4"> ๐ ุชูุนูู ูุงูุฐุฉ (Modal)</label>
                        </div>
                        <h6 class="text-xs font-bold text-slate-300 mb-2 mt-4 border-t border-dark-700 pt-3">๐จ ุฅููุจุฏ ุงูุฅุฌุงุจุงุช ุงูุฏุงุฎูู ููุชุฐูุฑุฉ:</h6>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div><label class="text-[10px] text-slate-400 block mb-1">ูุตู ุงูุฅููุจุฏ ุงูุฏุงุฎูู</label><input type="text" class="w-full bg-dark-900 border border-dark-700 text-xs text-white rounded-lg p-2" placeholder="ุฃููุงู ุจู ูู ุงูุชุฐูุฑุฉ..." value="${b.insideEmbedDesc||''}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].insideEmbedDesc=this.value"></div>
                            <div>
                                <label class="text-[10px] font-bold text-amber-400 block mb-1">ููู ุฅููุจุฏ ุงูุฅุฌุงุจุงุช ุงููุฎุตุต ููุฒุฑ</label>
                                <div class="flex space-x-2 space-x-reverse"><input type="color" class="w-10 h-8 bg-dark-900 rounded p-0.5 cursor-pointer border border-dark-700" value="${b.modalAnswersEmbedColor || '#2b2d31'}" onchange="panelsArray[${pIdx}].buttons[${bIdx}].modalAnswersEmbedColor=this.value"><input type="text" class="flex-1 bg-dark-900 text-xs font-mono uppercase text-center rounded-lg border border-dark-700" value="${b.modalAnswersEmbedColor || '#2b2d31'}" readonly></div>
                            </div>
                        </div>
                        ${mHTML}
                    </div>`;
                });

                c.innerHTML += `<div class="bg-dark-900/80 border-2 border-blue-500/30 rounded-3xl p-8 relative shadow-2xl">
                    <button type="button" onclick="panelsArray.splice(${pIdx},1); renderAllPanels();" class="absolute top-6 left-6 bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded-xl text-sm font-bold shadow-lg transition">ุญุฐู ุงูุจุงูู ุจุงููุงูู ๐๏ธ</button>
                    
                    <div class="flex items-center space-x-4 space-x-reverse mb-6">
                        <input type="color" class="w-12 h-12 rounded-xl bg-dark-800 p-1 cursor-pointer border border-dark-600 shadow-inner" value="${p.panelColor||'#5865F2'}" onchange="panelsArray[${pIdx}].panelColor=this.value" title="ููู ุงูุจุงูู ุงูุฎุงุฑุฌู">
                        <input type="text" class="bg-transparent text-2xl font-black text-white border-b-2 border-dark-600 pb-1 focus:border-brand outline-none w-1/2" placeholder="ุนููุงู ุงูุจุงูู (ูุซุงู: ุงูุฏุนู ุงูููู)" value="${p.panelTitle}" onchange="panelsArray[${pIdx}].panelTitle=this.value">
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="bg-dark-800 p-4 rounded-xl border border-dark-600"><label class="text-xs font-bold text-slate-400 block mb-2">ุฑูู ุฅุฑุณุงู ุงูุจุงูู</label><select class="w-full bg-dark-900 text-white font-bold text-sm rounded-lg p-3 cursor-pointer outline-none" onchange="panelsArray[${pIdx}].channelId=this.value"><option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option>${chsHTML.replace(`value="${p.channelId}"`,`value="${p.channelId}" selected`)}</select></div>
                        <div class="bg-dark-800 p-4 rounded-xl border border-dark-600"><label class="text-xs font-bold text-slate-400 block mb-2">ูุณู ูุชุญ ุงูุชุฐุงูุฑ (Category)</label><select class="w-full bg-dark-900 text-white font-bold text-sm rounded-lg p-3 cursor-pointer outline-none" onchange="panelsArray[${pIdx}].categoryId=this.value"><option value="">-- ุงุฎุชุฑ ุงููุณู --</option>${catsHTML.replace(`value="${p.categoryId}"`,`value="${p.categoryId}" selected`)}</select></div>
                        <div class="md:col-span-2 bg-dark-800 p-4 rounded-xl border border-dark-600"><label class="text-xs font-bold text-slate-400 block mb-2">ูุตู ุงูุจุงูู ุงูุฎุงุฑุฌู</label><textarea class="w-full bg-dark-900 text-white text-sm rounded-lg p-3 outline-none resize-y" rows="2" onchange="panelsArray[${pIdx}].panelDescription=this.value">${p.panelDescription||''}</textarea></div>
                    </div>

                    <div class="p-6 bg-dark-900/50 rounded-2xl border border-dark-700 shadow-inner">
                        <h4 class="text-lg font-bold text-brand-light mb-4">๐ ุฃุฒุฑุงุฑ ุงูุจุงูู ูููุงูุฐูุง</h4>
                        ${btns}
                        <button type="button" onclick="panelsArray[${pIdx}].buttons.push({id:'btn_'+Math.random().toString(36).substr(2,7),label:'ุฒุฑ ุฌุฏูุฏ',buttonStyle:'Primary',requireModal:false,modalAnswersEmbedColor:'#2b2d31'}); renderAllPanels();" class="w-full mt-4 py-4 border-2 border-dashed border-brand/50 bg-brand/5 hover:bg-brand/20 rounded-xl text-brand-light font-bold text-sm transition-all shadow-sm">โ ุฅุถุงูุฉ ุฒุฑ ุฌุฏูุฏ ููุฐุง ุงูุจุงูู</button>
                    </div>
                </div>`;
            });
        }
        function addNewPanelUI() { panelsArray.push({panelId:'pnl_'+Math.random().toString(36).substr(2,7), panelTitle:'ุจุงูู ุฌุฏูุฏ', panelColor:'#5865F2', buttons:[]}); renderAllPanels(); }

        // ==========================================================
        // ๐ ุฏุงูุฉ ุงูุญูุธ ุงูุณุญุฑูุฉ (ุชุฌูุน ูู ุงูุฏุงุชุง ูุจู ุงูุฅุฑุณุงู ูููุน ุงููุณุญ) 
        // ==========================================================
        function syncAllDataBeforeSave() {
            // ููู ุงูุจูุงูุงุช ูู ุงููุญุฑูุงุช ุฅูู ุงูุญููู ุงููุฎููุฉ ูุจู ุงูู Submit ุจูุณุฑ ูู ุงูุซุงููุฉ
            document.getElementById('hidden_warn_ar').value = warnAr.join('\n');
            document.getElementById('hidden_warn_en').value = warnEn.join('\n');
            document.getElementById('mm_modalFieldsData').value = JSON.stringify(mmFields);
            document.getElementById('ticketPanelsData').value = JSON.stringify(panelsArray);
            
            // ุชุญููู ุงูุฒุฑุงุฑ ูุชุฃููุฏ ุงูุฅุฑุณุงู ูุงูุฃูููุดู
            const saveBtn = document.querySelector('button[type="submit"]');
            saveBtn.innerHTML = '<span class="mr-3 ml-2 text-3xl animate-spin">โณ</span> ุฌุงุฑู ุงูุญูุธ ูุชุญุฏูุซ ุงูุฏูุณููุฑุฏ...';
            saveBtn.classList.replace('bg-emerald-500', 'bg-emerald-700');
            saveBtn.classList.remove('hover:bg-emerald-400', 'hover:-translate-y-2');
            
            return true; 
        }

        // --- ูุญุฑู ุงูุชุฑุฌูุฉ ุงูุฏููุงูููู ููุฏุงุดุจูุฑุฏ ---
        const systemLang = document.querySelector('select[name="language"]');
        function applyDashboardLanguage() {
            if(systemLang.value === 'en') {
                document.documentElement.setAttribute('dir', 'ltr');
                document.documentElement.setAttribute('lang', 'en');
                document.body.style.fontFamily = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
            } else {
                document.documentElement.setAttribute('dir', 'rtl');
                document.documentElement.setAttribute('lang', 'ar');
                document.body.style.fontFamily = "'Tajawal', sans-serif";
            }
        }
        if(systemLang) {
            systemLang.addEventListener('change', applyDashboardLanguage);
            applyDashboardLanguage();
        }

        // ุชุดุบูู ุงูุฑูุฏุฑ ุฃูู ูุง ุงูุตูุญุฉ ุชูุชุญ
        window.onload = () => { 
            renderWarns('ar'); 
            renderWarns('en'); 
            renderMmFields(); 
            renderAllPanels(); 
        };
    </script>
</body>
</html>
