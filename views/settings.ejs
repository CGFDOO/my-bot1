<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฅุนุฏุงุฏุงุช MNC | ุงูุฅูุจุฑุงุทูุฑูุฉ</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #121212; color: #ffffff; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        .mobile-header { display: none; background-color: #1e1e24; padding: 15px 20px; align-items: center; justify-content: space-between; border-bottom: 2px solid #5865F2; }
        .menu-btn { background: #5865F2; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
        .sidebar { width: 280px; background-color: #1e1e24; padding: 20px; display: flex; flex-direction: column; gap: 10px; overflow-y: auto; z-index: 1000; border-left: 1px solid #333; }
        .sidebar h2 { color: #5865F2; font-size: 22px; text-align: center; margin-bottom: 15px; }
        .tab-btn { background: #2b2b36; color: white; border: none; padding: 15px; text-align: right; font-size: 16px; border-radius: 8px; cursor: pointer; transition: 0.3s; font-family: 'Tajawal', sans-serif; }
        .tab-btn:hover { background: #3b3b4f; }
        .tab-btn.active { background: #5865F2; font-weight: bold; }
        .content { flex: 1; padding: 30px; overflow-y: auto; background-color: #18181b; }
        .tab-content { display: none; background: #23232a; padding: 25px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); animation: fadeIn 0.4s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: #b9bbbe; font-weight: bold; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; background: #2f3136; border: 1px solid #202225; color: white; border-radius: 5px; box-sizing: border-box; font-family: 'Tajawal', sans-serif; }
        .save-btn { background: #3ba55d; color: white; padding: 15px; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; width: 100%; font-weight: bold; font-family: 'Tajawal', sans-serif; margin-top: 20px; }
        .save-btn:hover { background: #2d7d46; }
        .builder-box { border: 1px solid #5865F2; padding: 20px; border-radius: 8px; margin-bottom: 15px; background: #1e1e24; }
        .cmd-box { background: #1e1e24; border: 1px solid #444; padding: 15px; border-radius: 8px; }
        hr { border-color: #333; margin: 20px 0; }
        @media (max-width: 768px) { body { flex-direction: column; overflow: auto; } .mobile-header { display: flex; } .sidebar { display: none; width: 100%; } .sidebar.open { display: flex; } .content { padding: 15px; } }
    </style>
</head>
<body>

    <div class="mobile-header">
        <h2 style="margin: 0; color: white;">ุฅุนุฏุงุฏุงุช ุงูุจูุช</h2>
        <button class="menu-btn" onclick="document.getElementById('sidebar').classList.toggle('open')">โฐ ุงููุงุฆูุฉ</button>
    </div>

    <div class="sidebar" id="sidebar">
        <h2>๐ Control Panel</h2>
        <button class="tab-btn active" onclick="openTab(event, 'general')">โ๏ธ ุงูุฅุนุฏุงุฏุงุช ูุงูุชุฑุญูุจ</button>
        <button class="tab-btn" onclick="openTab(event, 'warns_games')">โ๏ธ ุงูุชุญุฐูุฑุงุช ูุงูุฃูุนุงุจ</button>
        <button class="tab-btn" onclick="openTab(event, 'tickets_panel')">๐๏ธ ุงูุชูุชุงุช ุงูุฃุณุงุณูุฉ (ุงูุฎุงุฑุฌูุฉ)</button>
        <button class="tab-btn" onclick="openTab(event, 'tickets_builder')" style="border: 1px solid #f2a658;">๐๏ธ ุตุงูุน ุงูุชูุชุงุช ูุงูููุงูุฐ</button>
        <button class="tab-btn" onclick="openTab(event, 'roles')">๐จโโ๏ธ ุงูุฑุชุจ ูุงูุชุญูู ุจุงูุงุณุชูุงู</button>
        <button class="tab-btn" onclick="openTab(event, 'commands')">โจ๏ธ ุงูุฃูุงูุฑ ูุงูุฑุชุจ ุงููุณููุญุฉ</button>
        <button class="tab-btn" onclick="openTab(event, 'logs')">๐ ุฌููุน ุงูุณุฌูุงุช (ุงูููุฌุงุช)</button>
        <button class="tab-btn" onclick="openTab(event, 'embedBuilder')" style="border: 1px solid #5865F2;">๐จ ุตุงูุน ุงูุฅููุจุฏ ุงูุญุฑ</button>
        <a href="/dashboard" style="color: #ff4d4d; text-align: center; margin-top: 15px; text-decoration: none;">โฌ๏ธ ุงูุนูุฏุฉ ููุณูุฑูุฑุงุช</a>
    </div>

    <div class="content">
        <% if (success === 'saved') { %> <div style="background: #3ba55d; padding: 15px; text-align: center; border-radius: 5px; margin-bottom: 20px; font-weight: bold; font-size: 18px;">โ ุชู ุญูุธ ุงูุชุนุฏููุงุช ุจูุฌุงุญ!</div> <% } %>
        
        <form action="/settings/<%= guild.id %>" method="POST" id="mainForm">
            <input type="hidden" name="customButtonsData" id="customButtonsData">
            <input type="hidden" name="warnReasonsData" id="warnReasonsData">

            <div id="general" class="tab-content active">
                <h3>โ๏ธ ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ ูุงูุญูุงูุฉ</h3>
                <div class="form-group"><label>ุงูุจุฑูููุณ (Prefix):</label><input type="text" name="prefix" value="<%= config.prefix %>"></div>
                <div class="form-group" style="background: #2b2b36; padding: 15px; border-radius: 8px;">
                    <label style="display:inline-block; margin:0;">๐ก๏ธ ุงูุญูุงูุฉ (ุชูุนูู ุงูุฅููุงู ุงูุชููุงุฆู):</label><br><br>
                    <input type="checkbox" name="antiLinks" style="width:20px; height:20px;" <%= config.antiLinks ? 'checked' : '' %>> ููุน ูุดุฑ ุงูุฑูุงุจุท <br>
                    <input type="checkbox" name="antiSpam" style="width:20px; height:20px;" <%= config.antiSpam ? 'checked' : '' %>> ููุน ุงูุณุจุงู ูุงูุชูุฑุงุฑ
                </div>
                <div class="form-group"><label>ุฑุชุจุฉ ุงูุฏุฎูู ุงูุชููุงุฆูุฉ:</label><select name="autoRoleId"><option value="">-- ูุนุทู --</option><% roles.forEach(r => { %><option value="<%= r.id %>" <%= config.autoRoleId === r.id ? 'selected' : '' %>><%= r.name %></option><% }) %></select></div>
                
                <hr>
                <h3>๐ผ๏ธ ูุธุงู ุงูุชุฑุญูุจ ุงููุชุทูุฑ (ุจุงูุตูุฑ)</h3>
                <div style="background:#2f3136; padding:15px; border-radius:8px; margin-bottom:15px; border-right: 4px solid #5865F2;">
                    ๐ก <b>ุงููุชุบูุฑุงุช ุงููุชุงุญุฉ ููุงุณุชุฎุฏุงู ูู ุงูุฑุณุงูุฉ:</b><br>
                    <code>[user]</code> = ููุดู ููุนุถู | <code>[server]</code> = ุงุณู ุงูุณูุฑูุฑ | <code>[memberCount]</code> = ุฑูู ุงูุนุถู<br>
                    <i>ููุงุญุธุฉ: ุงูุจูุช ุณูููู ุชููุงุฆูุงู ุจูุถุน ุตูุฑุฉ ุงูุนุถู ุงูุฏุงุฆุฑูุฉ ูุจุฌุงูุจูุง ุตูุฑุฉ ุงูุณูุฑูุฑ ููู ุงูุฎูููุฉ ุงูุชู ุชุฎุชุงุฑูุง.</i>
                </div>
                <div class="form-group"><label>ุฑูู ุงูุชุฑุญูุจ:</label><select name="welcomeChannelId"><option value="">-- ูุนุทู --</option><% channels.filter(c=>c.type===0).forEach(c => { %><option value="<%= c.id %>" <%= config.welcomeChannelId === c.id ? 'selected' : '' %>><%= c.name %></option><% }) %></select></div>
                <div class="form-group"><label>ุฑุณุงูุฉ ุงูุชุฑุญูุจ ุงููุตูุฉ:</label><textarea name="welcomeMessage" rows="3"><%= config.welcomeMessage %></textarea></div>
                <div class="form-group"><label>ุฑุงุจุท ุตูุฑุฉ ุงูุฎูููุฉ (ูุฌุจ ุฃู ูููู ุฑุงุจุท ูุจุงุดุฑ ููุตูุฑุฉ):</label><input type="text" name="welcomeBgImage" value="<%= config.welcomeBgImage %>" placeholder="https://example.com/bg.png"></div>
                <div class="form-group"><label>ููู ุฅุทุงุฑ ุงูุตูุฑุฉ (Hex Color):</label><input type="color" name="welcomeAvatarBorderColor" value="<%= config.welcomeAvatarBorderColor || '#ffffff' %>" style="height: 40px; padding:0;"></div>
            </div>

            <div id="warns_games" class="tab-content">
                <h3>โ๏ธ ููุญุฉ ุงูุชุญูู ุจุงูุชุญุฐูุฑุงุช (Warn Panel)</h3>
                <div class="form-group"><label>ุงูุฑูู ุงูุชู ุณุชุฑุณู ุจูุง ููุญุฉ ุงูุฃุฒุฑุงุฑ ููุชุญุฐูุฑุงุช:</label><select name="warnPanelChannelId"><option value="">-- ูุนุทู --</option><% channels.filter(c=>c.type===0).forEach(c => { %><option value="<%= c.id %>" <%= config.warnPanelChannelId === c.id ? 'selected' : '' %>><%= c.name %></option><% }) %></select></div>
                <div class="form-group"><label>ุฑูู ุงูููุฌ ุงููุฎุตุตุฉ ูุณุฌู ุงูุชุญุฐูุฑุงุช ููู ุงูุชุญุฐูุฑ:</label><select name="warnLogChannelId"><option value="">-- ูุนุทู --</option><% channels.filter(c=>c.type===0).forEach(c => { %><option value="<%= c.id %>" <%= config.warnLogChannelId === c.id ? 'selected' : '' %>><%= c.name %></option><% }) %></select></div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group"><label>ุนููุงู ุฅููุจุฏ ููุญุฉ ุงูุชุญุฐูุฑ:</label><input type="text" name="warnPanelTitle" value="<%= config.warnPanelTitle %>"></div>
                    <div class="form-group"><label>ููู ุงูุฅููุจุฏ:</label><input type="color" name="warnPanelColor" value="<%= config.warnPanelColor %>" style="height:40px; padding:0;"></div>
                </div>
                <div class="form-group"><label>ูุตู ุงูุฅููุจุฏ (ุงูุชุนูููุงุช ููุฅุฏุงุฑุฉ):</label><textarea name="warnPanelDesc"><%= config.warnPanelDesc %></textarea></div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group"><label>ุงูุญุฏ ุงูุฃูุตู ููุชุญุฐูุฑุงุช (ูุจู ุงูุนูุงุจ):</label><input type="number" name="warnMax" value="<%= config.warnMax %>"></div>
                    <div class="form-group"><label>ุงูุนูุงุจ ุงูุชููุงุฆู ุจุนุฏ ุชุฌุงูุฒ ุงูุญุฏ:</label><select name="warnAction"><option value="timeout" <%= config.warnAction === 'timeout' ? 'selected' : '' %>>Timeout (ูุชู)</option><option value="kick" <%= config.warnAction === 'kick' ? 'selected' : '' %>>Kick (ุทุฑุฏ)</option><option value="ban" <%= config.warnAction === 'ban' ? 'selected' : '' %>>Ban (ุญุธุฑ)</option></select></div>
                </div>
                
                <div class="builder-box">
                    <h4 style="margin-top:0; color:#ed4245;">๐ ุงูุฃุณุจุงุจ ุงูุฌุงูุฒุฉ ููุชุญุฐูุฑ (ุชุธูุฑ ููุฅุฏุงุฑู ูู ุงููุงูุฐุฉ)</h4>
                    <div id="warnReasonsContainer"></div>
                    <button type="button" onclick="warnReasons.push('ุณุจุจ ุฌุฏูุฏ');renderWarnReasons();" style="background:#ed4245; border:none; color:white; padding:10px 20px; border-radius:5px; margin-top:10px; cursor:pointer; font-weight:bold;">โ ุฅุถุงูุฉ ุณุจุจ ููุชุญุฐูุฑ</button>
                </div>

                <hr>
                <h3>๐ฎ ุงูุฃูุนุงุจ ูุงูุงูุชุฑุงุญุงุช ูุงููุณุชููุงุช</h3>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                    <div class="form-group" style="background:#2b2b36; padding:15px; border-radius:8px;"><label>ุชูุนูู ุงูุฃูุนุงุจ (ุฑูููุชุ ุฎูู... ุงูุฎ):</label><input type="checkbox" name="gamesEnabled" style="width: 20px; height: 20px;" <%= config.gamesEnabled ? 'checked' : '' %>></div>
                    <div class="form-group"><label>ุฑูู ุงูุฃูุนุงุจ ุงููุฎุตุตุฉ:</label><select name="gamesChannelId"><option value="">-- ูู ุงูุฑููุงุช --</option><% channels.filter(c=>c.type===0).forEach(c => { %><option value="<%= c.id %>" <%= config.gamesChannelId === c.id ? 'selected' : '' %>><%= c.name %></option><% }) %></select></div>
                    <div class="form-group" style="background:#2b2b36; padding:15px; border-radius:8px;"><label>ุชูุนูู ูุธุงู ุงููุณุชููุงุช (XP):</label><input type="checkbox" name="levelingEnabled" style="width: 20px; height: 20px;" <%= config.levelingEnabled ? 'checked' : '' %>></div>
                    <div class="form-group"><label>ุฑูู ุงูุฅุนูุงู ุนู ุงูุชุฑููุฉ:</label><select name="levelUpChannelId"><option value="">-- ููุณ ุงูุฑูู --</option><% channels.filter(c=>c.type===0).forEach(c => { %><option value="<%= c.id %>" <%= config.levelUpChannelId === c.id ? 'selected' : '' %>><%= c.name %></option><% }) %></select></div>
                </div>
                <div class="form-group"><label>ุฑูู ุงูุงูุชุฑุงุญุงุช (ูุชู ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ุชุตููุช ุชููุงุฆูุงู):</label><select name="suggestionChannelId"><option value="">-- ูุนุทู --</option><% channels.filter(c=>c.type===0).forEach(c => { %><option value="<%= c.id %>" <%= config.suggestionChannelId === c.id ? 'selected' : '' %>><%= c.name %></option><% }) %></select></div>
            </div>

            <div id="tickets_panel" class="tab-content">
                <h3>๐๏ธ ุฅุนุฏุงุฏุงุช ุจุงูุฑ ุงูุชูุชุงุช ุงูุฎุงุฑุฌู (ูุญุชูู ุฌููุน ุงูุฃุฒุฑุงุฑ)</h3>
                <p style="color:#a3a6aa;">ุณูุชู ุฏูุฌ ุฌููุน ุงูุฃุฒุฑุงุฑ ุงูุชู ุชุตูุนูุง ูู ุงููุณู ุงููุงุฏู ุชุญุช ูุฐุง ุงูุฅููุจุฏ ุงูุฃุณุงุณู.</p>
                <div class="form-group"><label>ุงูุฑูู ุงูุชู ุณููุฑุณู ุจูุง ุงูุจุงูุฑ:</label><select name="panelChannelId"><option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option><% channels.filter(c=>c.type===0).forEach(c => { %><option value="<%= c.id %>" <%= config.panelChannelId === c.id ? 'selected' : '' %>><%= c.name %></option><% }) %></select></div>
                <div class="form-group"><label>ุงููุณู ุงูุงุญุชูุงุทู ููุชุญ ุงูุชูุชุงุช (Default Category):</label><select name="defaultCategoryId"><option value="">-- ุงุฎุชุฑ ูุณู --</option><% channels.filter(c=>c.type===4).forEach(c => { %><option value="<%= c.id %>" <%= config.defaultCategoryId === c.id ? 'selected' : '' %>><%= c.name %></option><% }) %></select></div>
                <div class="form-group"><label>ุนููุงู ุฅููุจุฏ ุงูููุงููู ุงูุฎุงุฑุฌู:</label><input type="text" name="ticketEmbedTitle" value="<%= config.ticketEmbedTitle %>"></div>
                <div class="form-group"><label>ูุตู ุงูุฅููุจุฏ ุงูุฎุงุฑุฌู (ููุงููู ุณุญุจ ุงูุชูุชุงุช):</label><textarea name="ticketEmbedDesc" rows="4"><%= config.ticketEmbedDesc %></textarea></div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group"><label>ููู ุงูุฅููุจุฏ:</label><input type="color" name="ticketEmbedColor" value="<%= config.ticketEmbedColor %>" style="height:40px; padding:0;"></div>
                    <div class="form-group"><label>ุฑูู ุงูุชูุช ุงููุงุฏู (ูุซุงู: 381):</label><input type="number" name="ticketCount" value="<%= config.ticketCount %>"></div>
                    <div class="form-group"><label>ุงูุญุฏ ุงูุฃูุตู ููุชูุชุงุช ุงูููุชูุญุฉ ููู ุนุถู ูู ููุณ ุงูููุช:</label><input type="number" name="maxTicketsPerUser" value="<%= config.maxTicketsPerUser %>"></div>
                    <div class="form-group"><label>ุฑุงุจุท ุตูุฑุฉ ููุจุงูุฑ (ุงุฎุชูุงุฑู):</label><input type="text" name="ticketEmbedImage" value="<%= config.ticketEmbedImage %>"></div>
                </div>
            </div>

            <div id="tickets_builder" class="tab-content">
                <h3>๐๏ธ ุตุงูุน ุงูุชูุชุงุช ุงูุชูุตููู (ุงูุฃุฒุฑุงุฑุ ุงูููุงูุฐุ ุงูุชูููู)</h3>
                <div id="buttonsContainer"></div>
                <button type="button" onclick="addNewButton()" style="background:#f2a658; color:white; border:none; padding:15px; width:100%; font-size:18px; font-weight:bold; border-radius:8px; cursor:pointer; margin-top:20px;">โ ุฅุถุงูุฉ ุฒุฑ ุชูุช ุฌุฏูุฏ ููุฎุตุต</button>
            </div>

            <div id="roles" class="tab-content">
                <h3>๐จโโ๏ธ ูุธุงู ุงูุฑุชุจ ุงูููุตูู</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group"><label>๐ฎ ุฑุชุจุฉ ุงูุฅุฏุงุฑุฉ ุงูุตุบุฑู:</label><select name="adminRoleId"><option value="">-- ุบูุฑ ูุญุฏุฏ --</option><% roles.forEach(r => { %><option value="<%= r.id %>" <%= config.adminRoleId === r.id ? 'selected' : '' %>><%= r.name %></option><% }) %></select></div>
                    <div class="form-group"><label>๐ ุฑุชุจ ุงูุฅุฏุงุฑุฉ ุงูุนููุง (ูุชุนุฏุฏ):</label><select name="highAdminRoles" multiple style="height:100px;"><% roles.forEach(r => { %><option value="<%= r.id %>" <%= config.highAdminRoles.includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select></div>
                    <div class="form-group"><label>๐ค ุฑุชุจุฉ ุงููุณุงุทุฉ ุงูุตุบุฑู:</label><select name="mediatorRoleId"><option value="">-- ุบูุฑ ูุญุฏุฏ --</option><% roles.forEach(r => { %><option value="<%= r.id %>" <%= config.mediatorRoleId === r.id ? 'selected' : '' %>><%= r.name %></option><% }) %></select></div>
                    <div class="form-group"><label>๐ ุฑุชุจ ุงููุณุงุทุฉ ุงูุนููุง (ูุชุนุฏุฏ):</label><select name="highMediatorRoles" multiple style="height:100px;"><% roles.forEach(r => { %><option value="<%= r.id %>" <%= config.highMediatorRoles.includes(r.id) ? 'selected' : '' %>><%= r.name %></option><% }) %></select></div>
                </div>
                <hr>
                <h3>๐ต๏ธโโ๏ธ ุชุญูู ุงุณุชูุงู ุงูุชูุช (Claim)</h3>
                <div class="form-group" style="background: #2b2b36; padding: 15px; border-radius: 8px; border-right: 4px solid #5865F2;"><label style="display:inline-block; margin-bottom:0;">ุฅุฎูุงุก ุงูุชูุช ุนู ุจุงูู ุงูุฅุฏุงุฑุฉ ุจูุฌุฑุฏ ุงูุงุณุชูุงู:</label><input type="checkbox" id="hideToggle" name="hideTicketOnClaim" style="width: 20px; height: 20px; float:left;" <%= config.hideTicketOnClaim ? 'checked' : '' %>></div>
                <div class="form-group" style="background: #2b2b36; padding: 15px; border-radius: 8px; border-right: 4px solid #f2a658;"><label style="display:inline-block; margin-bottom:0;">ูุถุน ุงููุฑุงูุจุฉ (ุงูุฅุฏุงุฑุฉ ุชุฑู ููุง ุชูุชุจ):</label><input type="checkbox" id="readOnlyToggle" name="readOnlyStaffOnClaim" style="width: 20px; height: 20px; float:left;" <%= config.readOnlyStaffOnClaim ? 'checked' : '' %>></div>
            </div>

            <div id="commands" class="tab-content">
                <h3>โจ๏ธ ุชุฎุตูุต ุงูุฃูุงูุฑ ูุงูุตูุงุญูุงุช (ูุงุจุฏ ุฃู ุชุจุฏุฃ ุจู !)</h3>
                <p style="color:#a3a6aa;">ููู ุฃูุฑุ ููููู ุชุบููุฑ ุงููุตุ ูุงุฎุชูุงุฑ ุงูุฑุชุจ ุงููุณููุญ ููุง ุจุงุณุชุฎุฏุงูู (ุงุถุบุท ูุทููุงู ูุงุฎุชูุงุฑ ุฃูุซุฑ ูู ุฑุชุจุฉ).</p>
                
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                    <% 
                    const cmds = [
                        {id: 'cmdAdd', label: 'ุฅุถุงูุฉ ุนุถู ููุชูุช'}, {id: 'cmdDone', label: 'ุชูููู ุงููุณูุท'}, {id: 'cmdReqHigh', label: 'ุงุณุชุฏุนุงุก ูุณุงุทุฉ ุนููุง'}, 
                        {id: 'cmdTrade', label: 'ุชูุงุตูู ุงูุชุฑูุฏ ูุงูููุงููุฉ'}, {id: 'cmdCome', label: 'ุณุญุจ ุนุถู/ุฅุฏุงุฑุฉ'}, {id: 'cmdClear', label: 'ูุณุญ ุงูุดุงุช'}, 
                        {id: 'cmdLock', label: 'ููู ุงูุดุงุช'}, {id: 'cmdUnlock', label: 'ูุชุญ ุงูุดุงุช'}, {id: 'cmdVmove', label: 'ุณุญุจ ูููุณ'},
                        {id: 'cmdBan', label: 'ุฅุนุทุงุก ุจุงูุฏ'}, {id: 'cmdTimeout', label: 'ุฅุนุทุงุก ุชุงูู ุฃูุช'}
                    ]; 
                    cmds.forEach(cmd => { %>
                        <div class="cmd-box">
                            <label style="color:#5865F2; font-size:16px;">๐ฅ ุฃูุฑ <%= cmd.label %>:</label>
                            <input type="text" name="<%= cmd.id %>" value="<%= config[cmd.id] %>" style="margin-bottom:15px;">
                            <label style="font-size:14px; color:#a3a6aa;">ุงูุฑุชุจ ุงููุณููุญ ููุง:</label>
                            <select name="<%= cmd.id %>Roles" multiple style="height:100px;">
                                <% roles.forEach(r => { %>
                                    <option value="<%= r.id %>" <%= config[cmd.id+'Roles'] && config[cmd.id+'Roles'].includes(r.id) ? 'selected' : '' %>><%= r.name %></option>
                                <% }) %>
                            </select>
                        </div>
                    <% }) %>
                </div>
            </div>

            <div id="logs" class="tab-content">
                <h3>๐ ุงูุณุฌูุงุช ูุงูููุฌุงุช ุงูุดุงููุฉ (ูููุฑุงูุจุฉ ุงููุงููุฉ)</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <% const logList = [
                        {id: 'transcriptChannelId', label: 'ุฑูู ุชุฑุงูุณูุฑูุจุช ุงูุชูุช (ุญูุธ ุงููุญุงุฏุซุงุช)'}, {id: 'ticketLogChannelId', label: 'ููุฌ ุญุฑูุงุช ุงูุชูุช (ูุชุญ/ุงุณุชูุงู/ููู)'}, 
                        {id: 'staffRatingChannelId', label: 'ููุฌ ุชููููุงุช ุงูุฅุฏุงุฑุฉ (ุชููุงุฆู)'}, {id: 'mediatorRatingChannelId', label: 'ููุฌ ุชููููุงุช ุงููุณุทุงุก (!done)'},
                        {id: 'logInviteId', label: 'ููุฌ ุงูุฏุนูุงุช (ูู ูุงู ุจุฏุนูุฉ ูู)'}, {id: 'logChannelThreadId', label: 'ููุฌ ุฅูุดุงุก ูุญุฐู ุงูุฑููุงุช ูุงูุซุฑูุฏ'}, 
                        {id: 'logBanId', label: 'ููุฌ ุงูุจุงูุฏ ููู ุงูุจุงูุฏ'}, {id: 'logTimeoutId', label: 'ููุฌ ุงูุชุงูู ุฃูุช ููู ุงูุชุงูู'},
                        {id: 'logUnwarnId', label: 'ููุฌ ูู ุงูุชุญุฐูุฑ (Unwarn)'},
                        {id: 'logRoleCreateDeleteId', label: 'ููุฌ ุฅูุดุงุก ูุญุฐู ุงูุฑุชุจ'}, {id: 'logMemberRoleUpdateId', label: 'ููุฌ ูู ุฃุนุทู/ุณุญุจ ุฑุชุจุฉ'}, 
                        {id: 'logJoinLeaveId', label: 'ููุฌ ุฏุฎูู ูุฎุฑูุฌ ุงูุฃุนุถุงุก'}, {id: 'logMsgDeleteId', label: 'ููุฌ ุญุฐู ุงูุฑุณุงุฆู'}, 
                        {id: 'logMsgUpdateId', label: 'ููุฌ ุชุนุฏูู ุงูุฑุณุงุฆู'}, {id: 'logImgDeleteId', label: 'ููุฌ ุญุฐู ุงูุตูุฑ ููุท'}, 
                        {id: 'logVoiceId', label: 'ููุฌ ุญุฑูุงุช ุงููููุณ (ููู/ุฏูุณููููุช)'}
                    ]; 
                    logList.forEach(log => { %>
                        <div class="form-group" style="background:#23232a; padding:15px; border-radius:8px; margin-bottom:0;">
                            <label style="color:#f2a658;"><%= log.label %>:</label>
                            <select name="<%= log.id %>">
                                <option value="">-- ูุนุทู --</option>
                                <% channels.filter(c=>c.type===0).forEach(c=>{ %>
                                    <option value="<%= c.id %>" <%= config[log.id]===c.id?'selected':'' %>><%= c.name %></option>
                                <% }) %>
                            </select>
                        </div>
                    <% }) %>
                </div>
            </div>

            <button type="submit" class="save-btn" id="mainSaveBtn" onclick="prepareData()">๐พ ุญูุธ ุฌููุน ุงูุฅุนุฏุงุฏุงุช ุงูุฌุจุงุฑุฉ ูู ุงูุณูุฑูุฑ</button>
        </form>

        <div id="embedBuilder" class="tab-content">
            <h3 style="color: #5865F2;">๐จ ุตุงูุน ุงูุฅููุจุฏ ุงูุญุฑ ููุฑููุงุช</h3>
            <form action="/settings/<%= guild.id %>/send-embed" method="POST">
                <div class="form-group"><label>ุงูุฑูู ุงููุฑุงุฏ ุงูุฅุฑุณุงู ุฅูููุง:</label><select name="embedChannelId" required><option value="">-- ุงุฎุชุฑ ุงูุฑูู --</option><% channels.filter(c=>c.type===0).forEach(c => { %><option value="<%= c.id %>"><%= c.name %></option><% }) %></select></div>
                <div class="form-group"><label>ุงูุนููุงู:</label><input type="text" name="embedTitle"></div>
                <div class="form-group"><label>ุงููุตู (ุงููุต ุงูุฑุฆูุณู):</label><textarea name="embedDesc" rows="5"></textarea></div>
                <div class="form-group"><label>ุงูููู:</label><input type="color" name="embedColor" value="#5865F2" style="height:40px; padding:0;"></div>
                <div class="form-group"><label>ุฑุงุจุท ุตูุฑุฉ ูุจูุฑุฉ (ุงุฎุชูุงุฑู):</label><input type="text" name="embedImage"></div>
                <div class="form-group"><label>ุงููุต ุงูุณููู Footer (ุงุฎุชูุงุฑู):</label><input type="text" name="embedFooter"></div>
                <button type="submit" class="save-btn" style="background: #5865F2;">๐ ุฅุฑุณุงู ุงูุฅููุจุฏ ุงูุขู!</button>
            </form>
        </div>
    </div>

    <script>
        function openTab(evt, tabName) {
            document.querySelectorAll(".tab-content").forEach(c => c.style.display="none");
            document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
            document.getElementById(tabName).style.display="block"; evt.currentTarget.classList.add("active");
            document.getElementById("mainSaveBtn").style.display = (tabName === 'embedBuilder') ? "none" : "block";
        }
        
        const hideToggle = document.getElementById('hideToggle'); const readOnlyToggle = document.getElementById('readOnlyToggle');
        function checkToggles() { if(hideToggle.checked){readOnlyToggle.disabled=true;readOnlyToggle.checked=false;}else{readOnlyToggle.disabled=false;} }
        checkToggles(); hideToggle.addEventListener('change', checkToggles);

        let warnReasons = <%- JSON.stringify(config.warnReasons || []) %>;
        function renderWarnReasons() {
            const container = document.getElementById('warnReasonsContainer'); container.innerHTML = '';
            warnReasons.forEach((r, i) => container.innerHTML += `<div style="display:flex; gap:10px; margin-bottom:10px;"><input type="text" value="${r}" onchange="warnReasons[${i}]=this.value" placeholder="ุณุจุจ ุงูุชุญุฐูุฑ..."><button type="button" onclick="warnReasons.splice(${i},1);renderWarnReasons();" style="background:red; border:none; color:white; padding:10px 15px; border-radius:5px; cursor:pointer;">โ</button></div>`);
        } renderWarnReasons();

        let buttonsData = <%- JSON.stringify(config.customButtons || []) %>;
        const catHTML = `<option value="">-- ุงุชุจุน ุงููุณู ุงูุงุญุชูุงุทู --</option><%- channels.filter(c=>c.type===4).map(c=>`<option value="${c.id}">${c.name}</option>`).join('') %>`;
        
        function renderButtons() {
            const container = document.getElementById('buttonsContainer'); container.innerHTML = '';
            buttonsData.forEach((btn, bI) => {
                let fHTML = ''; btn.modalFields.forEach((f, fI) => fHTML += `<div style="background:#23232a; padding:10px; margin-top:10px; border-right:3px solid #f2a658;"><label>ุณุคุงู ${fI+1}:</label><input type="text" value="${f.label}" onchange="buttonsData[${bI}].modalFields[${fI}].label=this.value"><button type="button" onclick="buttonsData[${bI}].modalFields.splice(${fI},1);renderButtons();" style="background:red; color:white; border:none; padding:5px 10px; margin-top:5px; border-radius:3px;">ูุณุญ ุงูุณุคุงู</button></div>`);
                
                container.innerHTML += `
                    <div class="builder-box">
                        <h3 style="color:#5865F2; margin-top:0; border-bottom:1px solid #333; padding-bottom:10px;">๐ ${btn.label}</h3>
                        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
                            <div><label>ุงูู ID ุงูุจุฑูุฌู (ุงูุฌููุฒู):</label><input type="text" value="${btn.id}" onchange="buttonsData[${bI}].id=this.value"></div>
                            <div><label>ุงุณู ุงูุฒุฑุงุฑ (ูุธูุฑ ูููุงุณ):</label><input type="text" value="${btn.label}" onchange="buttonsData[${bI}].label=this.value"></div>
                            <div><label>ููู ุงูุฒุฑุงุฑ:</label><select onchange="buttonsData[${bI}].color=this.value"><option value="Primary" ${btn.color=='Primary'?'selected':''}>ุฃุฒุฑู (Primary)</option><option value="Success" ${btn.color=='Success'?'selected':''}>ุฃุฎุถุฑ (Success)</option><option value="Danger" ${btn.color=='Danger'?'selected':''}>ุฃุญูุฑ (Danger)</option><option value="Secondary" ${btn.color=='Secondary'?'selected':''}>ุฑูุงุฏู (Secondary)</option></select></div>
                            <div><label>ุงููุณู ุงููุฎุตุต (Category):</label><select onchange="buttonsData[${bI}].categoryId=this.value">${catHTML.replace(`value="${btn.categoryId}"`,`value="${btn.categoryId}" selected`)}</select></div>
                        </div>
                        <h4 style="color:#3ba55d; margin-top:20px;">๐จ ุงูุฅููุจุฏ ุงูุฏุงุฎูู ุงูุฎุงุต ุจูุฐุง ุงูุชูุช</h4>
                        <div style="display:grid; grid-template-columns: 1fr; gap:10px;">
                            <div><label>ุนููุงู ุงูุฅููุจุฏ ุงูุฏุงุฎูู:</label><input type="text" value="${btn.insideEmbedTitle}" onchange="buttonsData[${bI}].insideEmbedTitle=this.value"></div>
                            <div><label>ูุตู ุงูุฅููุจุฏ ุงูุฏุงุฎูู (ุงูููุงููู):</label><textarea rows="3" onchange="buttonsData[${bI}].insideEmbedDesc=this.value">${btn.insideEmbedDesc}</textarea></div>
                            <div><label>ููู ุงูุฅููุจุฏ ุงูุฏุงุฎูู:</label><input type="color" value="${btn.insideEmbedColor}" onchange="buttonsData[${bI}].insideEmbedColor=this.value" style="height:40px; padding:0; width:100px;"></div>
                        </div>
                        <h4 style="color:#f2a658; margin-top:20px;">๐ช ุฅุนุฏุงุฏุงุช ุงููุงูุฐุฉ (Modal) ูุงูุชุฎุตูุต ูุงูุชูููู</h4>
                        
                        <div style="margin-bottom:15px; background: #23232a; padding: 15px; border-radius: 8px;">
                            <input type="checkbox" ${btn.requireModal?'checked':''} onchange="buttonsData[${bI}].requireModal=this.checked;renderButtons();" style="width:18px;height:18px;"> <label style="display:inline; font-size:16px;">ุชูุนูู ุงููุงูุฐุฉ (Modal)</label>
                            <span style="margin:0 15px;">|</span>
                            <input type="checkbox" ${btn.isMediator?'checked':''} onchange="buttonsData[${bI}].isMediator=this.checked;" style="width:18px;height:18px;"> <label style="display:inline; font-size:16px;">ุชูุช ูุณุงุทุฉ (ูุณุชุฎุฏู !done)</label>
                            <span style="margin:0 15px;">|</span>
                            <input type="checkbox" ${btn.enableRating!==false?'checked':''} onchange="buttonsData[${bI}].enableRating=this.checked;" style="width:18px;height:18px;"> <label style="display:inline; font-size:16px; color:#3ba55d;">ุฅุฑุณุงู ุชูููู ุชููุงุฆู ููุฅุฏุงุฑุฉ ุนูุฏ ุงูุฅุบูุงู</label>
                        </div>

                        <div style="display:${btn.requireModal?'block':'none'}; background:#18181b; padding:15px; border-radius:5px;">
                            <label>ุนููุงู ุงููุงูุฐุฉ ุงูููุชูุจ ุจุงูุฃุนูู:</label><input type="text" value="${btn.modalTitle}" onchange="buttonsData[${bI}].modalTitle=this.value">
                            ${fHTML}
                            <button type="button" onclick="buttonsData[${bI}].modalFields.push({label:'ุณุคุงู ุฌุฏูุฏ',required:true});renderButtons();" style="background:#3ba55d; color:white; border:none; padding:10px; margin-top:10px; border-radius:5px; cursor:pointer;">โ ุฅุถุงูุฉ ุณุคุงู ูููุงูุฐุฉ</button>
                        </div>
                        <button type="button" onclick="buttonsData.splice(${bI},1);renderButtons();" style="background:#ed4245; color:white; border:none; padding:15px; width:100%; margin-top:20px; font-weight:bold; border-radius:5px; cursor:pointer;">๐๏ธ ุญุฐู ูุฐุง ุงูุฒุฑ ุจุงููุงูู</button>
                    </div>
                `;
            });
        } renderButtons();
        function addNewButton() { buttonsData.push({id:'btn_'+Date.now(), label:'ุฒุฑ ุฌุฏูุฏ', color:'Primary', categoryId:'', insideEmbedTitle:'ุญูุงู ุงููู', insideEmbedDesc:'ุงูููุงููู...', insideEmbedColor:'#2b2d31', requireModal:false, modalTitle:'ูุฑุฌู ุชุนุจุฆุฉ ุงูุจูุงูุงุช', modalFields:[], isMediator:false, enableRating:true}); renderButtons(); }
        function prepareData() { document.getElementById('customButtonsData').value=JSON.stringify(buttonsData); document.getElementById('warnReasonsData').value=JSON.stringify(warnReasons); }
    </script>
</body>
</html>
